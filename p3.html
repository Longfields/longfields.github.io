<!DOCTYPE html>
<!-- 
Recommended browser: Google Chrome. No mobile support yet.

After many hours of hard work, I present to you...
NATUWARS
Version 0.4

NATUWARS v0.4 is an indie 2D offline shooter game developed by LeaferStudios and released on July 26, 2024.

Featuring over 7500 lines of code:
-Complete menu navigation
-Traits, In-game shop, Crafting
-6 game modes, 1 tutorial
-AI that fights other AI and player for Battle Royale modes
-Responsive widescreen cinematic experience: 16:9 aspect ratio
-Player statistic and currency system tracking
-Save your progress with encrypted savecode and savecode loading functionality

I experienced zero lag while developing and testing NATUWARS v0.4 in Google Chrome, although it should run at an average frame rate of 60 FPS in Safari even after hours of playing.

SUBSCRIBE to get notified when the next version of NATUWARS™ will be released!
https://www.khanacademy.org/computer-programming/leaferstudios/4934504502870016

If you have any questions or comments, feel free to share them in the discussion section on Khan Academy!
-->

<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NATUWARS v0.4</title>
    <meta name="description" content="NATUWARS is an exciting 2D offline shooter game developed by LeaferStudios. Experience the thrill of action in version 0.4." />
    <meta name="author" content="LeaferStudios" />
    <meta name="keywords" content="NATUWARS,2D,offline,shooter,LeaferStudios,NATUWARS v0.4" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lilita+One&family=Merriweather&family=Bakbak+One&family=Freeman&family=Lato&display=swap" rel="stylesheet">
    <style type="text/css">
        * {
            --fontone: 'Freeman', Helvetica, arial;
            --fonttwo: 'Lato', Helvetica, arial;
        }

        html,
        body {
            width: 100%;
            height: 100%;
            margin: 0px;
            padding: 0px;
        }

        #game {
            background-color: #666;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            height: 100%;
        }

        #game:focus {
            outline: none;
        }

        canvas#main-game {
            width: fit-content;
            height: fit-content;
        }

        canvas#main-game:focus {
            outline: none;
        }

        #big-screen {
            position: fixed;
            top: 0px;
            left: 0px;
            font-size: 17px;
            font-family: var(--fontone);
            padding: 16px 5vw;
            padding-top: 3px;
            background-color: rgba(255, 255, 255);
            z-index: 12;
            box-shadow: 0px 20px 90px rgba(0, 0, 0, 0.2);
        }

        #big-screen p {
            font-family: 'Lato', arial;
            font-weight: 100;
            font-size: 16px;
        }

        button {
            border: none;
            background-color: rgb(3, 166, 0);
            color: #FFF;
            padding: 0 16px;
            height: 35px;
            border-radius: 4px;
            transition: background-color 0.2s;
            display: block;
            font-family: var(--fonttwo);
        }

        button:hover {
            background-color: rgb(31, 145, 27);
            cursor: pointer;
        }

        button:focus {
            outline: 2px solid #000;
        }

        button.red {
            background-color: rgb(196, 0, 33);
        }

        button.red:hover {
            background-color: rgb(171, 9, 38);
        }

        #subscribe-screen,
        #loade-screen,
        #saved-screen,
        #change-name-screen {
            position: absolute;
            background-color: rgb(255, 255, 255);
            box-shadow: 0px 20px 90px rgba(0, 0, 0, 0.2);
            top: 50%;
            right: 0;
            transform: translateY(-50%);
            left: 0px;
            font-size: 17px;
            font-family: var(--fontone);
            padding: 90px 10vw;
        }

        #subscribe-screen p {
            font-size: 30px;
            font-family: 'Bakbak One';
        }

        #loade-screen,
        #saved-screen,
        #change-name-screen p {
            font-family: 'Lato', Helvetica, arial;
        }

        a {
            color: rgb(15, 130, 0);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

/*After thinking, I decided not to add a custom scrollbar
There is no scrollbar on my iMac, and it looks better that way.
::-webkit-scrollbar {
  width: 6px;
}

::-webkit-scrollbar-track {
  background: #f1f1f1;
}

::-webkit-scrollbar-thumb {
  background: #888;
}

::-webkit-scrollbar-thumb:hover {
  background: #555;
}*/

        .big {
            transform: scale(1.5);
            margin-left: 30px;
            text-decoration: none;
        }

        button:hover {
            text-decoration: none;
        }

        button#yes-please {
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0% {
                transform: scale(1);
            }

            25% {
                transform: scale(1.05);
            }

            50% {
                transform: scale(0.97);
            }

            75% {
                transform: scale(1.05);
            }

            100% {
                transform: scale(1.00);
            }
        }

        .article {
            padding: 5vh 5vw;
        }

        .article h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: 'Poppins', Helvetica, arial;
            font-weight: 600;
        }

        .article p,
        ul,
        ol,
        li {
            font-family: 'Lato', Helvetica, arial;
            font-weight: 400;
            font-size: 16px;
            line-height: 24px;
        }

        footer {
            border-top: 1px solid gainsboro;
            font-family: 'Poppins', Helvetica, arial;
            text-align: center;
            padding: 10px 0;
        }

        #error_text {
            font-size: 15px;
            font-family: 'Lato', Helvetica, arial;
            color: rgb(194, 0, 39);
            font-weight: 400;
            border-left: 2px solid rgb(194, 0, 39);
            padding-left: 10px;
            transition: all 0.2s;
        }

        #error_text_1 {
            font-size: 15px;
            font-family: 'Lato', Helvetica, arial;
            color: rgb(194, 0, 39);
            font-weight: 400;
            border-left: 2px solid rgb(194, 0, 39);
            padding-left: 10px;
            transition: all 0.2s;
        }

        input {
            height: 32px;
            padding: 0 15px;
            font-family: 'Lato', Helvetica, arial;
            font-size: 14px;
            width: 100%;
            border: 1.7px solid rgb(158, 158, 158);
            color: #000;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 5px;
            margin: 15px 0;
            transition: all 0.25s;
        }

        input:focus {
            border: 1.7px solid rgb(166, 166, 166);
            box-shadow: 0px 6px 10px rgba(0, 0, 0, 0.1);
            outline: 2px solid rgb(69, 204, 16);
        }

        #savecod {
            max-width: 100%;
            word-wrap: break-word;
            font-family: monospace;
            color: rgb(0, 0, 0);
            background: rgb(222, 222, 222);
        }

        #savecodparent {
            height: 100px;
            overflow-y: scroll;
            margin-bottom: 45px;
            border: 3px solid rgb(7, 173, 34);
            border-radius: 5px;
        }

        #savecodparent::-webkit-scrollbar {
            width: 7px;
        }

        #savecodparent::-webkit-scrollbar-track {
            background: rgb(218, 240, 192);
        }

        #savecodparent::-webkit-scrollbar-thumb {
            background: rgb(17, 135, 29);
            border-radius: 5px;
        }

        #savecodparent::-webkit-scrollbar-thumb:hover {
            background: rgb(5, 69, 12);
        }

        .slideshow-container {
            position: relative;
            max-width: 100%;
            margin: auto;
            height: 250px;
            overflow: hidden;
            background: rgb(0, 89, 50);
            border-radius: 5px;
            color: white;
            text-align: center;
            padding: 20px;
        }

        .slide {
            display: none;
            font-size: 24px;
            padding: 20px;
            font-family: 'Freeman', Helvetica, arial;
        }

        .slide h2 {
            font-weight: 400;
            letter-spacing: 0px;
            font-family: 'Merriweather', 'Freeman', Helvetica, arial;
            font-size: 31px;
            margin: 16px 0;
        }

        .slide h1 {
            color: rgb(213, 255, 61);
            font-size: 37px;
            margin: 0;
            font-weight: 600;
            font-family: 'Lato', Helvetica, arial;
        }

        .slide p {
            font-size: 20px;
        }

        .prev,
        .next {
            cursor: pointer;
            position: absolute;
            top: 50%;
            width: auto;
            padding: 16px;
            margin-top: -22px;
            color: rgb(0, 89, 50);
            font-weight: bold;
            font-size: 24px;
            transition: 0.25s ease;
            border-radius: 0 3px 3px 0;
            user-select: none;
            background-color: rgba(255, 255, 255, 0.5);
            text-decoration: none;
            transform: scale(1, 1);
        }

        a.prev,
        .next:hover {
            text-decoration: none;
        }

        .next {
            right: 0;
            border-radius: 3px 0 0 3px;
        }

        .prev {
            left: 0;
        }

        .prev:hover,
        .next:hover {
            background-color: rgba(255, 255, 255, 0.8);
        }

        .prev:active,
        .next:active {
            background-color: rgba(255, 255, 255, 0.6);
        }

        #jj {
            position: absolute;
            left: 50%;
            bottom: 20px;
            transform: translateX(-50%);
            width: 100%;
            text-align: center;
            font-size: 20px;
            font-family: 'Lato', arial;
            color: #FFF;
            animation: fadeo 6s forwards;
        }

        @keyframes fadeo {
            0% {
                opacity: 1;
            }

            50% {
                opacity: 1;
            }

            100% {
                opacity: 0;
            }
        }
    </style>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta charset="UTF-8" />
</head>

<body>
    <noscript>
        Sorry, your browser does not support JavaScript, which is needed to run this game!
    </noscript>
    <h1 id='jj'>You can scroll down for game description</h1>
    <div id='big-screen'>
        <p style='margin-top: 0px;'>NATUWARS is a game built for a fullscreen experience (16:9 ratio). Do you want to view it fullscreen?</p>
        <div style='display: flex;'>
            <a href='https://www.khanacademy.org/computer-programming/natuwars-v04/5283314913427456?width=1000&height=563&editor=no' target='_blank'>
                <button onclick='fullscreen();' id='yes-please' style='margin-right: 15px'>Yes Please!
                    <svg style='margin-left: 5px;' fill="#ffffff" width="10px" height="10px" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14 3.414L9.414 8 14 12.586v-2.583h2V16h-6v-1.996h2.59L8 9.414l-4.59 4.59H6V16H0v-5.997h2v2.583L6.586 8 2 3.414v2.588H0V0h16v6.002h-2V3.414zm-1.415-1.413H10V0H6v2H3.415L8 6.586 12.585 2z" fill-rule="evenodd" />
                    </svg>
                </button></a>
            <button class='red' style='padding-right: 35px;' onclick='closeFullscreen();'>Close
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width='18' height='18' style='position: absolute;margin-left: 5px;'>
                    <path d="M10.0303 8.96965C9.73741 8.67676 9.26253 8.67676 8.96964 8.96965C8.67675 9.26255 8.67675 9.73742 8.96964 10.0303L10.9393 12L8.96966 13.9697C8.67677 14.2625 8.67677 14.7374 8.96966 15.0303C9.26255 15.3232 9.73743 15.3232 10.0303 15.0303L12 13.0607L13.9696 15.0303C14.2625 15.3232 14.7374 15.3232 15.0303 15.0303C15.3232 14.7374 15.3232 14.2625 15.0303 13.9696L13.0606 12L15.0303 10.0303C15.3232 9.73744 15.3232 9.26257 15.0303 8.96968C14.7374 8.67678 14.2625 8.67678 13.9696 8.96968L12 10.9393L10.0303 8.96965Z" fill="#FFF" />
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M12 1.25C6.06294 1.25 1.25 6.06294 1.25 12C1.25 17.9371 6.06294 22.75 12 22.75C17.9371 22.75 22.75 17.9371 22.75 12C22.75 6.06294 17.9371 1.25 12 1.25ZM2.75 12C2.75 6.89137 6.89137 2.75 12 2.75C17.1086 2.75 21.25 6.89137 21.25 12C21.25 17.1086 17.1086 21.25 12 21.25C6.89137 21.25 2.75 17.1086 2.75 12Z" fill="#FFF" />
                </svg>
            </button>
        </div>
    </div>
    <div id='game'>
        <canvas id='main-game' class="sketch"></canvas>
    </div>

    <div id='change-name-screen'>
        <p id='error_text_1'>Error detected</p>
        <p style='font-size: 30px;'>
            Edit Name
        </p>
        <p style='font-size: 20px;'>
            Must be letters only and no spaces.
            <br>
            <input id='userbox' placeholder='Enter new username...' onfocusout="this.value = this.value.trim()" maxlength='10'>
        </p>

        <div style='display: flex;'>
            <button class='big' onclick='updateUsername();' style='margin-right: 39px;padding-right: 35px' id='updateUsernameBtn'>Confirm
                <svg style='position:absolute;margin-left: 5px;vertical-align: middle;margin-top: 2.5px' width="21px" height="21px" viewBox="0 -0.5 24 24" version="1.1">
                    <title>1182</title>
                    <defs>

                    </defs>
                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                        <path d="M15.584,5.988 L10.344,1.343 C9.94,0.933 9.465,0.864 9.061,1.275 L9.061,4.407 C8.965,4.406 8.883,4.406 8.834,4.406 C3.884,4.406 0.084,7.969 0.084,12.816 C0.084,14.504 0.85,13.889 1.167,13.3 C2.668,10.52 5.434,8.623 8.872,8.623 C8.913,8.623 8.982,8.624 9.06,8.624 L9.06,11.689 C9.464,12.099 9.989,12.05 10.343,11.757 L15.583,7.474 C15.988,7.064 15.988,6.399 15.584,5.988 L15.584,5.988 Z" fill="#FFF" class="si-glyph-fill">

                        </path>
                    </g>

                </svg>
            </button>
            <button class='red big' style='padding-right: 35px;' onclick='closeChangeNameScreen();'>Close
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width='18' height='18' style='position: absolute;margin-left: 5px;'>
                    <path d="M10.0303 8.96965C9.73741 8.67676 9.26253 8.67676 8.96964 8.96965C8.67675 9.26255 8.67675 9.73742 8.96964 10.0303L10.9393 12L8.96966 13.9697C8.67677 14.2625 8.67677 14.7374 8.96966 15.0303C9.26255 15.3232 9.73743 15.3232 10.0303 15.0303L12 13.0607L13.9696 15.0303C14.2625 15.3232 14.7374 15.3232 15.0303 15.0303C15.3232 14.7374 15.3232 14.2625 15.0303 13.9696L13.0606 12L15.0303 10.0303C15.3232 9.73744 15.3232 9.26257 15.0303 8.96968C14.7374 8.67678 14.2625 8.67678 13.9696 8.96968L12 10.9393L10.0303 8.96965Z" fill="#FFF" />
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M12 1.25C6.06294 1.25 1.25 6.06294 1.25 12C1.25 17.9371 6.06294 22.75 12 22.75C17.9371 22.75 22.75 17.9371 22.75 12C22.75 6.06294 17.9371 1.25 12 1.25ZM2.75 12C2.75 6.89137 6.89137 2.75 12 2.75C17.1086 2.75 21.25 6.89137 21.25 12C21.25 17.1086 17.1086 21.25 12 21.25C6.89137 21.25 2.75 17.1086 2.75 12Z" fill="#FFF" />
                </svg>
            </button>
        </div>
    </div>

    <div id='subscribe-screen'>
        <p style='font-size: 30px;'>
            <a href='https://www.khanacademy.org/computer-programming/leaferstudios/4934504502870016' target='_blank'>Subscribe to LeaferStudios to get notified when the next version of NATUWARS is released!</a>
        </p>

        <div style='display: flex;'>
            <a href='https://www.khanacademy.org/computer-programming/leaferstudios/4934504502870016' target='_blank'>
                <button class='big' onclick='' style='margin-right: 39px;padding-right: 35px'>Subscribe
                    <svg style='position:absolute;margin-left: 5px;' fill="none" width="21px" height="18px" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M5 12V6C5 5.44772 5.44772 5 6 5H18C18.5523 5 19 5.44772 19 6V18C19 18.5523 18.5523 19 18 19H12M8.11111 12H12M12 12V15.8889M12 12L5 19" stroke="#FFF" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </button>
            </a>
            <button class='red big' style='padding-right: 35px;' onclick='closeSubscribeScreen();'>Close
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width='18' height='18' style='position: absolute;margin-left: 5px;'>
                    <path d="M10.0303 8.96965C9.73741 8.67676 9.26253 8.67676 8.96964 8.96965C8.67675 9.26255 8.67675 9.73742 8.96964 10.0303L10.9393 12L8.96966 13.9697C8.67677 14.2625 8.67677 14.7374 8.96966 15.0303C9.26255 15.3232 9.73743 15.3232 10.0303 15.0303L12 13.0607L13.9696 15.0303C14.2625 15.3232 14.7374 15.3232 15.0303 15.0303C15.3232 14.7374 15.3232 14.2625 15.0303 13.9696L13.0606 12L15.0303 10.0303C15.3232 9.73744 15.3232 9.26257 15.0303 8.96968C14.7374 8.67678 14.2625 8.67678 13.9696 8.96968L12 10.9393L10.0303 8.96965Z" fill="#FFF" />
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M12 1.25C6.06294 1.25 1.25 6.06294 1.25 12C1.25 17.9371 6.06294 22.75 12 22.75C17.9371 22.75 22.75 17.9371 22.75 12C22.75 6.06294 17.9371 1.25 12 1.25ZM2.75 12C2.75 6.89137 6.89137 2.75 12 2.75C17.1086 2.75 21.25 6.89137 21.25 12C21.25 17.1086 17.1086 21.25 12 21.25C6.89137 21.25 2.75 17.1086 2.75 12Z" fill="#FFF" />
                </svg>
            </button>
        </div>
    </div>
    <div id='saved-screen'>
        <p style='font-size: 20px;margin-bottom: 25px;'>
            Copy the string below and save it somewhere to continue where you left off:
            <br />
        <div id='savecodparent'>
            <code id='savecod'>Loading...</code>
        </div>
        </p>

        <div style='display: flex;'>
            <button class='big' onclick='copySaveCode();' style='margin-right: 39px;' id='copybutton'>Copy Savecode
            </button>

            <button class='red big' style='padding-right: 35px;' onclick='closeSavedScreen();'>Close
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width='18' height='18' style='position: absolute;margin-left: 5px;'>
                    <path d="M10.0303 8.96965C9.73741 8.67676 9.26253 8.67676 8.96964 8.96965C8.67675 9.26255 8.67675 9.73742 8.96964 10.0303L10.9393 12L8.96966 13.9697C8.67677 14.2625 8.67677 14.7374 8.96966 15.0303C9.26255 15.3232 9.73743 15.3232 10.0303 15.0303L12 13.0607L13.9696 15.0303C14.2625 15.3232 14.7374 15.3232 15.0303 15.0303C15.3232 14.7374 15.3232 14.2625 15.0303 13.9696L13.0606 12L15.0303 10.0303C15.3232 9.73744 15.3232 9.26257 15.0303 8.96968C14.7374 8.67678 14.2625 8.67678 13.9696 8.96968L12 10.9393L10.0303 8.96965Z" fill="#FFF" />
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M12 1.25C6.06294 1.25 1.25 6.06294 1.25 12C1.25 17.9371 6.06294 22.75 12 22.75C17.9371 22.75 22.75 17.9371 22.75 12C22.75 6.06294 17.9371 1.25 12 1.25ZM2.75 12C2.75 6.89137 6.89137 2.75 12 2.75C17.1086 2.75 21.25 6.89137 21.25 12C21.25 17.1086 17.1086 21.25 12 21.25C6.89137 21.25 2.75 17.1086 2.75 12Z" fill="#FFF" />
                </svg>
            </button>
        </div>
    </div>
    <div id='loade-screen'>
        <p id='error_text'>Error detected</p>
        <p style='font-size: 20px;'>
            Enter your savecode to continue where you left off:
            <br>
            <input id='loadcod' placeholder='Enter savecode...' onfocusout="this.value = this.value.trim()">
        </p>


        <div style='display: flex;'>
            <button class='big' onclick='loadSaveCode();' style='margin-right: 39px;' id='loadbtn'>Load Savecode
            </button>
            <button class='red big' style='padding-right: 35px;' onclick='closeLoadeScreen();'>Close
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width='18' height='18' style='position: absolute;margin-left: 5px;'>
                    <path d="M10.0303 8.96965C9.73741 8.67676 9.26253 8.67676 8.96964 8.96965C8.67675 9.26255 8.67675 9.73742 8.96964 10.0303L10.9393 12L8.96966 13.9697C8.67677 14.2625 8.67677 14.7374 8.96966 15.0303C9.26255 15.3232 9.73743 15.3232 10.0303 15.0303L12 13.0607L13.9696 15.0303C14.2625 15.3232 14.7374 15.3232 15.0303 15.0303C15.3232 14.7374 15.3232 14.2625 15.0303 13.9696L13.0606 12L15.0303 10.0303C15.3232 9.73744 15.3232 9.26257 15.0303 8.96968C14.7374 8.67678 14.2625 8.67678 13.9696 8.96968L12 10.9393L10.0303 8.96965Z" fill="#FFF" />
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M12 1.25C6.06294 1.25 1.25 6.06294 1.25 12C1.25 17.9371 6.06294 22.75 12 22.75C17.9371 22.75 22.75 17.9371 22.75 12C22.75 6.06294 17.9371 1.25 12 1.25ZM2.75 12C2.75 6.89137 6.89137 2.75 12 2.75C17.1086 2.75 21.25 6.89137 21.25 12C21.25 17.1086 17.1086 21.25 12 21.25C6.89137 21.25 2.75 17.1086 2.75 12Z" fill="#FFF" />
                </svg>
            </button>
        </div>
    </div>

    <div class='article'>
        <h1>About NATUWARS</h1>

        <p>NATUWARS v0.4 is an indie 2D offline shooter game developed by <a href='https://www.khanacademy.org/profile/kaid_553656479258879622339276/' target='_blank'>LeaferStudios</a> and released on July 26, 2024.</p>

        <h2>Advance Praise</h2>
        <div class="slideshow-container">
            <div class="slide">
                <h2 style='font-size: 25px;margin-top: 5px;'>"An incredibly professional tour de force that captivates the audience from the first moment to the last."</h2>
                <h1>10/10</h1>
                <p>—Liam K.</p>
            </div>
            <div class="slide">
                <h2 style='margin-top: 30px;'>"Absolutely yes of a game."</h2>
                <h1>9/10</h1>
                <p>—NL</p>
            </div>
            <div class="slide">
                <h2 style='font-size:28px;margin-top:-0px;'>"A captivating 2D shooter offering an assortment of game modes and weapons."</h2>
                <h1>8/10</h1>
                <p>—Aliquis</p>
            </div>
            <a class="prev" onclick="plusSlides(-1)">&lt;</a>
            <a class="next" onclick="plusSlides(1)">&gt;</a>
        </div>

        <h2>Version 0.4 Updates</h2>
        <p>Here are the 7 biggest updates and new features of NATUWARS v0.4:</p>
        <ul>
            <li>Complete menu navigation</li>
            <li>Traits, In-game shop, Crafting</li>
            <li>6 game modes, 1 tutorial</li>
            <li>AI that fights other AI and player for Battle Royale modes</li>
            <li>Responsive widescreen cinematic experience: 16:9 aspect ratio</li>
            <li>Player statistic and currency system tracking</li>
            <li>Save your progress with encrypted savecode and savecode loading functionality</li>
        </ul>
        <p>At over 7500 lines of code, this version is a massive update from v0.3. There are so many updates that you should <a href='https://www.khanacademy.org/computer-programming/forestio-v03-beta/4614997930328064' target='_blank'>visit the previous version</a> if you really want to compare them both.</p>

        <h2>Developer's Notes</h2>
        <p>Hello! I am the single author of NATUWARS v0.4 and my username is <a href='https://www.khanacademy.org/profile/kaid_553656479258879622339276/' target='_blank'>LeaferStudios</a> on the Khan Academy Computer Programming community.</p>
        <p>I experienced zero lag while developing and testing NATUWARS v0.4 in Google Chrome, although it should run at an average frame rate of 60 FPS in Safari even after hours of playing. There is no mobile or controller support at this version, so you need a computer to play.</p>
        <p>Here is a quick rundown of the previous versions:</p>
        <ul>
            <li>The previous versions of NATUWARS were called Forest.io. On 11 July 2024, I decided to change it the name to NATUWARS to better originality and branding. You can visit <a href='https://www.khanacademy.org/computer-programming/forestio-update-name-logo-change-to-natuwars/6670213844484096' target='_blank'>the official logo update</a> for more information.</li>
            <li><a href='https://www.khanacademy.org/computer-programming/forestio-v03-beta/4614997930328064' target='_blank'>Forest.io v0.3 BETA</a> (released on Khan Academy)</li>
            <li><a href='https://www.khanacademy.org/computer-programming/forestio-v02-beta/5672189914955776' target='_blank'>Forest.io v0.2 BETA</a> (released on Khan Academy)</li>
            <li><a href='https://www.khanacademy.org/computer-programming/forestio-alpha/5213888244137984' target='_blank'>Forest.io v0.1 [Alpha]</a> (released on Khan Academy)</li>

        </ul>
        <p>If you have any questions or comments, feel free to share them in the discussion section on Khan Academy!</p>
    </div>

    <footer>
        <p>&copy; 2024 <a href='https://www.khanacademy.org/profile/kaid_553656479258879622339276/' target='_blank'>LeaferStudios</a></p>
    </footer>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/Khan/processing-js@master/processing.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/Mushy-Avocado/KA-exporter@main/exporter.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>

    <!-- GAME SCRIPT -->
    <script type="application/javascript">
        var pl = {
            name: 'Player',
            matches: 0,
            wins: 0,
            losses: 0,
            winrate: 0,
            kills: 0,
            deaths: 0,
            kdr: 0,
            highscore: [],
            gems: 0,
            trophies: 0,
            timePlayed: 0,
        };
        var fontss = ['Bakbak One', 'Freeman', 'Lilita One'];
        var subscribe = false; // open with HTML
        var saved = false;
        var loade = false;
        var changeName = false;
        // Encryption key
        var encryptionKey = "your-secret-key";

        // Function to encrypt the object
        function encryptObject(obj) {
            var jsonString = JSON.stringify(obj);
            return CryptoJS.AES.encrypt(jsonString, encryptionKey).toString();
        }

        // Function to decrypt the string
        function decryptObject(encryptedStr) {
            var bytes = CryptoJS.AES.decrypt(encryptedStr, encryptionKey);
            var decryptedString = bytes.toString(CryptoJS.enc.Utf8);
            return JSON.parse(decryptedString);
        }

        function program() {
            // Currently changing game size to be compatible with Fullscreen Computer and Television [done, 16:9 ratio]
            /**
             * 
             * NATUWARS by LeaferStudios
             * Beta - v0.4.0
             * 
             * 
             * 
             * 
             * NOTE TO SELF: Changing bullet colors can change the theme from real world to sci-fi (with a change in scenery and colors of course). I can also get guns from here since I made them myself: https://www.khanacademy.org/computer-programming/weapons-wip/5507768294785024
             * 
             * Now enemies are super strong, I will make weaker ones for survival and keep strong ones for team battles. -Maybe not. Maybe, weaker ones and stronger ones on random, so it's like real players?
             * 
             * Guess it is time to release, since we have to make it till v1.0.0!
             * 
             * Program Size: 
             *  -Lines of code as of XX XXXX 20XX: XXXX
             *  -Hit over 5000 lines of code 10 July 2024.
             *  -Hit over 5700 lines of code 11 July 2024.
             *  -Hit over 5900 lines of code 12 July 2024.
             *  -Hit over 6100 lines of code 13 July 2024.
             *  -Hit over 6400 lines of code 16 July 2024.
             *  -Hit over 6500 lines of code 17 July 2024.
             *  -17 July 2024: MAJOR BUG FIXED! Ready for release after a few minor adjustments. Only thing to add: different battle royale gamemodes, very quick (5 minutes).
             *  -18, 19 July 2024: Setting it up in HTML, adding finishing touches.
             * 
             * TODO:
             * 
             * Reset wood and rock after you die[done].
             * Finish Myster Mode game. [done, but smg works best. also weapons dont change unless restart]
             * Fix player current game stats on  game death screen. Release!
             * BUILDING MODE (not all gamemodes allow this): Make rock harvest when equal to 0 make rock disappear or fade out a bit until it replenishes with visual timer. Make you lose rocks when you create one (costs 25 rocks to make 1 rock).
             * Daily Challenges with Rewards
             * trait graphics & ability to choose it
             * leaderboard idea: give ai names and add their stats to leaderboard. only updates after you win/die. Maybe update color scheme?
             * building based on resources [somewhat done]
             * bigger reward for airdrop (ez)
             * zones: Hidey Hole
             * make HUD more clear (click to open menu?) [done]
             * Battlefront Game UI: 1 gun default (players choice) and option to have 3 extra ones in Star Card as ability. 
             * Save Code
             * particle based on weapon level [done]
             * upgradable weapon level based ono resources (money from killing enemies, rocks, trees) [done]
             * added night mode [done]
             * dynamic inventory & weapon toggles [done]
             **/

            //frameRate(60);

            var w = 600;
            var h = 338;
            size(w, h, P2D);
            smooth();
            enableContextMenu();

            var delag = false;
            var testing = false;

            // do not repeat these
            var d = day();
            var m = month();
            /*
            January 1
            February 2
            March 3
            April 4
            May 5
            June 6
            July 7
            August 8
            September 9
            October 10
            November 11
            December 12
            */
            var y = year();
            var loadScene = 0; //lol
            var version = "LS v0.4.0";
            var gd = {
                gW: 600 * 9, // gW
                gH: 338 * 9, // gH
                mapScale: (width / 10), // mapScale
            }; // game data
            var gamemodes = [{
                    name: 'Survival',

                    diff: 'normal', // hard is without heals

                    bots: true, // false is with zombs only
                    botStrength: 'normal',
                    zombieStrength: 'normal',
                    weaponSurvival: false,
                    edibles: true,

                    timesPlayed: 0,
                    desc: 'Survive with auto heal against normal bots and zombies.',
                    pond: 'default',
                    totalRocks: 40,
                    mapW: 600 * 9,
                    mapH: 338 * 9
                },
                {
                    name: 'Bot Survival',

                    diff: 'normal', // hard is without heals

                    bots: true, // false is with zombs only
                    botStrength: 'normal',
                    zombieStrength: 'normal',
                    weaponSurvival: false,
                    edibles: true,
                    timesPlayed: 0,
                    desc: 'Survive with auto heal against normal bots only.',
                    pond: 'default',
                    totalRocks: 40,
                    mapW: 600 * 9,
                    mapH: 338 * 9
                },
                {
                    name: 'Zombie Survival',

                    diff: 'normal', // hard is without heals

                    bots: false, // false is with zombs only
                    botStrength: 'normal',
                    zombieStrength: 'normal',
                    weaponSurvival: false,
                    edibles: true,
                    timesPlayed: 0,
                    desc: 'Survive with auto heal against normal zombies only.',
                    pond: 'default',
                    totalRocks: 40,
                    mapW: 600 * 9,
                    mapH: 338 * 9
                },
                {
                    name: 'Mystery BR',
                    diff: 'normal', // hard is without heals
                    bots: true, // false is with zombs only
                    botStrength: 'normal',
                    weaponSurvival: true,

                    edibles: false,
                    timesPlayed: 0,
                    desc: '12 player Battle Royale with a random weapon each round.',
                    pond: 'none',
                    totalRocks: 25,
                    totalBots: 11,
                    mapW: 600 * 5,
                    mapH: 338 * 5
                },
                {
                    name: 'Big Mystery BR',
                    diff: 'normal', // hard is without heals
                    bots: true, // false is with zombs only
                    botStrength: 'normal',
                    weaponSurvival: true,

                    edibles: false,
                    timesPlayed: 0,
                    desc: 'Mystery BR but with a 50% larger map and 20 players.',
                    pond: 'none',
                    totalRocks: 19,
                    totalBots: 19,
                    mapW: 600 * 7.5,
                    mapH: 338 * 7.5
                },
                {
                    name: '1 vs. 1 Duel',

                    diff: 'normal', // hard is without heals
                    bots: true, // false is with zombs only
                    botStrength: 'normal',
                    weaponSurvival: true,

                    edibles: false,
                    timesPlayed: 0,
                    desc: 'Defeat the other player to win! Random weapon each round.',
                    pond: 'none',
                    totalRocks: 1,
                    totalBots: 1,
                    mapW: 600 * 3,
                    mapH: 338 * 1
                },

                {
                    name: 'Tutorial',

                    diff: 'normal', // hard is without heals

                    bots: true, // false is with zombs only
                    botStrength: 'normal',
                    weaponSurvival: false,
                    edibles: false,
                    timesPlayed: 0,
                    desc: 'Get to know the basics of NATUWARS. Reward: +15 Trophies, +50 Gems',
                    pond: 'default',
                    totalRocks: 50,
                    mapW: 600 * 9,
                    mapH: 338 * 9
                },
            ];
            //gamemodes[gamemode]
            var gamemode = 0;

            var playerShopIndex = 'traits';

            var msg = '';
            //size(window.innerWidth, window.innerHeight, P2D);
            //scale(width/w,height/h);

            function formatTimePlayed(seconds) {
                var hours = Math.floor(seconds / 3600);
                var minutes = Math.floor((seconds % 3600) / 60);
                var remainingSeconds = Math.floor(seconds % 60);

                var timeString = "";
                if (hours > 0) {
                    timeString += hours + "h" + " ";
                }
                if (minutes > 0) {
                    timeString += minutes + "m" + " ";
                }
                timeString += remainingSeconds + "s";
                return timeString;
            }

            function characterIsSupported(
                character, font = getComputedStyle(document.body).fontFamily, recursion = false
            ) {
                let testCanvas = document.createElement("canvas");
                let referenceCanvas = document.createElement("canvas");
                testCanvas.width = referenceCanvas.width = testCanvas.height = referenceCanvas.height = 150;
                let testContext = testCanvas.getContext("2d");
                let referenceContext = referenceCanvas.getContext("2d");
                testContext.font = referenceContext.font = "100px " + font;
                testContext.fillStyle = referenceContext.fillStyle = "black";
                testContext.fillText(character, 0, 100);
                referenceContext.fillText('\uffff', 0, 100);

                if (!recursion && characterIsSupported('\ufffe', font, true)) {
                    testContext.fillStyle = referenceContext.fillStyle = "black";
                    testContext.fillRect(10, 10, 80, 80);
                    referenceContext.fillRect(10, 10, 80, 80);
                }
                return testCanvas.toDataURL() != referenceCanvas.toDataURL();
                return true;
            }

            // for backgrounds
            var bgColors = [
                color(random(0, 50), random(0, 50), random(200, 255), random(10, 20)), // January (Dark Blue)
                color(random(200, 255), random(200, 255), random(200, 255), random(10, 20)), // February (White)
                color(random(0, 50), random(200, 255), random(0, 50), random(10, 20)), // March (Green)
                color(random(200, 255), random(200, 255), random(0, 50), random(10, 20)), // April (Yellow)
                color(random(200, 255), random(0, 50), random(200, 255), random(10, 20)), // May (Pink)
                color(random(0, 50), random(200, 255), random(200, 255), random(10, 20)), // June (Cyan)
                color(random(200, 255), random(255, 255), random(0, 0), random(10, 15)), // July (Bright Yellow)
                color(random(200, 255), random(100, 50), random(0, 50), random(10, 20)), // August (Orange)
                color(random(50, 100), random(200, 255), random(50, 100), random(10, 20)), // September (Lime)
                color(random(150, 100), random(75, 50), random(0, 0), random(10, 20)), // October (Brown)
                color(random(150, 50), random(0, 0), random(0, 0), random(10, 20)), // November (Dark Red)
                color(random(0, 50), random(100, 150), random(150, 200), random(10, 20)) // December (Teal)
            ];


            /*** Main Globals ***/
            var click = false;
            mouseClicked = function() {
                click = true;
            };
            var keys = [];
            var scene = "load";

            var killText = ["2+ Score", "Double Kill!", "Triple Kill!", "Quadruple Kill", "Penta Kill!", "Multi Kill!", "Mega Kill!"];
            var names = [
                "ShadowHunter",
                "BlazeMaster",
                "GhostRecon",
                "ViperStrike",
                "StormRider",
                "IronFist",
                "NightStalker",
                "PhoenixFlame",
                "ThunderBolt",
                "DragonSlayer",
                "BladeRunner",
                "FrostBite",
                "VenomViper",
                "RogueWarrior",
                "SniperWolf",
                "DarkKnight",
                "MysticMage",
                "SilentAssassin",
                "CyberNinja",
                "SavageBeast",
                "DreadPirate",
                "LightningStrike",
                "WolfPack",
                "SteelTitan",
                "InfernoRage"
            ];
            var leaderboard = ["LeaferStudios - 6229", pl.name + ' - ' + pl.trophies, names[0] + ' - ' + ((pl.trophies + Math.floor(Math.random(1, 50))) * 0.5), names[1] + ' - ' + ((pl.trophies + 3) * 1), names[2] + ' - ' + ((pl.trophies + 1) * 6), names[3] + ' - ' + ((pl.trophies + 1) * 7), names[4] + ' - ' + ((pl.trophies + 1) * 11), names[5] + ' - ' + ((pl.trophies + 1) * 5), names[6] + ' - ' + ((pl.trophies + 1) * 8), names[7] + ' - ' + ((pl.trophies + 1) * 9)];
            leaderboard.sort(function(a, b) {
                // Extract the numeric values from the strings
                var scoreA = parseInt(a.split(' - ')[1], 10);
                var scoreB = parseInt(b.split(' - ')[1], 10);
                return scoreB - scoreA; // Sort in descending order
            });
            var _text = function(txt, x, y, s1, s2, type, clr, clr2, mx, wx, wr) {
                pushMatrix();
                translate(x, y);
                scale(s1, s2);
                if (wx) {
                    if (type) {
                        fill(clr);
                        text(txt, mx, 0, wx, wr);
                        text(txt, -mx, 0, wx, wr);
                        text(txt, 0, mx, wx, wr);
                        text(txt, 0, -mx, wx, wr);
                        text(txt, mx, mx, wx, wr);
                        text(txt, mx, -mx, wx, wr);
                        text(txt, -mx, mx, wx, wr);
                        text(txt, -mx, -mx, wx, wr);
                    } else {
                        pushMatrix();
                        translate(1, 1);
                        fill(clr);
                        text(txt, mx, 0, wx, wr);
                        text(txt, -mx, 0, wx, wr);
                        text(txt, 0, mx, wx, wr);
                        text(txt, 0, -mx, wx, wr);
                        text(txt, mx, mx, wx, wr);
                        text(txt, mx, -mx, wx, wr);
                        text(txt, -mx, mx, wx, wr);
                        text(txt, -mx, -mx, wx, wr);
                        popMatrix();
                    }

                    fill(clr2);
                    text(txt, 0, 0, wx, wr);
                } else {
                    if (type) {
                        fill(clr);
                        text(txt, mx, 0);
                        text(txt, -mx, 0);
                        text(txt, 0, mx);
                        text(txt, 0, -mx);
                        text(txt, mx, mx);
                        text(txt, mx, -mx);
                        text(txt, -mx, mx);
                        text(txt, -mx, -mx);
                    } else {
                        pushMatrix();
                        translate(1, 1);
                        fill(clr);
                        text(txt, mx, 0);
                        text(txt, -mx, 0);
                        text(txt, 0, mx);
                        text(txt, 0, -mx);
                        text(txt, mx, mx);
                        text(txt, mx, -mx);
                        text(txt, -mx, mx);
                        text(txt, -mx, -mx);
                        popMatrix();
                    }

                    fill(clr2);
                    text(txt, 0, 0);
                }
                popMatrix();
            };

            var cursorOn = true;
            var rocksSpawned = false;
            /*** Particles ***/

            var Particle = function(x, y, color, xal, yal, size, WIND, PRESSURE, dissNum) {
                this.x = x;
                this.y = y;
                this.color = color;
                this.size = size;
                this.xal = xal;
                this.yal = yal;
                this.w = WIND;
                this.press = PRESSURE;
                this.dissNum = dissNum;
            };
            Particle.prototype.display = function() {
                pushMatrix();
                var t = translate(this.x, this.y);
                fill(this.color);
                ellipse(0, 0, this.size, this.size);
                popMatrix();
            };
            Particle.prototype.run = function() {
                this.w += this.xal;
                this.press += this.yal;
                this.x += this.w;
                this.y += this.press;
                this.size -= this.dissNum;
            };
            Particle.prototype.create = function() {
                this.display();
                this.run();
            };
            var particles = [];

            var initiateParticles = function() {
                // for (var i = 0; i < particles.length; i++) {
                for (var i = particles.length - 1; i >= 0; i--) {
                    particles[i].create();
                    if (particles[i].size <= 0) {
                        particles.splice(i, 1);
                    }
                }
            };

            var approxeq = function(v1, v2, epsilon) {
                return Math.abs(v1 - v2) < epsilon;
            };
            var cam = {
                x: 0,
                y: 0,
                s: 1,
            };

            var intransition = false;
            var to = "";

            var Transitions = function() {
                this.t = 0;
                this.c = 255;
            };
            Transitions.prototype.create = function() {
                fill(255, 255, 255, this.c);
                rect(0, 0, width, height);
                if (this.t === 1) {
                    scene = to;
                }
                if (this.t < 30) {
                    this.c -= 10;
                }
                if (this.t > 30) {
                    this.c = 255;
                    this.t = 0;
                    intransition = false;
                }
                this.t++;
            };
            var goto = new Transitions();

            var randomPos = function() {
                var h1 = gd.gW;
                var w1 = gd.gH;

                var nh1 = Math.floor(Math.random() * h1);
                var nw1 = Math.floor(Math.random() * w1);

                return [nh1, nw1];
            };
            var sounds = {
                on: true,
            };
            var doSound = function(s) {
                if (sounds.on) {
                    return playSound(s);
                }
                return false;
            };

            var load = 0;
            var imgs = {
                grid: {
                    d: [w, h],
                    draw: function() {
                        for (var i = 0; i < w; i += 40) {
                            for (var j = 0; j < h; j += 40) {
                                //stroke(0, 0, 0, 40);
                                //stroke(98, 132, 61);
                                stroke(94, 127, 58);
                                strokeWeight(2.6);
                                //fill(70, 122, 7);
                                fill(105, 141, 65);

                                //fill(87, 87, 87);
                                rect(i, j, 40, 40);

                                //tree
                                //rgb(12, 85, 63)

                                //water
                                //rgb(1, 113, 188)
                                //rgb(1, 106, 176)

                                //rock

                                //rgb(109, 129, 150)
                                //rgb(68, 88, 110)
                                //rgb(52, 51, 52)
                            }
                        }
                    },
                },
                backgroundGrid: {
                    d: [w, h],
                    draw: function() {

                        for (var i = 0; i < w; i += 40) {
                            for (var j = 0; j < h; j += 40) {
                                //stroke(0, 0, 0, 40);
                                //stroke(98, 132, 61);
                                stroke(90, 99, 120);
                                strokeWeight(1);
                                noStroke();
                                //fill(70, 122, 7);
                                //  fill(121, 132, 148,random(200,255));

                                fill(bgColors[m - 1]);
                                //fill(87, 87, 87);
                                rect(i, j, random(40, width), height);

                                //tree
                                //rgb(12, 85, 63)

                                //water
                                //rgb(1, 113, 188)
                                //rgb(1, 106, 176)

                                //rock

                                //rgb(109, 129, 150)
                                //rgb(68, 88, 110)
                                //rgb(52, 51, 52)
                            }
                        }
                    },
                },
                gem: {
                    d: [75, 75],
                    draw: function() {
                        background(0, 0, 0, 0);
                        pushMatrix();
                        fill(0, 150, 209);
                        noStroke();
                        beginShape();
                        vertex(26, 50);
                        vertex(36, 72);
                        bezierVertex(36, 72, 36, 72, 36, 72);
                        vertex(17, 50);
                        vertex(26, 50);
                        endShape(CLOSE);
                        beginShape();
                        vertex(17, 30);
                        vertex(0, 30);
                        bezierVertex(0, 30, 1, 31, 1, 31);
                        vertex(17, 50);
                        vertex(23, 43);
                        vertex(17, 30);
                        endShape(CLOSE);
                        fill(118, 223, 255);
                        beginShape();
                        vertex(72, 31);
                        bezierVertex(71, 31, 70, 31, 70, 31);
                        bezierVertex(70, 30, 69, 30, 69, 30);
                        vertex(55, 30);
                        vertex(45, 20);
                        vertex(55, 10);
                        vertex(71, 29);
                        bezierVertex(71, 29, 71, 29, 71, 29);
                        vertex(71, 29);
                        bezierVertex(72, 29, 72, 30, 71, 31);
                        endShape(CLOSE);
                        beginShape();
                        vertex(36, 30);
                        vertex(45, 20);
                        vertex(36, 10);
                        vertex(27, 20);
                        vertex(36, 30);
                        endShape(CLOSE);
                        fill(89, 202, 252);
                        beginShape();
                        vertex(36, 72);
                        bezierVertex(36, 72, 36, 72, 36, 72);
                        vertex(46, 50);
                        vertex(55, 50);
                        vertex(36, 72);
                        endShape(CLOSE);
                        beginShape();
                        vertex(49, 43);
                        vertex(55, 50);
                        vertex(71, 31);
                        bezierVertex(71, 31, 72, 30, 72, 30);
                        vertex(55, 30);
                        vertex(49, 43);
                        endShape(CLOSE);
                        fill(39, 199, 255);
                        triangle(27, 20, 17, 30, 36, 30);
                        fill(176, 233, 255);
                        triangle(45, 20, 36, 30, 55, 30);
                        fill(0, 177, 255);
                        beginShape();
                        vertex(27, 20);
                        vertex(17, 30);
                        vertex(0, 30);
                        bezierVertex(0, 30, 0, 29, 1, 29);
                        vertex(16, 10);
                        bezierVertex(17, 10, 17, 10, 17, 10);
                        bezierVertex(17, 10, 17, 10, 18, 10);
                        bezierVertex(18, 10, 19, 10, 19, 11);
                        bezierVertex(19, 11, 19, 11, 19, 11);
                        vertex(27, 20);
                        endShape(CLOSE);
                        quad(36, 30, 49, 43, 55, 30, 36, 30);
                        quad(17, 30, 23, 43, 36, 30, 17, 30);
                        beginShape();
                        vertex(26, 50);
                        vertex(36, 72);
                        bezierVertex(36, 72, 36, 72, 36, 72);
                        vertex(46, 50);
                        vertex(26, 50);
                        endShape(CLOSE);
                        quad(49, 43, 46, 50, 55, 50, 49, 43);
                        fill(89, 202, 252);
                        quad(45, 20, 36, 10, 55, 10, 45, 20);
                        beginShape();
                        vertex(36, 10);
                        vertex(18, 10);
                        bezierVertex(18, 10, 17, 10, 17, 10);
                        vertex(27, 20);
                        vertex(36, 10);
                        endShape(CLOSE);
                        fill(0, 116, 168);
                        triangle(23, 43, 17, 50, 26, 50);
                        fill(0, 150, 209);
                        beginShape();
                        vertex(23, 43);
                        vertex(26, 50);
                        vertex(46, 50);
                        vertex(49, 43);
                        vertex(36, 30);
                        endShape(CLOSE);
                        fill(209, 253, 255);
                        beginShape();
                        vertex(53, 30);
                        bezierVertex(55, 31, 58, 33, 58, 35);
                        bezierVertex(58, 36, 59, 36, 59, 35);
                        bezierVertex(59, 33, 62, 31, 64, 30);
                        bezierVertex(65, 30, 65, 30, 64, 29);
                        bezierVertex(62, 29, 59, 27, 59, 24);
                        bezierVertex(59, 24, 58, 24, 58, 24);
                        bezierVertex(58, 27, 55, 29, 53, 29);
                        bezierVertex(52, 30, 52, 30, 53, 30);
                        endShape(CLOSE);
                        fill(176, 233, 255);
                        beginShape();
                        vertex(43, 4);
                        bezierVertex(44, 4, 45, 5, 46, 7);
                        bezierVertex(46, 7, 46, 7, 46, 7);
                        bezierVertex(46, 5, 47, 4, 49, 4);
                        bezierVertex(49, 4, 49, 3, 49, 3);
                        bezierVertex(47, 3, 46, 2, 46, 1);
                        bezierVertex(46, 0, 46, 0, 46, 1);
                        bezierVertex(45, 2, 44, 3, 43, 3);
                        bezierVertex(43, 3, 43, 4, 43, 4);
                        endShape(CLOSE);


                        popMatrix();

                    },
                },
                trophy: {
                    d: [75, 75],
                    draw: function() {
                        background(0, 0, 0, 0);
                        pushMatrix();
                        fill(255, 172, 51);
                        noStroke();
                        beginShape();
                        vertex(5, 5);
                        vertex(11, 5);
                        bezierVertex(12, 5, 13, 5, 13, 6);
                        vertex(13, 4);
                        bezierVertex(13, 3, 12, 2, 11, 2);
                        vertex(3, 2);
                        bezierVertex(1, 2, 0, 4, 0, 7);
                        bezierVertex(0, 7, 2, 16, 2, 17);
                        bezierVertex(2, 19, 4, 20, 6, 20);
                        vertex(13, 20);
                        bezierVertex(14, 20, 13, 18, 13, 17);
                        vertex(13, 15);
                        bezierVertex(13, 16, 12, 17, 11, 17);
                        vertex(7, 17);
                        bezierVertex(6, 17, 5, 16, 5, 15);
                        bezierVertex(5, 14, 4, 8, 4, 8);
                        bezierVertex(3, 6, 4, 5, 5, 5);
                        endShape(CLOSE);
                        beginShape();
                        vertex(31, 5);
                        vertex(25, 5);
                        bezierVertex(24, 5, 22, 5, 22, 6);
                        vertex(22, 4);
                        bezierVertex(22, 3, 24, 2, 25, 2);
                        vertex(33, 2);
                        bezierVertex(35, 2, 37, 4, 36, 7);
                        bezierVertex(36, 7, 34, 16, 34, 17);
                        bezierVertex(34, 19, 32, 20, 30, 20);
                        vertex(23, 20);
                        bezierVertex(22, 20, 22, 18, 22, 17);
                        vertex(22, 15);
                        bezierVertex(22, 16, 24, 17, 25, 17);
                        vertex(29, 17);
                        bezierVertex(30, 17, 31, 16, 31, 15);
                        bezierVertex(31, 14, 33, 8, 33, 8);
                        bezierVertex(33, 6, 32, 5, 31, 5);
                        endShape(CLOSE);
                        beginShape();
                        vertex(21, 22);
                        bezierVertex(21, 15, 18, 22, 18, 22);
                        bezierVertex(18, 22, 15, 15, 15, 22);
                        bezierVertex(15, 29, 12, 32, 12, 32);
                        vertex(24, 32);
                        bezierVertex(24, 32, 21, 29, 21, 22);
                        endShape(CLOSE);
                        fill(255, 204, 77);
                        beginShape();
                        vertex(29, 7);
                        bezierVertex(29, 13, 22, 25, 18, 25);
                        bezierVertex(14, 25, 7, 13, 7, 7);
                        bezierVertex(7, 1, 8, 0, 10, 0);
                        bezierVertex(11, 0, 16, 0, 18, 0);
                        vertex(25, 0);
                        bezierVertex(28, 0, 29, 1, 29, 7);
                        endShape(CLOSE);
                        fill(193, 105, 79);
                        beginShape();
                        vertex(27, 33);
                        bezierVertex(27, 34, 27, 35, 26, 35);
                        vertex(10, 35);
                        bezierVertex(9, 35, 9, 34, 9, 33);
                        vertex(9, 32);
                        bezierVertex(9, 31, 10, 30, 11, 30);
                        vertex(25, 30);
                        bezierVertex(26, 30, 27, 31, 27, 32);
                        vertex(27, 33);
                        endShape(CLOSE);
                        beginShape();
                        vertex(29, 35);
                        bezierVertex(29, 35, 29, 36, 28, 36);
                        vertex(8, 36);
                        bezierVertex(7, 36, 7, 35, 7, 35);
                        vertex(7, 34);
                        bezierVertex(7, 34, 8, 33, 8, 33);
                        vertex(28, 33);
                        bezierVertex(29, 33, 29, 34, 29, 34);
                        vertex(29, 35);
                        endShape(CLOSE);

                        popMatrix();

                    },
                }
            };
            var loadImages = function() {
                var img = imgs[Object.keys(imgs)[load]];
                img.draw();
                imgs[Object.keys(imgs)[load]] = get(0, 0, img.d[0], img.d[1]);
                background(0, 0, 0, 0);
                load++;
                if (load === Object.keys(imgs).length) {
                    scene = loadScene;
                }
            };

            var lineAngle = function(x, y, x2, y2) {
                return atan2(y2 - y, x2 - x);
            };

            var kscale = 0;
            var ktext = function(txt, x, y) {
                pushMatrix();
                pushStyle();
                translate(x + width / 2, y + 100);
                scale(kscale);
                kscale = lerp(kscale, 1, 0.25);

                textFont(createFont(fontss[0]), 45);
                textAlign(CENTER, CENTER);
                fill(0);
                text(txt, 0, 4);
                fill(255);
                text(txt, 0, 0);
                popStyle();
                popMatrix();
            };

            var musket = function(data) {
                pushMatrix();
                pushStyle();
                translate(data.x, data.y);

                if (data.thumb === true) {
                    pushMatrix();
                    translate(105, 140);
                    scale(0.07, 0.07);
                    fill(179);
                    noStroke();
                    beginShape();
                    vertex(193, 355);
                    bezierVertex(193, 355, 193, 355, 193, 355);
                    vertex(167, 381);
                    vertex(161, 375);
                    vertex(185, 351);
                    vertex(177, 325);
                    vertex(185, 322);
                    vertex(194, 350);
                    bezierVertex(195, 352, 195, 354, 193, 355);
                    endShape(CLOSE);
                    beginShape();
                    vertex(356, 128);
                    vertex(334, 125);
                    bezierVertex(331, 125, 329, 126, 327, 127);
                    vertex(327, 127);
                    vertex(299, 155);
                    vertex(311, 167);
                    vertex(336, 142);
                    vertex(342, 143);
                    vertex(314, 170);
                    vertex(326, 182);
                    vertex(364, 143);
                    vertex(474, 33);
                    vertex(463, 22);
                    vertex(356, 128);
                    endShape(CLOSE);
                    fill(102);
                    beginShape();
                    vertex(156, 362);
                    vertex(144, 415);
                    vertex(142, 416);
                    vertex(77, 508);
                    bezierVertex(74, 513, 67, 513, 63, 509);
                    bezierVertex(57, 501, 51, 494, 44, 488);
                    bezierVertex(37, 482, 29, 476, 21, 470);
                    bezierVertex(16, 467, 15, 460, 19, 456);
                    bezierVertex(19, 456, 138, 338, 139, 338);
                    vertex(156, 362);
                    endShape(CLOSE);
                    pushMatrix();
                    translate(388, 529);
                    rotate(157);
                    scale(1, 1);
                    rect(134, 289, 14, 28);
                    popMatrix();
                    pushMatrix();
                    translate(256, 570);
                    rotate(-157);
                    scale(1, 1);
                    rect(171, 252, 28, 14);
                    popMatrix();
                    fill(128);
                    beginShape();
                    vertex(188, 408);
                    bezierVertex(190, 413, 188, 420, 183, 423);
                    vertex(163, 435);
                    bezierVertex(159, 438, 154, 436, 152, 431);
                    vertex(144, 415);
                    vertex(130, 386);
                    vertex(137, 357);
                    vertex(163, 353);
                    vertex(175, 380);
                    vertex(188, 408);
                    endShape(CLOSE);
                    beginShape();
                    vertex(263, 298);
                    vertex(236, 325);
                    bezierVertex(233, 328, 228, 328, 225, 325);
                    vertex(202, 302);
                    vertex(240, 264);
                    vertex(263, 287);
                    bezierVertex(266, 290, 266, 295, 263, 298);
                    endShape(CLOSE);
                    fill(179);
                    beginShape();
                    vertex(256, 260);
                    vertex(242, 275);
                    vertex(208, 308);
                    vertex(192, 324);
                    vertex(163, 353);
                    vertex(130, 386);
                    vertex(118, 360);
                    bezierVertex(118, 360, 118, 360, 118, 359);
                    bezierVertex(115, 351, 117, 342, 123, 336);
                    vertex(154, 304);
                    vertex(202, 256);
                    vertex(228, 231);
                    vertex(256, 260);
                    endShape(CLOSE);
                    fill(77);
                    beginShape();
                    vertex(169, 268);
                    vertex(150, 286);
                    vertex(112, 325);
                    vertex(91, 303);
                    vertex(185, 209);
                    vertex(206, 230);
                    vertex(184, 252);
                    endShape(CLOSE);
                    fill(102);
                    beginShape();
                    vertex(297, 153);
                    vertex(223, 227);
                    vertex(223, 227);
                    bezierVertex(222, 228, 221, 229, 221, 231);
                    bezierVertex(221, 233, 222, 235, 223, 236);
                    vertex(252, 265);
                    bezierVertex(253, 266, 255, 267, 256, 266);
                    bezierVertex(258, 266, 260, 266, 261, 265);
                    bezierVertex(261, 264, 261, 264, 261, 264);
                    vertex(329, 185);
                    bezierVertex(332, 183, 332, 179, 329, 176);
                    vertex(306, 153);
                    bezierVertex(303, 150, 299, 150, 297, 153);
                    endShape(CLOSE);
                    fill(77);
                    beginShape();
                    vertex(318, 173);
                    vertex(250, 253);
                    bezierVertex(249, 253, 249, 253, 249, 253);
                    bezierVertex(248, 254, 247, 255, 245, 255);
                    bezierVertex(243, 255, 241, 254, 240, 253);
                    vertex(252, 265);
                    bezierVertex(253, 266, 255, 267, 256, 266);
                    bezierVertex(258, 266, 260, 266, 261, 265);
                    bezierVertex(261, 264, 261, 264, 261, 264);
                    vertex(329, 185);
                    bezierVertex(332, 183, 332, 179, 329, 176);
                    vertex(317, 165);
                    bezierVertex(320, 167, 320, 171, 318, 173);
                    endShape(CLOSE);
                    fill(179);
                    beginShape();
                    vertex(424, 79);
                    vertex(404, 60);
                    vertex(411, 44);
                    vertex(435, 68);
                    endShape(CLOSE);
                    fill(128);
                    beginShape();
                    vertex(212, 236);
                    bezierVertex(209, 240, 204, 240, 201, 236);
                    vertex(198, 234);
                    vertex(181, 217);
                    vertex(179, 214);
                    bezierVertex(176, 211, 176, 206, 179, 203);
                    bezierVertex(179, 203, 179, 203, 179, 203);
                    bezierVertex(182, 200, 187, 200, 191, 203);
                    vertex(193, 205);
                    vertex(210, 222);
                    vertex(212, 225);
                    bezierVertex(216, 228, 216, 233, 213, 236);
                    bezierVertex(213, 236, 213, 236, 212, 236);
                    endShape(CLOSE);
                    fill(102);
                    beginShape();
                    vertex(204, 216);
                    bezierVertex(207, 219, 207, 225, 204, 228);
                    bezierVertex(204, 228, 204, 228, 204, 228);
                    bezierVertex(201, 231, 196, 231, 192, 228);
                    vertex(198, 234);
                    vertex(201, 236);
                    bezierVertex(204, 240, 209, 240, 212, 236);
                    bezierVertex(212, 236, 213, 236, 213, 236);
                    bezierVertex(216, 233, 216, 228, 212, 225);
                    vertex(210, 222);
                    vertex(204, 216);
                    endShape(CLOSE);
                    fill(128);
                    beginShape();
                    vertex(118, 331);
                    bezierVertex(115, 334, 110, 334, 106, 331);
                    vertex(85, 309);
                    bezierVertex(81, 306, 81, 301, 85, 297);
                    bezierVertex(85, 297, 85, 297, 85, 297);
                    bezierVertex(88, 294, 93, 294, 96, 297);
                    vertex(99, 300);
                    vertex(118, 319);
                    bezierVertex(121, 322, 121, 328, 118, 331);
                    endShape(CLOSE);
                    fill(102);
                    beginShape();
                    vertex(110, 311);
                    bezierVertex(113, 314, 113, 319, 109, 322);
                    bezierVertex(109, 322, 109, 322, 109, 322);
                    bezierVertex(106, 325, 101, 325, 98, 322);
                    vertex(104, 328);
                    vertex(106, 331);
                    bezierVertex(110, 334, 115, 334, 118, 331);
                    bezierVertex(118, 331, 118, 331, 118, 331);
                    bezierVertex(121, 328, 121, 322, 118, 319);
                    vertex(116, 317);
                    vertex(110, 311);
                    endShape(CLOSE);
                    pushMatrix();
                    translate(814, -274);
                    rotate(136);
                    scale(1, 1);
                    fill(153);
                    rect(427, 11, 62, 26);
                    popMatrix();
                    pushMatrix();
                    translate(527, 370);
                    rotate(133);
                    scale(1, 1);
                    fill(102);
                    rect(151, 291, 71, 7);
                    popMatrix();
                    popMatrix();

                } else {

                    /*fill(184, 184, 184);
                    rect(-3.9, -64, 7, 40);
                    fill(25, 185, 209);
                    rect(-3.9, -64, 7, 9, -10, -10, 0, 0);*/
                    pushMatrix();
                    pushStyle();
                    scale(1, 1.5);
                    translate(-3.9, -40);
                    stroke(10, 10, 10);
                    strokeWeight(1);
                    fill(94, 94, 94);
                    rect(-3, 1, 10, 32, 90);

                    fill(179, 179, 179);
                    rect(0, -20, 4, 42, 10, 10, 0, 0);

                    rect(0, -9, 5, 9, 0);
                    rect(0, 21, 5, 9, 0);
                    popStyle();
                    popMatrix();
                }

                popStyle();
                popMatrix();
            };
            var pistol = function(data) {
                pushMatrix();
                pushStyle();
                translate(data.x, data.y);

                if (data.thumb === true) {
                    pushMatrix();
                    translate(data.x, data.y);
                    scale(data.s1 / 6, data.s2 / 6);
                    rotate(data.r);
                    strokeWeight(4);
                    stroke(186, 186, 186);

                    noStroke();
                    fill(66);
                    beginShape();
                    vertex(241, 222);
                    vertex(276, 257);
                    bezierVertex(290, 276, 289, 305, 271, 323);
                    vertex(220, 373);
                    vertex(243, 396);
                    vertex(294, 346);
                    bezierVertex(325, 315, 326, 266, 299, 233);
                    vertex(264, 198);
                    vertex(241, 222);
                    endShape(CLOSE);
                    beginShape();
                    vertex(219, 290);
                    vertex(148, 361);
                    vertex(257, 512);
                    vertex(328, 441);
                    endShape(CLOSE);
                    pushMatrix();
                    translate(-35, 565);
                    rotate(-45);
                    scale(-1.4, -1.4);
                    fill(112);
                    popMatrix();
                    pushMatrix();
                    translate(569, 315);
                    rotate(-45);
                    scale(-1.4, -1.4);
                    rect(200, 246, 26, 16, 3);
                    rect(-48, 245, 26, 16, 20);
                    popMatrix();
                    beginShape();
                    vertex(274, 367);
                    vertex(219, 290);
                    vertex(148, 361);
                    vertex(203, 437);
                    endShape(CLOSE);
                    fill(194);
                    beginShape();
                    vertex(384, 0);
                    vertex(91, 293);
                    bezierVertex(69, 315, 69, 350, 91, 372);
                    vertex(104, 358);
                    vertex(139, 393);
                    vertex(444, 88);
                    vertex(409, 53);
                    vertex(423, 39);
                    vertex(384, 0);
                    endShape(CLOSE);
                    fill(234);
                    beginShape();
                    vertex(409, 53);
                    vertex(423, 39);
                    vertex(384, 0);
                    vertex(91, 293);
                    bezierVertex(69, 315, 69, 350, 91, 372);
                    vertex(104, 358);
                    vertex(104, 358);
                    vertex(409, 53);
                    vertex(409, 53);
                    endShape(CLOSE);
                    fill(79, 79, 79);
                    pushMatrix();
                    translate(746, 324);
                    rotate(-45);
                    scale(-1.4, -1.4);
                    rect(223, 255, 21, 17, 30, 30, 0, 0);
                    popMatrix();

                    popMatrix();
                } else {
                    fill(247, 247, 247);
                    rect(-4.9, -50, 10, 25, 1, 1, 0, 0);

                    strokeWeight(1);
                    stroke(0, 0, 0, 80);
                    fill(0, 0, 0);
                    ellipse(2, -35, 0.3, 14.2);
                    ellipse(-1, -35, 0.3, 14.2);
                    ellipse(0, -46, 2, 2);
                }
                popStyle();
                popMatrix();
            };
            var arrifle = function(data) {
                pushMatrix();
                pushStyle();
                translate(data.x, data.y);
                if (data.thumb === true) {
                    pushMatrix();
                    translate(data.x + 115, data.y - 5);
                    scale(data.s1 / 4.5, data.s2 / 4.5);
                    rotate(data.r);
                    fill(0, 0, 0);
                    noStroke();
                    beginShape();
                    vertex(294, 242);
                    vertex(263, 272);
                    bezierVertex(300, 295, 344, 303, 387, 295);
                    vertex(378, 255);
                    bezierVertex(350, 260, 319, 256, 294, 242);
                    endShape(CLOSE);
                    beginShape();
                    vertex(154, 317);
                    bezierVertex(154, 318, 155, 319, 155, 320);
                    vertex(174, 339);
                    bezierVertex(175, 340, 177, 341, 179, 340);
                    bezierVertex(184, 338, 188, 343, 190, 352);
                    vertex(196, 382);
                    bezierVertex(197, 387, 202, 391, 208, 389);
                    vertex(212, 389);
                    bezierVertex(220, 387, 225, 379, 224, 370);
                    vertex(217, 338);
                    bezierVertex(216, 335, 217, 331, 220, 329);
                    vertex(247, 301);
                    bezierVertex(252, 297, 252, 289, 247, 284);
                    vertex(236, 273);
                    vertex(287, 222);
                    vertex(254, 190);
                    vertex(221, 223);
                    vertex(225, 227);
                    vertex(155, 297);
                    bezierVertex(155, 297, 154, 312, 154, 317);
                    endShape(CLOSE);
                    fill(77, 52, 8);
                    beginShape();
                    vertex(212, 315);
                    bezierVertex(208, 312, 208, 305, 212, 302);
                    vertex(223, 291);
                    bezierVertex(227, 287, 233, 287, 236, 291);
                    vertex(238, 293);
                    bezierVertex(242, 296, 242, 303, 238, 306);
                    vertex(227, 317);
                    bezierVertex(224, 321, 217, 321, 214, 317);
                    vertex(212, 315);
                    endShape(CLOSE);
                    beginShape();
                    vertex(112, 477);
                    bezierVertex(111, 478, 110, 479, 110, 479);
                    vertex(104, 485);
                    bezierVertex(102, 486, 99, 486, 97, 485);
                    vertex(55, 442);
                    bezierVertex(52, 439, 52, 434, 54, 431);
                    vertex(118, 361);
                    vertex(118, 361);
                    bezierVertex(119, 360, 121, 359, 123, 358);
                    vertex(126, 357);
                    bezierVertex(129, 356, 131, 355, 132, 353);
                    vertex(144, 335);
                    vertex(167, 359);
                    endShape(CLOSE);
                    beginShape();
                    vertex(384, 94);
                    bezierVertex(382, 92, 379, 92, 377, 94);
                    vertex(362, 110);
                    vertex(357, 105);
                    vertex(378, 84);
                    vertex(387, 87);
                    bezierVertex(392, 88, 398, 87, 402, 83);
                    vertex(428, 57);
                    vertex(419, 37);
                    bezierVertex(418, 34, 418, 31, 420, 29);
                    vertex(421, 28);
                    bezierVertex(424, 25, 429, 25, 431, 28);
                    vertex(447, 43);
                    vertex(453, 37);
                    vertex(460, 43);
                    vertex(453, 50);
                    vertex(456, 53);
                    vertex(380, 128);
                    vertex(368, 116);
                    vertex(384, 101);
                    bezierVertex(386, 99, 386, 96, 384, 94);
                    endShape(CLOSE);
                    beginShape();
                    vertex(344, 118);
                    vertex(362, 137);
                    bezierVertex(365, 140, 365, 144, 363, 147);
                    vertex(311, 208);
                    bezierVertex(308, 212, 303, 212, 300, 209);
                    vertex(277, 185);
                    bezierVertex(274, 183, 274, 178, 277, 175);
                    vertex(334, 118);
                    bezierVertex(336, 116, 341, 116, 344, 118);
                    endShape(CLOSE);
                    popMatrix();
                } else {
                    stroke(82, 82, 82);
                    strokeWeight(3);
                    fill(41, 41, 41);
                    rect(-3.9, -64, 7, 40);
                    fill(89, 89, 89);
                    rect(-2.55, -75, 1, 9, 0, 0, 0, 0);
                    stroke(105, 78, 40);
                    noFill();
                    rect(0, -75, 1, 9, 0, 0, 0, 0);
                }
                popStyle();
                popMatrix();
            };
            var smg = function(data) {
                pushMatrix();
                pushStyle();
                translate(data.x, data.y);
                if (data.thumb === true) {
                    pushMatrix();
                    translate(225, 140);
                    scale(data.s1 * 3, data.s2 * 3.6);
                    rotate(data.r);
                    fill(48, 25, 3);
                    strokeWeight(0.4);
                    stroke(89, 20, 10);
                    beginShape();
                    vertex(0, 22);
                    vertex(3, 25);
                    bezierVertex(3, 25, 3, 26, 4, 25);
                    bezierVertex(5, 24, 8, 17, 8, 17);
                    bezierVertex(8, 17, 9, 17, 9, 18);
                    bezierVertex(9, 19, 11, 24, 11, 24);
                    bezierVertex(11, 24, 11, 24, 12, 24);
                    bezierVertex(12, 23, 14, 22, 14, 22);
                    bezierVertex(14, 22, 14, 22, 14, 21);
                    bezierVertex(13, 20, 11, 16, 11, 16);
                    bezierVertex(11, 16, 11, 15, 11, 15);
                    bezierVertex(12, 14, 12, 14, 12, 14);
                    bezierVertex(12, 14, 12, 13, 13, 14);
                    bezierVertex(14, 14, 16, 16, 18, 17);
                    bezierVertex(21, 18, 24, 18, 24, 18);
                    bezierVertex(24, 18, 24, 18, 24, 17);
                    bezierVertex(24, 16, 24, 14, 24, 14);
                    bezierVertex(24, 14, 24, 14, 24, 14);
                    bezierVertex(23, 14, 22, 14, 21, 13);
                    bezierVertex(20, 13, 17, 11, 17, 11);
                    bezierVertex(17, 11, 16, 11, 17, 10);
                    bezierVertex(17, 10, 20, 7, 20, 7);
                    bezierVertex(20, 7, 21, 7, 20, 6);
                    bezierVertex(20, 6, 20, 6, 20, 6);
                    vertex(25, 1);
                    vertex(24, 0);
                    vertex(19, 5);
                    vertex(18, 4);
                    bezierVertex(18, 4, 18, 4, 18, 4);
                    bezierVertex(17, 4, 14, 7, 14, 7);
                    bezierVertex(14, 7, 13, 6, 12, 7);
                    bezierVertex(11, 8, 7, 11, 7, 11);
                    bezierVertex(7, 11, 7, 12, 7, 12);
                    bezierVertex(7, 13, 7, 13, 7, 13);
                    bezierVertex(7, 14, 5, 15, 5, 15);
                    bezierVertex(5, 15, 5, 15, 5, 16);
                    bezierVertex(5, 17, 4, 18, 4, 18);
                    bezierVertex(3, 19, 0, 21, 0, 21);
                    bezierVertex(0, 21, 0, 21, 0, 22);
                    endShape(CLOSE);
                    noStroke();
                    fill(0, 0, 0);
                    beginShape();
                    vertex(21, 3);
                    bezierVertex(21, 3, 19, 1, 19, 1);
                    bezierVertex(19, 0, 18, 0, 18, 1);
                    bezierVertex(17, 3, 17, 5, 17, 5);
                    vertex(19, 5);
                    bezierVertex(19, 5, 19, 4, 19, 4);
                    bezierVertex(19, 3, 19, 3, 19, 3);
                    bezierVertex(19, 4, 20, 4, 20, 4);
                    vertex(21, 3);
                    endShape(CLOSE);
                    beginShape();
                    vertex(11, 16);
                    bezierVertex(11, 16, 12, 16, 12, 16);
                    bezierVertex(13, 15, 13, 14, 13, 13);
                    bezierVertex(12, 12, 14, 14, 14, 14);
                    bezierVertex(14, 14, 14, 15, 13, 16);
                    bezierVertex(12, 17, 11, 18, 11, 18);
                    vertex(11, 16);
                    endShape(CLOSE);
                    popMatrix();
                } else {
                    stroke(0);
                    strokeWeight(2.5);
                    fill(77, 45, 11);
                    rect(-3.9, -60, 10, 33);
                    fill(255, 247, 255);
                    rect(-2.55, -65, 5, 9, 0, 0, 0, 0);
                    fill(0, 0, 0);
                    rect(0, -65, 2, 9 * 2, 0, 0, 0, 0);
                }
                popStyle();
                popMatrix();
            };

            var vanguard = function(data) {
                pushMatrix();
                pushStyle();
                translate(data.x, data.y);
                stroke(46, 46, 46);
                strokeWeight(1.5);
                fill(82, 82, 82);
                rect(-3.7, -63, 10, 40, 2, 2, 0, 0);
                rect(-3.7, -38, 10, 12, 1, 1, 0, 0);
                fill(122, 122, 122);
                rect(-2, -73, 6, 12, 1, 1, 0, 0);


                rect(0, -36, 3, 15);

                rect(0, -55, 3, 1);
                rect(0, -50, 3, 1);
                rect(0, -45, 3, 1);
                popStyle();
                popMatrix();
            };

            var nn = 'Hello World';
            var pp = 'center, bottom'; //default
            var gg = 50;
            var inNotif = false;
            var hitCursor = false;
            var hitReload = 0;

            var night = {
                op: 0,
                on: false,
            };

            var jj = {
                y: -10,
                fade: 0,
                clr: 'black',
            };
            var notif = function(txt, pos, g, clr) {
                nn = txt;
                pp = pos;
                gg = g;
                jj.clr = clr;
                inNotif = true;
            };
            var runNotifs = function() {
                if (gg > 0) {
                    gg--;
                    jj.y = lerp(jj.y, -30, 0.1);
                    jj.fade = lerp(jj.fade, 255, 0.05);
                    pushMatrix();
                    pushStyle();
                    rectMode(CENTER);
                    textAlign(CENTER, CENTER);
                    translate(width / 2, h + jj.y);

                    if (pp === 'center, bottom') {
                        if (jj.clr === 'black') {
                            fill(0, 0, 0, jj.fade);
                        } else if (jj.clr === 'red') {
                            fill(138, 14, 18, jj.fade);
                        } else if (jj.clr === 'green') {
                            fill(27, 117, 23, jj.fade);
                        } else if (jj.clr === 'blue') {
                            fill(18, 57, 125, jj.fade);
                        } else if (jj.clr === 'white') {
                            fill(255, 255, 255, jj.fade);
                        } else {
                            fill(117, 117, 117, jj.fade);
                        }
                        rect(0, 0, 300, 30);
                        textFont(createFont(fontss[1]), 14);
                        if (jj.clr === 'white') {
                            fill(0);
                        } else {
                            fill(255, 255, 255);
                        }
                        text(nn, -150, -20, 300, 30);
                    }
                    popStyle();
                    popMatrix();
                }

                if (gg <= 0) {
                    inNotif = false;
                    jj.y = 0;
                    jj.fade = 0;
                }
            };

            var mysteryMode = {
                weapon: ["sniper", "pistol", "rifle", "smg"][Math.floor(Math.random() * 4)], //randomWeapon(keep this in mind var enemyTypes = ["sniper", "pistol", "rifle", "smg"];)
            };

            var inv = {
                index: 3,
                total: 5,
                icon: "misc",
                colr: color(209, 210, 197),
                //    weapons: ["Empty","Pistol", "Sniper",  "Rifle", "SMG"],
                weapons: ["Empty", "Sniper", "Rifle", "SMG", "Pistol"],
                sniperExes: [-75, -15, 46, 105, 160],
                rifleExes: [-45, -15, 14, 45, 76],
                SMGExes: [-195, -134, -75, -15, 46],
            };
            inv.display = function() {

                pushMatrix();

                pushStyle();
                translate(-10, 135);
                scale(0.6);
                for (var i = 0; i < this.total; i++) {
                    stroke(245, 245, 242, 0);
                    strokeWeight(2);
                    fill(inv.colr);
                    rect(20 + i * 60, height - 60, 55, 55, 5);



                    if (i === this.index - 1) {
                        stroke(245, 245, 242);
                        strokeWeight(2);
                        fill(this.colr);
                        rect(20 + i * 60 - 2.5, height - 60 - 2.5, 60, 60, 5);
                    }
                    if (this.weapons.includes("Pistol")) {

                        pistol({
                            //x: ((this.weapons.indexOf("Pistol")+0)*15),
                            // x: this.weapons.indexOf("Pistol")===0?((this.weapons.indexOf("Pistol")+1)*15):((((this.weapons.indexOf("Pistol")+0.5)*2)*15)),
                            x: (this.weapons.indexOf("Pistol") + 0.5) * 30,
                            y: height - 196,
                            thumb: true,
                            s1: 0.4,
                            s2: 0.4,
                            r: 0,
                        });
                    }
                    if (this.weapons.includes("Sniper")) {
                        musket({
                            x: this.sniperExes[this.weapons.indexOf("Sniper")],
                            y: height - 196,
                            thumb: true,
                            s1: 0.4,
                            s2: 0.4,
                            r: 0,
                        });
                    }
                    if (this.weapons.includes("Rifle")) {
                        arrifle({
                            x: this.rifleExes[this.weapons.indexOf("Rifle")],
                            y: height - 196,
                            thumb: true,
                            s1: 0.4,
                            s2: 0.4,
                            r: 0,
                        });
                    }
                    if (this.weapons.includes("SMG")) {
                        smg({
                            x: this.SMGExes[this.weapons.indexOf("SMG")],
                            y: height - 196,
                            thumb: true,
                            s1: 0.4,
                            s2: 0.4,
                            r: 0,
                        });
                    }
                    textFont(createFont(fontss[1]), 6);
                    textAlign(LEFT, LEFT);
                    fill(0, 0, 0, 200);
                    _text('[' + (i + 1) + ']', 44 + i * 60, height - 10, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 0.8);
                    textAlign(LEFT, LEFT);
                    fill(255, 255, 255);
                    textSize(11);
                    // optional
                    if (testing === true) {
                        _text(this.weapons[i], 25 + i * 61, height - 55 - 20, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 1, 40, 60);
                    }
                }
                if (gamemode === 3 || gamemode === 4 || gamemode === 5) {
                    this.index = 1;
                    this.total = 1;
                    if (mysteryMode.weapon === "sniper") {
                        this.weapons = ["Sniper"];
                    } else if (mysteryMode.weapon === "pistol") {
                        this.weapons = ["Pistol"];
                    } else if (mysteryMode.weapon === "rifle") {
                        this.weapons = ["Rifle"];
                    } else if (mysteryMode.weapon === "smg") {
                        this.weapons = ["SMG"];
                    } else {
                        this.weapons = ["Empty"];
                    }
                } else if (gamemode === 2 || gamemode === 1 || gamemode === 0 || gamemode === 6) {
                    // only if total is 5 weapons (so basically not mystery mode)

                    if (keys[49] && this.total === 5) {
                        this.index = 1;
                    }
                    if (keys[50] && this.total === 5) {
                        this.index = 2;
                    }
                    if (keys[51] && this.total === 5) {
                        this.index = 3;
                    }
                    if (keys[52] && this.total === 5) {
                        this.index = 4;
                    }
                    if (keys[53] && this.total === 5) {
                        this.index = 5;
                    }
                    this.total = 5;
                    this.weapons = ["Empty", "SMG", "Rifle", "Sniper", "Pistol"];
                }
                popStyle();
                popMatrix();
            };
            inv.run = function() {
                this.display();
            };

            var zombs = [];
            var rocks = [];
            var enemies = [];

            /** This feature is not complete yet. **/
            var Harvest = function(x, y) {
                this.x = x;
                this.y = y;
                this.show = false;
                this.id = 12;
            };
            Harvest.prototype.display = function() {

                /*if (harvest.on === true) {
                            harvest.x = lerp(harvest.x, width/2, 0.25);
                            harvest.y = lerp(harvest.y, height/2, 0.25);
                        } else {
                            harvest.x = lerp(harvest.x, -600, 0.25);
                            harvest.y = lerp(harvest.y, -600, 0.25);
                        }*/
                if (this.show) {


                    this.x = lerp(this.x, width / 2, 0.15);
                    this.y = lerp(this.y, 90 / 2, 0.15);
                } else {
                    this.x = lerp(this.x, width / 2, 0.05);
                    this.y = lerp(this.y, -100, 0.05);
                }

                pushMatrix();
                pushStyle();
                translate(this.x, this.y);
                rectMode(CENTER);
                fill(39, 255, 15, this.y);
                rect(0, 0, 150, 90, 0, 0, 0, 0);
                textFont(createFont(fontss[0], 16));
                textAlign(LEFT, LEFT);
                fill(0);
                _text(this.id, -65, -38, 1, 1, true, color(0, 0, 0, 100), color(255, 255, 255), 1.5, 150, 90);
                popStyle();
                popMatrix();

            };
            var harvest = new Harvest(width / 2, -100);

            var weaponSpeed = {
                /*pistol: 35,
                musket: 35,
                ar: 35,
                smg: 35,*/

                pistol: 35,
                musket: 35,
                ar: 35,
                smg: 35,
            };
            var shooting = 0;
            // game animation (pregame)
            var ga = {
                x: 0,
                y: 0,
                s: 1,
                t: 0,
                done: false,
                msg_t: 0,
                msg_t2: 0,
            };
            var guns = {
                damage: [
                    [45, 80, 30, 15], // Level 1: Pistol, Sniper, AR Rifle, Submachine Gun
                    [50, 85, 35, 20], // Level 2
                    [55, 90, 40, 25], // Level 3
                    [60, 95, 45, 30], // Level 4
                    [65, 100, 50, 35] // Level 5
                ],
                reload: [
                    [30, 90, 20, 8], // Level 1: Pistol, Sniper, AR Rifle, Submachine Gun
                    [28, 88, 18, 7], // Level 2
                    [26, 86, 16, 6], // Level 3
                    [24, 84, 14, 5], // Level 4
                    [22, 82, 12, 4] // Level 5
                ],
                range: [
                    [18, 100, 45, 14], // Level 1: Pistol, Sniper, AR Rifle, Submachine Gun
                    [20, 105, 50, 16], // Level 2
                    [22, 110, 55, 18], // Level 3
                    [24, 115, 60, 20], // Level 4
                    [26, 120, 65, 22] // Level 5
                ],
            };
            var U = function(data) {
                this.trait = ''; // scout, juggernaut, bounty hunter, engineer? (building)
                this.traitlevel = 0;
                this.won = false;
                this.x = data.x;
                this.y = data.y;
                this.angle = 0;
                this.rad = data.rad;
                this.maxHealth = 100;
                this.axe = 1;
                this.altCursor = !true;
                this.cursorType = 0; //0 1 or 2 if altcursor is true

                this.xv = 0;
                this.yv = 0;
                this.speed = 0.6;
                this.normalSpeed = 0.6;
                this.scoutSpeed = 0.6 + (0.06 * this.traitlevel);

                this.skin = data.skin;
                this.weapon = "fists";
                this.reload = false;
                this.rnum = 0;
                this.kills = 0;

                this.shotsFired = [];

                this.health = data.health;
                this.haSize = 0;
                this.healRate = 4;
                this.zaSize = 0;

                this.killData = [];
                this.score = 0;

                //this.weaponDamage = [55, 100, 25, 15];
                //this.weaponReload = [35, 69, 15, 10]; // for upgrades
                //this.weaponDamageDefault = [55, 100, 25, 15];
                //this.weaponRange = [13,35,23,9];

                // too buff, have to lower or make enemies with higher hp
                /*
                this.weaponDamage = [
                    [55, 100, 25, 15],
                    [60, 105, 30, 20],
                    [65, 110, 35, 25],
                    [70, 115, 40, 30],
                    [75, 120, 45, 35]
                ];
                this.weaponReload = [
                    [35, 69, 15, 10],
                    [34, 68, 14, 9],
                    [33, 68, 13, 8],
                    [32, 67, 12, 7],
                    [31, 66, 11, 6]
                ];
                this.weaponRange = [
                    [13 + 5, 35, 23, 9 + 5],
                    [13 + 2 + 5, 35 + 2, 23 + 2, 9 + 5 + 2],
                    [13 + 4 + 5, 35 + 4, 23 + 4, 9 + 5 + 4],
                    [13 + 6 + 5, 35 + 6, 23 + 6, 9 + 5 + 6],
                    [13 + 8 + 5, 35 + 8, 23 + 8, 9 + 5 + 8]
                ];*/
                this.weaponDamage = guns.damage;

                this.weaponReload = guns.reload;

                this.weaponRange = guns.range;


                this.weaponDamageDefault = this.weaponDamage[0];
                this.weaponLevel = 0;

                this.food = 100;
                this.water = 100;

                this.wood = 0;
                this.rock = 0;

                this.money = 0;

                this.dead = false;
                this.timeAlive = 0;

                this.weapons = ["pistol", "musket", "AR", "SMG"];
                this.recoil = 0;
            };
            U.prototype.display = function() {
                pushMatrix();
                pushStyle();
                translate(this.x, this.y);
                scale(1);
                rotate(this.angle);
                noStroke();

                fill(67, 207, 16, 20);
                ellipse(0, 0, this.haSize * 5, this.haSize * 5);

                fill(255, 0, 0, 20);
                ellipse(0, 0, this.zaSize * 5, this.zaSize * 5);
                // ellipse(0, 0, this.zaSize*4, this.zaSize*4);
                //ellipse(0, 0, this.zaSize*3, this.zaSize*3);

                //textSize(300);
                //text(this.weaponLevel, 0, 0);

                stroke(0, 0, 0);
                stroke(52, 51, 52);
                strokeWeight(3);

                //fill(this.skin);
                fill(222, 173, 104);
                //    if (inv.index === 2) {
                //println(inv.weapons.indexOf("Pistol"));
                if (inv.index - 1 === inv.weapons.indexOf("Pistol")) {
                    pushMatrix();
                    translate(0, this.recoil);
                    ellipse(-6, -21, 18, 18);
                    ellipse(6, -21, 18, 18);
                    popMatrix();

                    //pistol({x:0,y:0});

                    //this.weapon = "pistol";

                    if (this.weapons[0] === "pistol") {
                        pistol({
                            x: 0,
                            y: this.recoil
                        });
                        this.weapon = "pistol";
                    }

                }
                //else if (inv.index === 3) {
                else if (inv.index - 1 === inv.weapons.indexOf("Sniper")) {

                    pushMatrix();
                    translate(0, this.recoil);
                    pushStyle();
                    fill(116, 92, 58);
                    arc(-6, -18, 9, 35, 180, 360);
                    popStyle();
                    ellipse(-2, -38, 14, 14);
                    ellipse(7, -20, 16, 16);
                    popMatrix();
                    if (this.weapons[1] === "musket") {
                        musket({
                            x: 4,
                            y: this.recoil,
                        });

                        this.weapon = "musket";
                    }
                }
                //else if (inv.index === 4) {
                else if (inv.index - 1 === inv.weapons.indexOf("Rifle")) {

                    pushMatrix();
                    translate(0, this.recoil);
                    pushStyle();
                    fill(116, 92, 58);
                    arc(-6, -18, 9, 35, 180, 360);
                    popStyle();
                    ellipse(-2, -38, 14, 14);
                    ellipse(7, -20, 16, 16);
                    popMatrix();
                    if (this.weapons[2] === "AR") {
                        arrifle({
                            x: 4,
                            y: this.recoil,
                        });
                        /*vanguard({
                            x: 4,
                            y: this.recoil,
                        });*/
                        this.weapon = "AR";
                    }
                }
                //else if (inv.index === 5) {
                else if (inv.index - 1 === inv.weapons.indexOf("SMG")) {
                    pushMatrix();
                    translate(0, this.recoil);
                    pushStyle();
                    fill(116, 92, 58);
                    arc(-6, -18, 9, 35, 180, 360);
                    popStyle();
                    ellipse(-2, -38, 14, 14);
                    ellipse(7, -20, 16, 16);
                    popMatrix();
                    if (this.weapons[3] === "SMG") {
                        smg({
                            x: 2,
                            y: 5 + this.recoil,
                        });
                        this.weapon = "SMG";
                    }
                } else {
                    ellipse(-14, -15, 20, 20);
                    ellipse(14, -15, 20, 20);

                    this.weapon = "fists";
                }



                pushStyle();
                noStroke();
                fill(0, 0, 0, 20);
                ellipse(0, 0, this.rad * 1.25, this.rad * 1.25);
                popStyle();

                fill(this.skin);
                ellipse(0, 0, this.rad, this.rad);

                popStyle();
                popMatrix();

            };
            U.prototype.update = function() {
                if (this.health > this.maxHealth) {
                    this.health = this.maxHealth;
                }
                this.angle = Math.atan2(mouseX - width / 2, -(mouseY - height / 2)) * (180 / PI);

                if (this.trait === 'Scout') {
                    // note: no upgrade on level 0 trait
                    this.speed = 0.6 + (0.06 * (this.traitlevel)); //+0.06
                }
                // added health
                if (this.trait === 'Juggernaut') {
                    this.maxHealth = 100 + (10 * this.traitlevel);
                }

                //println(this.trait + ' lvl ' + this.traitlevel+'\nspeed:' +this.speed+' ('+this.normalSpeed+')' + ' health: ' + this.health);

                //{
                if (keys[UP] || keys[87]) {
                    this.yv -= this.speed;
                }
                if (keys[DOWN] || keys[83]) {
                    this.yv += this.speed;
                }
                if (keys[LEFT] || keys[65]) {
                    this.xv -= this.speed;
                }
                if (keys[RIGHT] || keys[68]) {
                    this.xv += this.speed;
                }

                this.y += this.yv;
                this.x += this.xv;
                this.yv *= 0.89;
                this.xv *= 0.89;
                //} // Movement

                //{
                if (this.x <= 0) {
                    this.x = 0;
                }
                if (this.y <= 0) {
                    this.y = 0;
                }
                if (this.x >= gd.gW) {
                    this.x = gd.gW;
                }
                if (this.y >= gd.gH) {
                    this.y = gd.gH;
                }
                //} // Border Collisions

            };
            var rpe = 0; // reload player animation
            U.prototype.fight = function() {

                switch (this.weapon) {
                    case "fists":
                        this.rnum++;
                        if (this.rnum >= 50) {
                            this.reload = true;
                            this.rnum = 0;
                            shooting = 20;

                        }
                        break;
                    case "pistol":
                        this.rnum++;

                        if (rpe >= 1) {
                            rpe = 1;
                            if (mouseIsPressed) {
                                rpe = 0;
                            }
                        } else {
                            rpe = this.rnum / this.weaponReload[this.weaponLevel][0];
                        }
                        if (this.rnum >= this.weaponReload[this.weaponLevel][0]) {
                            if (mouseIsPressed) {
                                this.reload = true;
                                this.rnum = 0;
                            }

                            shooting = 9;

                        } else {
                            pushMatrix();
                            pushStyle();
                            translate(this.x - 40 / 2, this.y + 50);
                            rectMode(LEFT);
                            fill(0, 0, 0, 100);
                            rect(0, 0, 40, 5);
                            fill(255, 255, 255, 200);
                            rect(0, 0, rpe * 40, 5);
                            popStyle();
                            popMatrix();
                        }
                        break;
                    case "musket":
                        this.rnum++;

                        if (rpe >= 1) {
                            rpe = 1;
                            if (mouseIsPressed) {
                                rpe = 0;
                            }
                        } else {
                            rpe = this.rnum / this.weaponReload[this.weaponLevel][1];
                        }
                        if (this.rnum >= this.weaponReload[this.weaponLevel][1]) {


                            if (mouseIsPressed) {
                                this.reload = true;
                                this.rnum = 0;
                            }

                            shooting = 5;
                        } else {
                            pushMatrix();
                            pushStyle();
                            translate(this.x - 40 / 2, this.y + 50);
                            rectMode(LEFT);
                            fill(0, 0, 0, 100);
                            rect(0, 0, 40, 5);
                            fill(255, 255, 255, 200);
                            rect(0, 0, rpe * 40, 5);
                            popStyle();
                            popMatrix();
                        }
                        break;
                    case "AR":
                        this.rnum++;
                        if (this.rnum >= this.weaponReload[this.weaponLevel][2]) {
                            this.reload = true;
                            this.rnum = 0;
                            shooting = 20;

                        }
                        break;
                    case "SMG":
                        this.rnum++;
                        if (this.rnum >= this.weaponReload[this.weaponLevel][3]) {
                            this.reload = true;
                            this.rnum = 0;
                            shooting = 25;
                        }
                        break;
                }
            };
            U.prototype.collide = function(obj) {
                this.haSize = lerp(this.haSize, 0, 0.008);
                this.zaSize = lerp(this.zaSize, 0, 0.008);
                for (var i = 0; i < obj.length; i++) {
                    var radAngle = atan2(obj[i].y - this.y, obj[i].x - this.x);
                    var fromTan = dist(this.x, this.y, obj[i].x, obj[i].y) - this.rad / 2 - obj[i].rad / 2;
                    if (dist(this.x, this.y, obj[i].x, obj[i].y) <= (this.rad / 2 + obj[i].rad / 2)) {

                        if (obj === enemies && enemies[i].dead) {

                        } else {
                            obj[i].x -= cos(radAngle) * fromTan;
                            obj[i].y -= sin(radAngle) * fromTan;
                        }
                        if (obj === zombs) {
                            if (this.trait === 'bodyguard') {
                                this.health -= (1 - (this.traitlevel * 0.1));
                            } else {
                                this.health -= (1);
                            }
                            this.zaSize = lerp(this.zaSize, 50 + sin(frameCount * 5) * 10, 0.25);
                            pushStyle();
                            textFont(createFont(fontss[0]), 190);
                            textAlign(CENTER, CENTER);
                            fill(255, 255, 255, 50);
                            text("!", this.x, this.y);
                            popStyle();
                            this.x -= lerp(0, cos(radAngle) * fromTan, 0.25);
                            this.y -= lerp(0, sin(radAngle) * fromTan, 0.25);
                        }
                    }
                }
                //println(this.zaSize);

                if (this.zaSize < 1 && this.health < this.maxHealth) {
                    if (frameCount % 50 === 0) {
                        this.health += this.healRate;


                    }
                    this.haSize = lerp(this.haSize, 50 + sin(frameCount * 5) * 10, 0.25);
                    /*pushStyle();
                            textFont(createFont(fontss[0]), 90);
                            textAlign(CENTER, CENTER);
                            fill(255, 255, 255, 90);
                            text("+", this.x, this.y);
                            popStyle();*/
                }
            };
            U.prototype.rst = function() {
                //this.weaponDamage = this.weaponDamageDefault;
                this.weaponLevel = 0;
                rocksSpawned = false;
                rocks = [];
                mysteryMode.weapon = ["sniper", "pistol", "rifle", "smg"][Math.floor(Math.random() * 4)];
                this.killData = [];
                this.kills = 0;
                this.score = 0;
                this.food = 100;
                this.water = 100;
                this.dead = false;
                this.won = false;
                this.timeAlive = 0;
                this.health = 100;
            };
            U.prototype.run = function() {
                this.display();
                if (ga.done === true) {
                    this.update();
                    this.fight();
                }
            };

            var p = new U({
                //x: random(0, gd.gW), 
                //y: random(0, gd.gH),
                x: 300,
                y: 300,
                rad: 45,
                speed: 0.5,
                //skin: color(0xffBF8F54),
                skin: color(252, 200, 118),
                health: 100,
            });
            var model_p = new U({
                //x: random(0, gd.gW), 
                //y: random(0, gd.gH),
                x: 300,
                y: 300,
                rad: 45,
                speed: 0.5,
                //skin: color(0xffBF8F54),
                skin: color(252, 200, 118),
                health: 100,
            });

            var boom = function(x, y, t, h, c, spx, spy, x1, x2) {
                this.x = x;
                this.y = y;
                this.speedX = spx;
                this.speedY = spy;
                this.health = h;
                this.dieSpeed = random(5, 10);
                this.c = c;
                this.clr = color(212, 170, 111, 50);
                this.type = t;
                this.angle = p.angle - 90;
                this.x1 = x1;
                this.x2 = x2;
                this.z1 = 35;
            };
            boom.prototype.display = function() {
                if (this.type === "zomb") {
                    //this.clr = color(46, this.health/2, 17, this.health);
                    //this.health = 400;
                    //this.speedX = random(-5, 5);
                    //this.speedY = random(-5, 5);
                    //this.dieSpeed = random(10, 30);
                } else if (this.type === "bullet") {
                    //this.health = 50;
                    //this.clr = color(100, 100, 0, this.health);
                    //this.speedX = random(-5, 5);
                    //this.speedY = random(-5, 5);
                    //this.dieSpeed = random(10, 30);
                    this.r = p.angle - 90;
                }
                pushMatrix();
                if (this.type === 'bullet') {
                    translate(this.x + p.x + cos(this.angle) * this.x1, this.y + p.y + sin(this.angle) * this.x2);
                    rotate(this.r);
                    scale(0.5, 0.25);
                    //stroke(255, 150, 0);
                    //strokeWeight(0.5);
                    noStroke();

                    fill(this.c, this.z1);
                    arc(0, 0, 15, 9, 270, 360 + 90);
                    pushMatrix();
                    scale(1, 1);
                    triangle(0, 0, 10, 10, 0, 20);
                    popMatrix();

                } else {
                    translate(this.x, this.y);
                    rotate(this.r);
                    fill(this.clr);
                    ellipse(0, 0, this.health / random(10, 15), this.health / random(10, 15));
                }
                popMatrix();
            };
            boom.prototype.update = function() {
                this.health -= this.dieSpeed;
                this.x += this.speedX;
                this.y += this.speedY;
                this.z1 -= 1;
            };
            var booms = [];

            /**Will probably convert these into images**/
            var star = function(x, y, s1, s2, r, c1, c2) {
                pushMatrix();
                translate(x, y);
                scale(s1, s2);
                rotate(r);
                if (c1 === undefined || c2 === undefined) {
                    fill(252, 252, 146);
                    stroke(201, 190, 73);
                } else {
                    fill(c1);
                    stroke(c2);
                }
                strokeWeight(15);
                strokeCap(ROUND);
                strokeJoin(MITER);
                beginShape();
                vertex(150, 25);
                vertex(179, 111);
                vertex(269, 111);
                vertex(197, 165);
                vertex(223, 251);
                vertex(150, 200);
                vertex(77, 251);
                vertex(103, 165);
                vertex(31, 111);
                vertex(121, 111);
                endShape(CLOSE);
                popMatrix();
            };
            // waterdrop (can also act as acid drop)
            var waterdrop = function(x, y, s1, s2, r, c1, c2, c3, c4) {
                pushMatrix();
                pushStyle();
                translate(x, y);
                scale(s1, s2);
                rotate(r);
                if (c1 || c2 === undefined) {
                    c1 = color(7, 72, 125);
                    c2 = color(41, 126, 245);
                    c3 = color(153, 226, 255);
                    c4 = color(3, 179, 255);
                }
                fill(c1);
                noStroke();
                beginShape();
                vertex(211, 76);
                bezierVertex(254, 118, 254, 188, 211, 231);
                bezierVertex(190, 251, 161, 263, 131, 263);
                bezierVertex(101, 263, 73, 251, 52, 231);
                bezierVertex(31, 210, 19, 182, 19, 153);
                bezierVertex(19, 124, 31, 96, 52, 76);
                vertex(125, 2);
                bezierVertex(129, -1, 134, -1, 137, 2);
                vertex(211, 76);
                endShape(CLOSE);
                beginShape();
                vertex(199, 219);
                bezierVertex(236, 183, 236, 123, 199, 87);
                bezierVertex(199, 87, 199, 87, 199, 87);
                vertex(131, 20);
                vertex(64, 87);
                bezierVertex(46, 105, 36, 128, 36, 153);
                bezierVertex(36, 178, 46, 202, 64, 219);
                bezierVertex(82, 237, 106, 247, 131, 247);
                bezierVertex(157, 247, 181, 237, 199, 219);
                endShape(CLOSE);
                beginShape();
                vertex(189, 88);
                bezierVertex(190, 89, 220, 115, 213, 159);
                bezierVertex(213, 163, 209, 165, 205, 165);
                bezierVertex(205, 165, 204, 165, 204, 165);
                bezierVertex(199, 165, 196, 161, 197, 156);
                bezierVertex(202, 122, 178, 100, 178, 100);
                bezierVertex(175, 97, 174, 92, 177, 89);
                bezierVertex(181, 85, 186, 85, 189, 88);
                endShape(CLOSE);
                beginShape();
                vertex(204, 172);
                bezierVertex(207, 174, 209, 179, 206, 183);
                vertex(202, 190);
                bezierVertex(200, 192, 197, 194, 195, 194);
                bezierVertex(193, 194, 192, 193, 190, 192);
                bezierVertex(186, 190, 185, 185, 188, 181);
                vertex(192, 174);
                bezierVertex(195, 170, 200, 169, 204, 172);
                endShape(CLOSE);
                fill(c2);
                beginShape();
                vertex(199, 87);
                bezierVertex(236, 123, 236, 183, 199, 219);
                bezierVertex(181, 237, 157, 247, 131, 247);
                bezierVertex(106, 247, 82, 237, 64, 219);
                bezierVertex(46, 202, 36, 178, 36, 153);
                bezierVertex(36, 128, 46, 105, 64, 87);
                vertex(131, 20);
                vertex(199, 87);
                bezierVertex(199, 87, 199, 87, 199, 87);
                endShape(CLOSE);
                beginShape();
                fill(c3);
                vertex(213, 158);
                bezierVertex(220, 115, 190, 89, 189, 88);
                bezierVertex(186, 85, 181, 85, 177, 89);
                bezierVertex(174, 92, 175, 97, 178, 100);
                bezierVertex(178, 100, 202, 122, 197, 156);
                bezierVertex(196, 161, 199, 165, 204, 165);
                bezierVertex(204, 165, 205, 165, 205, 165);
                bezierVertex(209, 165, 213, 163, 213, 158);
                endShape(CLOSE);
                beginShape();
                vertex(206, 183);
                bezierVertex(209, 179, 207, 174, 204, 172);
                bezierVertex(200, 169, 195, 170, 192, 174);
                vertex(188, 181);
                bezierVertex(185, 185, 186, 190, 190, 192);
                bezierVertex(192, 193, 193, 194, 195, 194);
                bezierVertex(197, 194, 200, 192, 202, 190);
                vertex(206, 183);
                endShape(CLOSE);
                fill(c4);
                beginShape();
                vertex(48, 108);
                bezierVertex(40, 122, 36, 137, 36, 153);
                bezierVertex(36, 178, 46, 202, 64, 219);
                bezierVertex(82, 237, 106, 247, 131, 247);
                bezierVertex(151, 247, 170, 241, 186, 230);
                bezierVertex(77, 236, 49, 164, 48, 108);
                endShape(CLOSE);
                popStyle();
                popMatrix();
            };
            // purple grape (can also turn into green grape - not implemented yet)
            var grape = function(x, y, s1, s2, r, c1, c2, c3, c4) {
                pushMatrix();
                pushStyle();
                translate(x, y);
                scale(s1, s2);
                rotate(r);
                if (c1 || c2 === undefined) {
                    /*
                    c1 = color(7, 72, 125);
                    c2=color(41, 126, 245);
                    c3=color(153, 226, 255);
                    c4=color(3, 179, 255);
                    */
                }
                fill(81, 170, 0);
                noStroke();
                beginShape();
                vertex(66, 11);
                bezierVertex(62, 16, 62, 21, 64, 26);
                bezierVertex(70, 26, 75, 23, 79, 18);
                bezierVertex(82, 13, 82, 7, 80, 2);
                bezierVertex(74, 3, 69, 6, 66, 11);
                endShape(CLOSE);
                fill(105, 85, 23);
                beginShape();
                vertex(64, 46);
                bezierVertex(63, 46, 62, 45, 62, 44);
                vertex(62, 30);
                bezierVertex(62, 25, 60, 21, 56, 19);
                bezierVertex(55, 18, 55, 17, 56, 16);
                bezierVertex(56, 15, 57, 15, 58, 15);
                bezierVertex(63, 19, 66, 24, 66, 30);
                vertex(66, 44);
                bezierVertex(66, 45, 66, 46, 64, 46);
                endShape(CLOSE);
                fill(144, 35, 107);
                ellipse(92, 52, 22, 21);
                fill(93, 26, 71);
                ellipse(36, 52, 22, 21);
                fill(144, 35, 107);
                ellipse(54, 44, 22, 21);
                fill(153, 73, 154);
                ellipse(74, 44, 22, 21);
                fill(144, 35, 107);
                ellipse(64, 58, 22, 21);
                fill(93, 26, 71);
                ellipse(84, 58, 22, 21);
                fill(153, 73, 154);
                ellipse(47, 59, 22, 21);
                fill(93, 26, 71);
                ellipse(36, 72, 22, 21);
                fill(144, 35, 107);
                ellipse(54, 73, 22, 21);
                fill(153, 73, 154);
                ellipse(74, 73, 24, 23);
                fill(144, 35, 107);
                ellipse(90, 72, 22, 21);
                fill(153, 73, 154);
                ellipse(46, 88, 24, 23);
                fill(93, 26, 71);
                ellipse(65, 88, 23, 23);
                fill(144, 35, 107);
                ellipse(84, 88, 23, 23);
                ellipse(56, 102, 22, 21);
                fill(153, 73, 154);
                ellipse(75, 103, 22, 21);
                fill(93, 26, 71);
                ellipse(67, 115, 22, 21);
                fill(250, 203, 241, 80);
                ellipse(31, 50, 5, 7);
                ellipse(51, 41, 5, 7);
                ellipse(43, 57, 5, 7);
                ellipse(31, 70, 5, 7);
                ellipse(41, 86, 5, 7);
                ellipse(54, 99, 5, 7);
                ellipse(51, 70, 5, 7);
                ellipse(63, 54, 5, 7);
                ellipse(74, 40, 5, 7);
                ellipse(71, 70, 5, 7);
                ellipse(63, 84, 5, 7);
                ellipse(73, 99, 5, 7);
                ellipse(64, 113, 5, 7);
                ellipse(81, 86, 5, 7);
                ellipse(90, 69, 5, 7);
                ellipse(81, 57, 5, 7);
                ellipse(95, 47, 5, 7);
                popStyle();
                popMatrix();
            };

            var skull = function(x, y, s1, s2, r, c1, c2) {
                pushMatrix();
                translate(x, y);
                scale(s1, s2);
                rotate(r);
                fill(204, 214, 221);
                noStroke();
                beginShape();
                vertex(28, 17);
                bezierVertex(28, 11, 23, 7, 18, 7);
                bezierVertex(12, 7, 8, 11, 8, 17);
                bezierVertex(8, 20, 8, 23, 12, 25);
                vertex(12, 27);
                bezierVertex(12, 28, 13, 29, 14, 29);
                bezierVertex(15, 29, 16, 28, 16, 27);
                vertex(16, 25);
                vertex(16, 27);
                bezierVertex(16, 28, 17, 29, 18, 29);
                bezierVertex(19, 29, 20, 28, 20, 27);
                vertex(20, 25);
                vertex(20, 27);
                bezierVertex(20, 28, 21, 29, 22, 29);
                bezierVertex(23, 29, 24, 28, 24, 27);
                vertex(24, 25);
                bezierVertex(28, 23, 28, 20, 28, 17);
                endShape(CLOSE);
                fill(41, 47, 51);
                ellipse(14, 16, 6, 6);
                ellipse(22, 16, 6, 6);
                beginShape();
                vertex(19, 21);
                bezierVertex(19, 21, 19, 20, 18, 20);
                bezierVertex(17, 20, 17, 21, 17, 21);
                bezierVertex(16, 21, 16, 22, 16, 23);
                bezierVertex(17, 23, 18, 23, 18, 22);
                bezierVertex(18, 22, 18, 22, 18, 22);
                bezierVertex(18, 22, 18, 22, 18, 22);
                bezierVertex(18, 23, 19, 23, 20, 23);
                bezierVertex(20, 22, 20, 21, 19, 21);
                endShape(CLOSE);
                fill(170, 184, 194);
                beginShape();
                vertex(11, 27);
                bezierVertex(11, 27, 11, 26, 11, 26);
                bezierVertex(10, 26, 9, 25, 9, 24);
                bezierVertex(8, 25, 7, 26, 6, 27);
                bezierVertex(5, 26, 4, 26, 4, 26);
                bezierVertex(2, 26, 0, 28, 0, 30);
                bezierVertex(0, 31, 1, 33, 3, 33);
                bezierVertex(3, 35, 5, 36, 7, 36);
                bezierVertex(8, 36, 10, 34, 10, 33);
                bezierVertex(10, 32, 10, 31, 9, 30);
                bezierVertex(10, 30, 11, 29, 11, 28);
                bezierVertex(11, 28, 11, 27, 11, 27);
                endShape(CLOSE);
                beginShape();
                vertex(28, 12);
                bezierVertex(29, 11, 30, 10, 30, 9);
                bezierVertex(31, 10, 32, 10, 32, 10);
                bezierVertex(34, 10, 36, 8, 36, 7);
                bezierVertex(36, 5, 35, 3, 33, 3);
                bezierVertex(33, 1, 31, 0, 30, 0);
                bezierVertex(28, 0, 26, 2, 26, 4);
                bezierVertex(26, 4, 26, 5, 27, 6);
                bezierVertex(26, 6, 25, 7, 25, 8);
                bezierVertex(26, 9, 27, 10, 28, 12);
                endShape(CLOSE);
                beginShape();
                vertex(4, 10);
                bezierVertex(4, 10, 5, 10, 6, 9);
                bezierVertex(6, 10, 7, 11, 8, 12);
                bezierVertex(9, 10, 10, 9, 11, 8);
                bezierVertex(11, 7, 10, 6, 9, 6);
                bezierVertex(10, 5, 10, 4, 10, 4);
                bezierVertex(10, 2, 8, 0, 7, 0);
                bezierVertex(5, 0, 3, 1, 3, 3);
                bezierVertex(1, 3, 0, 5, 0, 7);
                bezierVertex(0, 8, 2, 10, 4, 10);
                endShape(CLOSE);
                beginShape();
                vertex(32, 26);
                bezierVertex(32, 26, 31, 26, 30, 27);
                bezierVertex(29, 26, 28, 25, 27, 24);
                bezierVertex(27, 25, 26, 26, 25, 26);
                bezierVertex(25, 26, 25, 27, 25, 27);
                bezierVertex(25, 27, 25, 28, 25, 28);
                bezierVertex(25, 29, 26, 30, 27, 30);
                bezierVertex(26, 31, 26, 32, 26, 33);
                bezierVertex(26, 34, 28, 36, 30, 36);
                bezierVertex(31, 36, 33, 35, 33, 33);
                bezierVertex(35, 33, 36, 31, 36, 30);
                bezierVertex(36, 28, 34, 26, 32, 26);
                endShape(CLOSE);

                popMatrix();
            };
            var people3 = function(x, y, s1, s2, r, c1, c2) {
                pushMatrix();
                translate(x, y);
                scale(s1 / 14, s2 / 14);
                rotate(r);
                if (c1 === undefined || c2 === undefined) {
                    c1 = color(247, 224, 72);
                    c2 = color(2, 60, 89);
                }
                fill(c1);
                stroke(20, 20, 20);
                strokeWeight(12);
                beginShape();
                vertex(436, 288);
                bezierVertex(468, 288, 495, 261, 495, 229);
                bezierVertex(495, 196, 468, 170, 436, 170);
                bezierVertex(403, 170, 377, 196, 377, 229);
                bezierVertex(377, 261, 403, 288, 436, 288);
                endShape(CLOSE);
                fill(c2);
                beginShape();
                vertex(511, 344);
                bezierVertex(509, 328, 496, 306, 486, 297);
                bezierVertex(485, 295, 479, 295, 477, 296);
                bezierVertex(465, 303, 451, 308, 436, 308);
                bezierVertex(421, 308, 407, 303, 395, 296);
                bezierVertex(393, 295, 387, 295, 386, 297);
                bezierVertex(383, 299, 380, 303, 377, 307);
                bezierVertex(385, 322, 392, 338, 394, 352);
                bezierVertex(396, 365, 395, 378, 392, 390);
                bezierVertex(405, 395, 420, 397, 436, 397);
                bezierVertex(476, 397, 518, 383, 511, 344);
                endShape(CLOSE);
                fill(c1);
                beginShape();
                vertex(254, 263);
                bezierVertex(307, 263, 350, 220, 350, 167);
                bezierVertex(350, 115, 307, 72, 254, 72);
                bezierVertex(202, 72, 159, 115, 159, 167);
                bezierVertex(159, 220, 202, 263, 254, 263);
                endShape(CLOSE);
                fill(c2);
                beginShape();
                vertex(335, 277);
                bezierVertex(333, 275, 324, 275, 321, 276);
                bezierVertex(302, 288, 279, 295, 254, 295);
                bezierVertex(230, 295, 207, 288, 188, 276);
                bezierVertex(185, 275, 176, 275, 174, 277);
                bezierVertex(158, 293, 137, 329, 132, 355);
                bezierVertex(122, 417, 189, 440, 254, 440);
                bezierVertex(320, 440, 387, 417, 377, 355);
                bezierVertex(372, 329, 351, 293, 335, 277);
                endShape(CLOSE);
                fill(c1);
                beginShape();
                vertex(76, 288);
                bezierVertex(109, 288, 135, 261, 135, 229);
                bezierVertex(135, 196, 109, 170, 76, 170);
                bezierVertex(44, 170, 17, 196, 17, 229);
                bezierVertex(17, 261, 44, 288, 76, 288);
                endShape(CLOSE);
                beginShape();
                fill(c2);

                vertex(115, 352);
                bezierVertex(118, 337, 124, 320, 133, 305);
                bezierVertex(130, 302, 128, 299, 126, 297);
                bezierVertex(125, 295, 119, 295, 117, 296);
                bezierVertex(105, 303, 91, 308, 76, 308);
                bezierVertex(61, 308, 47, 303, 35, 296);
                bezierVertex(33, 295, 27, 295, 26, 297);
                bezierVertex(16, 306, 3, 328, 1, 344);
                bezierVertex(-6, 383, 36, 397, 76, 397);
                bezierVertex(90, 397, 105, 395, 118, 391);
                bezierVertex(114, 379, 113, 366, 115, 352);
                endShape(CLOSE);


                popMatrix();
            };

            function treeSide(x, y, s1, s2, r, f1, f2) {
                pushMatrix();
                translate(x, y);
                scale(s1, s2);
                rotate(r);

                fill(f1);
                noStroke();
                beginShape();
                vertex(676, 140);
                bezierVertex(592, 56, 385, 56, 300, 140);
                bezierVertex(236, 205, 248, 438, 315, 516);
                bezierVertex(377, 587, 270, 628, 345, 702);
                bezierVertex(410, 767, 568, 767, 633, 702);
                bezierVertex(707, 629, 602, 581, 662, 516);
                bezierVertex(727, 446, 741, 205, 676, 140);
                endShape(CLOSE);
                fill(f2);
                beginShape();
                vertex(612, 394);
                bezierVertex(618, 388, 618, 379, 612, 373);
                bezierVertex(607, 367, 597, 367, 591, 373);
                vertex(512, 452);
                vertex(512, 330);
                bezierVertex(512, 318, 502, 309, 491, 309);
                bezierVertex(478, 309, 469, 319, 469, 330);
                vertex(469, 418);
                vertex(352, 351);
                bezierVertex(345, 347, 336, 350, 332, 357);
                bezierVertex(328, 364, 331, 373, 338, 377);
                vertex(469, 452);
                vertex(469, 602);
                vertex(431, 565);
                bezierVertex(426, 559, 416, 559, 410, 565);
                bezierVertex(405, 570, 405, 579, 410, 585);
                vertex(468, 643);
                vertex(468, 1001);
                vertex(512, 1001);
                vertex(512, 698);
                vertex(573, 663);
                bezierVertex(580, 659, 582, 650, 578, 643);
                bezierVertex(574, 636, 565, 633, 558, 637);
                vertex(512, 664);
                vertex(512, 493);
                vertex(612, 394);
                endShape(CLOSE);

                popMatrix();
            }

            function NATUWARS_TXT(x, y, s1, s2, r, fl, bg) {
                pushMatrix();
                translate(x, y);
                scale(s1, s2);
                rotate(r);
                pushMatrix();
                translate(18, 100);
                fill(fl);
                noStroke();
                beginShape();
                vertex(53, -48);
                vertex(53, -4);
                vertex(53, -4);
                bezierVertex(53, -3, 53, -3, 53, -2);
                vertex(53, -2);
                vertex(53, -2);
                bezierVertex(53, -1, 52, -1, 52, -1);
                vertex(52, -1);
                vertex(52, -1);
                bezierVertex(52, 0, 51, 0, 51, 0);
                vertex(51, 0);
                vertex(51, 0);
                bezierVertex(50, 1, 50, 1, 49, 1);
                vertex(49, 1);
                vertex(49, 1);
                bezierVertex(48, 1, 48, 1, 47, 0);
                vertex(47, 0);
                vertex(47, 0);
                bezierVertex(47, 0, 46, 0, 46, -1);
                vertex(46, -1);
                vertex(14, -34);
                vertex(14, 0);
                vertex(5, 0);
                vertex(5, -45);
                vertex(5, -45);
                bezierVertex(5, -45, 5, -46, 6, -47);
                vertex(6, -47);
                vertex(6, -47);
                bezierVertex(6, -48, 7, -48, 8, -49);
                vertex(8, -49);
                vertex(8, -49);
                bezierVertex(9, -49, 9, -49, 10, -49);
                vertex(10, -49);
                vertex(10, -49);
                bezierVertex(11, -49, 12, -48, 13, -48);
                vertex(13, -48);
                vertex(45, -14);
                vertex(45, -48);
                vertex(53, -48);
                endShape(CLOSE);
                beginShape();
                vertex(111, -44);
                vertex(111, 0);
                vertex(102, 0);
                vertex(102, -12);
                vertex(71, -12);
                vertex(71, 0);
                vertex(63, 0);
                vertex(63, -24);
                vertex(63, -24);
                bezierVertex(63, -28, 63, -31, 64, -34);
                vertex(64, -34);
                vertex(64, -34);
                bezierVertex(66, -37, 67, -39, 70, -42);
                vertex(70, -42);
                vertex(70, -42);
                bezierVertex(72, -44, 74, -45, 77, -47);
                vertex(77, -47);
                vertex(77, -47);
                bezierVertex(80, -48, 83, -48, 87, -48);
                vertex(87, -48);
                vertex(107, -48);
                vertex(107, -48);
                bezierVertex(107, -48, 108, -48, 108, -48);
                vertex(108, -48);
                vertex(108, -48);
                bezierVertex(109, -48, 109, -47, 110, -47);
                vertex(110, -47);
                vertex(110, -47);
                bezierVertex(110, -47, 110, -46, 111, -46);
                vertex(111, -46);
                vertex(111, -46);
                bezierVertex(111, -45, 111, -45, 111, -44);
                vertex(111, -44);
                endShape(CLOSE);
                fill(bg);
                beginShape();
                vertex(71, -24);
                vertex(71, -21);
                vertex(102, -21);
                vertex(102, -40);
                vertex(87, -40);
                vertex(87, -40);
                bezierVertex(87, -40, 86, -40, 85, -39);
                vertex(85, -39);
                vertex(85, -39);
                bezierVertex(84, -39, 83, -39, 82, -39);
                vertex(82, -39);
                vertex(82, -39);
                bezierVertex(81, -39, 80, -38, 79, -37);
                vertex(79, -37);
                vertex(79, -37);
                bezierVertex(77, -37, 76, -36, 75, -35);
                vertex(75, -35);
                vertex(75, -35);
                bezierVertex(74, -34, 73, -32, 72, -30);
                vertex(72, -30);
                vertex(72, -30);
                bezierVertex(72, -29, 71, -27, 71, -24);
                vertex(71, -24);
                endShape(CLOSE);
                fill(fl);
                beginShape();
                vertex(165, -48);
                vertex(165, -40);
                vertex(145, -40);
                vertex(145, 0);
                vertex(137, 0);
                vertex(137, -40);
                vertex(117, -40);
                vertex(117, -48);
                vertex(165, -48);
                endShape(CLOSE);
                beginShape();
                vertex(219, -48);
                vertex(219, -4);
                vertex(219, -4);
                bezierVertex(219, -4, 218, -3, 218, -3);
                vertex(218, -3);
                vertex(218, -3);
                bezierVertex(218, -2, 218, -2, 217, -1);
                vertex(217, -1);
                vertex(217, -1);
                bezierVertex(217, -1, 216, -1, 216, 0);
                vertex(216, 0);
                vertex(216, 0);
                bezierVertex(215, 0, 215, 0, 214, 0);
                vertex(214, 0);
                vertex(194, 0);
                vertex(194, 0);
                bezierVertex(193, 0, 191, 0, 189, -1);
                vertex(189, -1);
                vertex(189, -1);
                bezierVertex(187, -1, 185, -2, 183, -2);
                vertex(183, -2);
                vertex(183, -2);
                bezierVertex(181, -3, 180, -4, 178, -6);
                vertex(178, -6);
                vertex(178, -6);
                bezierVertex(177, -7, 175, -9, 174, -10);
                vertex(174, -10);
                vertex(174, -10);
                bezierVertex(173, -12, 172, -14, 171, -16);
                vertex(171, -16);
                vertex(171, -16);
                bezierVertex(171, -19, 170, -21, 170, -24);
                vertex(170, -24);
                vertex(170, -48);
                vertex(179, -48);
                vertex(179, -24);
                vertex(179, -24);
                bezierVertex(179, -22, 179, -20, 180, -18);
                vertex(180, -18);
                vertex(180, -18);
                bezierVertex(181, -16, 182, -15, 183, -14);
                vertex(183, -14);
                vertex(183, -14);
                bezierVertex(184, -12, 185, -12, 186, -11);
                vertex(186, -11);
                vertex(186, -11);
                bezierVertex(187, -10, 189, -10, 190, -9);
                vertex(190, -9);
                vertex(190, -9);
                bezierVertex(191, -9, 192, -9, 193, -9);
                vertex(193, -9);
                vertex(193, -9);
                bezierVertex(194, -9, 194, -9, 194, -9);
                vertex(194, -9);
                vertex(210, -9);
                vertex(210, -48);
                vertex(219, -48);
                endShape(CLOSE);
                beginShape();
                vertex(282, -48);
                vertex(290, -48);
                vertex(282, -3);
                vertex(282, -3);
                bezierVertex(282, -2, 282, -1, 281, -1);
                vertex(281, -1);
                vertex(281, -1);
                bezierVertex(280, 0, 280, 0, 279, 1);
                vertex(279, 1);
                vertex(279, 1);
                bezierVertex(278, 1, 277, 1, 276, 0);
                vertex(276, 0);
                vertex(276, 0);
                bezierVertex(275, 0, 275, -1, 274, -1);
                vertex(274, -1);
                vertex(258, -28);
                vertex(242, -1);
                vertex(242, -1);
                bezierVertex(242, -1, 241, 0, 241, 0);
                vertex(241, 0);
                vertex(241, 0);
                bezierVertex(240, 0, 239, 1, 238, 1);
                vertex(238, 1);
                vertex(238, 1);
                bezierVertex(237, 1, 236, 0, 236, 0);
                vertex(236, 0);
                vertex(236, 0);
                bezierVertex(235, -1, 234, -2, 234, -3);
                vertex(234, -3);
                vertex(226, -48);
                vertex(235, -48);
                vertex(241, -16);
                vertex(255, -38);
                vertex(255, -38);
                bezierVertex(255, -39, 255, -40, 256, -40);
                vertex(256, -40);
                vertex(256, -40);
                bezierVertex(257, -40, 257, -40, 258, -40);
                vertex(258, -40);
                vertex(258, -40);
                bezierVertex(259, -40, 260, -40, 260, -40);
                vertex(260, -40);
                vertex(260, -40);
                bezierVertex(261, -40, 262, -39, 262, -38);
                vertex(262, -38);
                vertex(276, -16);
                vertex(282, -48);
                endShape(CLOSE);
                beginShape();
                vertex(345, -44);
                vertex(345, 0);
                vertex(336, 0);
                vertex(336, -12);
                vertex(305, -12);
                vertex(305, 0);
                vertex(296, 0);
                vertex(296, -24);
                vertex(296, -24);
                bezierVertex(296, -28, 297, -31, 298, -34);
                vertex(298, -34);
                vertex(298, -34);
                bezierVertex(299, -37, 301, -39, 303, -42);
                vertex(303, -42);
                vertex(303, -42);
                bezierVertex(305, -44, 308, -45, 311, -47);
                vertex(311, -47);
                vertex(311, -47);
                bezierVertex(314, -48, 317, -48, 321, -48);
                vertex(321, -48);
                vertex(340, -48);
                vertex(340, -48);
                bezierVertex(341, -48, 342, -48, 342, -48);
                vertex(342, -48);
                vertex(342, -48);
                bezierVertex(343, -48, 343, -47, 343, -47);
                vertex(343, -47);
                vertex(343, -47);
                bezierVertex(344, -47, 344, -46, 344, -46);
                vertex(344, -46);
                vertex(344, -46);
                bezierVertex(345, -45, 345, -45, 345, -44);
                vertex(345, -44);
                endShape(CLOSE);
                fill(bg);
                beginShape();
                vertex(305, -24);
                vertex(305, -21);
                vertex(336, -21);
                vertex(336, -40);
                vertex(321, -40);
                vertex(321, -40);
                bezierVertex(320, -40, 320, -40, 319, -39);
                vertex(319, -39);
                vertex(319, -39);
                bezierVertex(318, -39, 317, -39, 316, -39);
                vertex(316, -39);
                vertex(316, -39);
                bezierVertex(315, -39, 314, -38, 312, -37);
                vertex(312, -37);
                vertex(312, -37);
                bezierVertex(311, -37, 310, -36, 309, -35);
                vertex(309, -35);
                vertex(309, -35);
                bezierVertex(308, -34, 307, -32, 306, -30);
                vertex(306, -30);
                vertex(306, -30);
                bezierVertex(306, -29, 305, -27, 305, -24);
                vertex(305, -24);
                endShape(CLOSE);
                fill(fl);

                beginShape();
                vertex(403, -38);
                vertex(403, -32);
                vertex(403, -32);
                bezierVertex(403, -30, 403, -28, 402, -27);
                vertex(402, -27);
                vertex(402, -27);
                bezierVertex(402, -25, 401, -24, 400, -23);
                vertex(400, -23);
                vertex(400, -23);
                bezierVertex(400, -21, 399, -20, 398, -19);
                vertex(398, -19);
                vertex(398, -19);
                bezierVertex(396, -19, 395, -18, 394, -17);
                vertex(394, -17);
                vertex(394, -17);
                bezierVertex(393, -17, 392, -16, 390, -16);
                vertex(390, -16);
                vertex(390, -16);
                bezierVertex(389, -16, 388, -16, 387, -16);
                vertex(387, -16);
                vertex(405, 0);
                vertex(392, 0);
                vertex(374, -16);
                vertex(367, -16);
                vertex(367, -25);
                vertex(387, -25);
                vertex(387, -25);
                bezierVertex(388, -25, 389, -25, 390, -25);
                vertex(390, -25);
                vertex(390, -25);
                bezierVertex(391, -26, 392, -26, 392, -27);
                vertex(392, -27);
                vertex(392, -27);
                bezierVertex(393, -27, 394, -28, 394, -29);
                vertex(394, -29);
                vertex(394, -29);
                bezierVertex(394, -30, 394, -31, 394, -32);
                vertex(394, -32);
                vertex(394, -38);
                vertex(394, -38);
                bezierVertex(394, -38, 394, -38, 394, -39);
                vertex(394, -39);
                vertex(394, -39);
                bezierVertex(394, -39, 394, -39, 394, -39);
                vertex(394, -39);
                vertex(394, -39);
                bezierVertex(394, -39, 393, -39, 393, -40);
                vertex(393, -40);
                vertex(393, -40);
                bezierVertex(393, -40, 393, -40, 393, -40);
                vertex(393, -40);
                vertex(364, -40);
                vertex(364, 0);
                vertex(355, 0);
                vertex(355, -44);
                vertex(355, -44);
                bezierVertex(355, -45, 355, -45, 355, -46);
                vertex(355, -46);
                vertex(355, -46);
                bezierVertex(356, -46, 356, -47, 356, -47);
                vertex(356, -47);
                vertex(356, -47);
                bezierVertex(357, -47, 357, -48, 358, -48);
                vertex(358, -48);
                vertex(358, -48);
                bezierVertex(358, -48, 359, -48, 359, -48);
                vertex(359, -48);
                vertex(393, -48);
                vertex(393, -48);
                bezierVertex(395, -48, 396, -48, 398, -47);
                vertex(398, -47);
                vertex(398, -47);
                bezierVertex(399, -47, 400, -46, 401, -45);
                vertex(401, -45);
                vertex(401, -45);
                bezierVertex(402, -44, 402, -42, 403, -41);
                vertex(403, -41);
                vertex(403, -41);
                bezierVertex(403, -40, 403, -39, 403, -38);
                vertex(403, -38);
                endShape(CLOSE);
                beginShape();
                vertex(458, -14);
                vertex(458, -14);
                vertex(458, -14);
                bezierVertex(458, -12, 458, -11, 458, -10);
                vertex(458, -10);
                vertex(458, -10);
                bezierVertex(457, -8, 457, -7, 456, -6);
                vertex(456, -6);
                vertex(456, -6);
                bezierVertex(455, -5, 454, -4, 454, -3);
                vertex(454, -3);
                vertex(454, -3);
                bezierVertex(453, -2, 452, -2, 451, -1);
                vertex(451, -1);
                vertex(451, -1);
                bezierVertex(449, -1, 448, -1, 447, 0);
                vertex(447, 0);
                vertex(447, 0);
                bezierVertex(446, 0, 445, 0, 444, 0);
                vertex(444, 0);
                vertex(411, 0);
                vertex(411, -9);
                vertex(444, -9);
                vertex(444, -9);
                bezierVertex(446, -9, 447, -9, 448, -10);
                vertex(448, -10);
                vertex(448, -10);
                bezierVertex(449, -11, 450, -13, 450, -14);
                vertex(450, -14);
                vertex(450, -14);
                bezierVertex(450, -15, 450, -16, 449, -16);
                vertex(449, -16);
                vertex(449, -16);
                bezierVertex(449, -17, 449, -18, 448, -18);
                vertex(448, -18);
                vertex(448, -18);
                bezierVertex(448, -19, 447, -19, 447, -19);
                vertex(447, -19);
                vertex(447, -19);
                bezierVertex(446, -20, 445, -20, 444, -20);
                vertex(444, -20);
                vertex(424, -20);
                vertex(424, -20);
                bezierVertex(423, -20, 421, -20, 420, -20);
                vertex(420, -20);
                vertex(420, -20);
                bezierVertex(418, -21, 416, -22, 415, -23);
                vertex(415, -23);
                vertex(415, -23);
                bezierVertex(414, -24, 412, -26, 412, -27);
                vertex(412, -27);
                vertex(412, -27);
                bezierVertex(411, -29, 410, -31, 410, -34);
                vertex(410, -34);
                vertex(410, -34);
                bezierVertex(410, -37, 411, -39, 412, -41);
                vertex(412, -41);
                vertex(412, -41);
                bezierVertex(412, -42, 414, -44, 415, -45);
                vertex(415, -45);
                vertex(415, -45);
                bezierVertex(416, -46, 418, -47, 420, -48);
                vertex(420, -48);
                vertex(420, -48);
                bezierVertex(421, -48, 423, -48, 424, -48);
                vertex(424, -48);
                vertex(454, -48);
                vertex(454, -40);
                vertex(424, -40);
                vertex(424, -40);
                bezierVertex(423, -40, 421, -39, 420, -38);
                vertex(420, -38);
                vertex(420, -38);
                bezierVertex(419, -37, 419, -36, 419, -34);
                vertex(419, -34);
                vertex(419, -34);
                bezierVertex(419, -32, 419, -31, 420, -30);
                vertex(420, -30);
                vertex(420, -30);
                bezierVertex(421, -29, 423, -29, 424, -29);
                vertex(424, -29);
                vertex(444, -29);
                vertex(444, -29);
                vertex(444, -29);
                bezierVertex(445, -29, 446, -28, 447, -28);
                vertex(447, -28);
                vertex(447, -28);
                bezierVertex(448, -28, 450, -28, 451, -27);
                vertex(451, -27);
                vertex(451, -27);
                bezierVertex(452, -27, 453, -26, 454, -25);
                vertex(454, -25);
                vertex(454, -25);
                bezierVertex(454, -24, 455, -24, 456, -23);
                vertex(456, -23);
                vertex(456, -23);
                bezierVertex(457, -21, 457, -20, 458, -19);
                vertex(458, -19);
                vertex(458, -19);
                bezierVertex(458, -17, 458, -16, 458, -14);
                endShape(CLOSE);
                popMatrix();

                popMatrix();
            }

            function game_logo(x, y, s1, s2, r, c1, c2, c3, c4) {
                pushMatrix();
                translate(x, y);
                scale(s1, s2);
                rotate(r);
                NATUWARS_TXT(69, 12, 0.7, 0.6, 0, c1, c2);
                treeSide(32, 36, 0.06, 0.04, 0, c3, c4);
                popMatrix();
            }

            var stats = {
                x: 0,
                y: 0,
            };
            stats.display = function() {
                pushMatrix();
                pushStyle();
                translate(this.x, this.y);

                noStroke();

                fill(0, 0, 0, 50);
                rect(0, 0, width, 0);

                fill(0, 0, 0, 100);
                rect(9, 19, p.maxHealth + 2, 22, 3);

                if (p.health <= 50) {
                    fill(0xff7A2C29);
                } else {
                    fill(0xff4D8429);
                }
                rect(10, 20, p.health, 20, 3);

                textFont(createFont(fontss[1]), 11);
                fill(227, 227, 227);
                _text(p.kills, 29, 57, 1, 1, true, color(0), color(255), 0.3);
                _text((zombs.length + enemies.length), 79, 57, 1, 1, true, color(0), color(255), 0.3);
                skull(11, 47, 0.38, 0.39, 0);
                people3(60, 46, 0.38, 0.42, 0);
                textFont(createFont(fontss[0]), 13);
                _text(~~p.health + '/' + p.maxHealth, 20, 34, 1, 1, true, color(0), color(255), 0.5);
                popStyle();
                popMatrix();
            };
            stats.run = function() {
                this.display();
            };

            var Rock = function(data) {
                this.x = data.x;
                this.y = data.y;
                this.rad = data.rad;
                this.type = data.type;
                this.treeOn = 250;
                this.treeRad = this.rad * 5;
                this.resources = 25;

                this.replayTime = 0;
                this.graphicalRotation = random(0, 360);
            };
            Rock.prototype.display = function() {
                pushMatrix();
                pushStyle();
                translate(this.x, this.y);
                scale(1);

                //randomSeed(1);

                switch (this.type) {
                    case 0:

                        stroke(0, 0, 0);
                        strokeWeight(2);

                        fill(125, 94, 0);
                        ellipse(0, 0, this.rad, this.rad);

                        noStroke();
                        fill(112, 75, 19);
                        ellipse(0, 0, this.rad / 1.5, this.rad / 1.5);

                        fill(77, 53, 0);

                        fill(0, 82, 1, this.treeOn);
                        ellipse(0, 0, this.treeRad, this.treeRad / 2);
                        ellipse(0, 0, this.treeRad / 2, this.treeRad);
                        ellipse(0, -50, this.treeRad / 1.5, this.treeRad / 2);
                        ellipse(0, 50, this.treeRad / 1.5, this.treeRad / 2);
                        //rect(-this.treeRad/2, -this.treeRad/2, this.treeRad, this.treeRad, 15);
                        break;
                    case 1:
                        pushMatrix();
                        rotate(this.graphicalRotation);
                        stroke(52, 51, 52);
                        strokeWeight(5);

                        fill(71, 73, 77);
                        fill(69, 76, 84);
                        ellipse(0, 0, this.rad, this.rad);

                        noStroke();
                        fill(89, 89, 89);
                        fill(101, 108, 115);
                        ellipse(0, 0, this.rad / 1.5, this.rad / 1.5);
                        //rock

                        //rgb(109, 129, 150)
                        //rgb(68, 88, 110)
                        //rgb(52, 51, 52)
                        fill(97, 97, 97);
                        fill(58, 63, 69, 90);
                        ellipse(10, 10, 10, 10);
                        ellipse(-5, 10, 10, 10);
                        ellipse(10, -10, 10, 10);

                        ellipse(15, 10, 10, 10);
                        ellipse(-5, 10, 10, 10);
                        ellipse(10, -10, 10, 10);
                        popMatrix();
                        break;
                    case 2:

                        break;
                }

                popStyle();
                popMatrix();
            };
            Rock.prototype.collide = function(obj, t) {
                if (t === 0) {
                    for (var i = 0; i < obj.length; i++) {
                        var radAngle = atan2(obj[i].y - this.y, obj[i].x - this.x);
                        var fromTan = dist(this.x, this.y, obj[i].x, obj[i].y) - this.rad / 2 - obj[i].rad / 2;
                        if (dist(this.x, this.y, obj[i].x, obj[i].y) <= (this.rad / 2 + obj[i].rad / 2)) {
                            obj[i].x -= cos(radAngle) * fromTan;
                            obj[i].y -= sin(radAngle) * fromTan;
                            // if(obj[i].chubd!==undefined){
                            obj[i].chubd = true;
                            //}
                        }
                    }
                } else if (t === 1) {
                    if (dist(this.x, this.y, obj.x, obj.y) <= (this.rad / 2 + obj.rad / 2)) {
                        obj.x -= cos(atan2(obj.y - this.y, obj.x - this.x)) * (dist(this.x, this.y, obj.x, obj.y) - this.rad / 2 - obj.rad / 2);
                        obj.y -= sin(atan2(obj.y - this.y, obj.x - this.x)) * (dist(this.x, this.y, obj.x, obj.y) - this.rad / 2 - obj.rad / 2);
                        harvest.show = true;
                        if (this.type === 0) {
                            harvest.id = "Basic Tree\n" + this.resources + "/25\n\n'E' to Harvest";
                            if (keys[69] && this.resources >= 1) {
                                this.resources -= p.axe;
                                p.wood++;
                            }
                        }
                        if (this.type === 1) {
                            harvest.id = "Basic Rock\n" + this.resources + "/25\n\n'E' to Harvest";
                            if (keys[69] && this.resources >= 1) {
                                this.resources -= p.axe;
                                p.rock++;
                            }
                        }
                    } else {
                        //harvest.show = false;
                    }
                }
            };
            Rock.prototype.run = function() {
                if (this.resources === 0) {
                    this.replayTime += 0.01;
                    //harvest.id = "Basic "+(this.type===1?"Rock":"Tree")+"\n0/25\nReloading..\n\n🔃"+~~this.replayTime + "%";
                    if (this.replayTime >= 100) {
                        this.resources = 25;
                        this.replayTime = 0;
                    }
                }
                if (dist(p.x, p.y, this.x, this.y) <= this.treeRad / 2) {
                    this.treeOn = lerp(this.treeOn, 20, 0.25);
                } else {
                    this.treeOn = lerp(this.treeOn, 100, 0.25);
                }

                this.display();
            };

            var rectRect = function(x1, y1, w1, h1, x2, y2, w2, h2) {
                return (x1 + w1 > x2 && y1 + h1 > y2 && x1 < x2 + w2 && y1 < y2 + h2);
            };

            var Zomb = function(data) {
                this.x = data.x;
                this.y = data.y;
                this.angle = 0;
                this.type = data.type;
                this.hp = 100;

                this.rad = 0;
                this.speed = 0;

                this.Splice = false;
                this.hit = false;
            };
            Zomb.prototype.display = function() {
                pushMatrix();
                pushStyle();
                translate(this.x, this.y);
                rotate(this.angle);

                stroke(0, 0, 0);
                strokeWeight(3);

                switch (this.type) {
                    case "small":
                        this.rad = 50;
                        this.speed = 3;
                        fill(96, 128, 125);
                        ellipse(-19, -17, 20, 20);
                        ellipse(19, -17, 20, 20);
                        ellipse(0, 0, this.rad, this.rad);

                        pushStyle();
                        noStroke();
                        fill(161, 124, 124, 160);
                        ellipse(-3, 13, 28, 20);
                        popStyle();
                        break;
                    case "normal":
                        this.rad = 70;
                        this.speed = 2;
                        fill(81, 110, 64);
                        ellipse(-29, -27, 20, 20);
                        ellipse(29, -27, 20, 20);
                        ellipse(0, 0, this.rad, this.rad);
                        pushStyle();
                        noStroke();
                        fill(161, 124, 124, 120);
                        ellipse(10, 22, 23, 20);
                        popStyle();
                        break;
                    case "big":
                        this.rad = 100;
                        this.speed = 1;
                        fill(171, 176, 81);
                        ellipse(-39, -37, 20, 20);
                        ellipse(39, -37, 20, 20);
                        ellipse(0, 0, this.rad, this.rad);
                        pushStyle();
                        noStroke();
                        fill(196, 141, 141, 90);
                        ellipse(-12, 31, 40, 27);
                        popStyle();
                        break;
                }


                popStyle();
                popMatrix();

                stroke(0);
                strokeWeight(0.1);
                fill(0, 0, 0);
                rect(this.x - 50 / 2, this.y - this.rad / 1.3, 50, 5);
                fill(222, 83, 13);
                rect(this.x - 50 / 2, this.y - this.rad / 1.3, this.hp / 2, 5);
                noStroke();
            };
            Zomb.prototype.move = function() {
                this.angle = atan2(p.y - this.y, p.x - this.x) + 90;

                if (p.x > this.x) {
                    this.x += this.speed;
                }
                if (p.x < this.x) {
                    this.x -= this.speed;
                }
                if (p.y > this.y) {
                    this.y += this.speed;
                }
                if (p.y < this.y) {
                    this.y -= this.speed;
                }
            };
            Zomb.prototype.collide = function(obj) {
                for (var i = 0; i < obj.length; i++) {
                    var radAngle = atan2(obj[i].y - this.y, obj[i].x - this.x);
                    var fromTan = dist(this.x, this.y, obj[i].x, obj[i].y) - this.rad / 2 - obj[i].rad / 2;
                    if (dist(this.x, this.y, obj[i].x, obj[i].y) <= (this.rad / 2 + obj[i].rad / 2)) {
                        obj[i].x -= cos(radAngle) * fromTan;
                        obj[i].y -= sin(radAngle) * fromTan;
                    }
                }
            };
            Zomb.prototype.fightM = function() {
                if (this.hp <= 0) {
                    this.Splice = true;
                }
            };
            Zomb.prototype.run = function() {
                this.display();
                this.move();
                this.fightM();
            };

            var Blt = function(data) {
                this.x = data.x;
                this.y = data.y;
                this.angle = data.angle;
                this.dead = false;
                this.speed = data.speed;
                this.range = data.range;
                this.Splice = false;
                this.who = data.who;
                this.dt = 0;
                this.range = data.range;
                // this.xd= (p.x+cos(p.angle - 90)*77);this.yd=(p.y+sin(p.angle - 90)*77);
                this.fade = 0;
                this.type = 1;

                this.enemyGunLevel = data.enemyGunLevel;
                this.enemyType = data.enemyType;
                this.src = data.src;
            };
            Blt.prototype.display = function() {
                pushMatrix();
                pushStyle();
                translate(this.x, this.y);
                //translate(this.xd,this.yd);
                rotate(this.angle + 90);
                scale(0.9);
                rectMode(CENTER);
                if (this.type === 0) {
                    noStroke();
                    /*fill(255, 255, 255, 100);
                    ellipse(0, 0, 5, 40);
                    ellipse(0, -5, 5, 40);
                    ellipse(0, +5, 5, 40);
                    ellipse(0, +10, 5, 40);
                    fill(234, 255, 0, 150);
                    ellipse(0, 0, 5, 5);*/
                    noStroke();
                    fill(255, 255, 255, this.fade);
                    ellipse(0, 55, 5, this.range * 3);
                    scale(0.7, 0.94);
                    noStroke();
                    fill(255, 55);
                    ellipse(4, 37, 4, 0);

                    stroke(0);
                    strokeWeight(1);
                    fill(233, 207, 145);
                    rect(0, 0, 8, 18, 3, 3, -1, -1);

                    noStroke();
                    fill(0);
                    rect(0, 13, 8, 2);
                } else if (this.type === 1) {
                    noStroke();
                    fill(255, 255, 255, this.fade);
                    ellipse(0, 55, 5, this.range * 3);
                    scale(0.7, 0.94);
                    noStroke();
                    fill(255, 55);
                    ellipse(4, 37, 4, 0);

                    stroke(0);
                    strokeWeight(1);
                    fill(233, 207, 145);
                    rect(0, 0, 8, 18, 3, 3, -1, -1);

                    noStroke();
                    fill(0);
                    rect(0, 13, 8, 2);
                }


                rectMode(CORNER);
                popStyle();
                popMatrix();
            };
            Blt.prototype.update = function() {

                this.x += this.speed * sin(this.angle + 90);
                this.y -= this.speed * cos(this.angle + 90);


                if (this.x < 0 || this.x >= gd.gW || this.y < 0 || this.y >= gd.gH) {
                    this.Splice = true;
                }

                this.dt += 1;
                if (this.dt > this.range / 15) {
                    this.fade = lerp(this.fade, 60, 0.55);
                } else if (this.dt > 15) {
                    // this.fade = lerp(this.fade,0,0.25);
                }
                if (this.dt > this.range) {
                    this.Splice = true;
                }
            };

            Blt.prototype.collision = function(thing) {
                if (dist(this.x, this.y, thing.x, thing.y) <= thing.rad / 2) {

                    return true;
                } else {
                    return false;
                }
            };
            Blt.prototype.run = function() {};
            var bullets = [];

            var AI = function(data) {
                this.x = data.x;
                this.y = data.y;
                this.dir = 0;
                this.angle = 0;
                this.type = data.type;
                this.typee = 0;
                this.hp = 100;
                this.rnum = 0;
                this.reload = false;

                this.rad = 50;
                this.speed = 1;

                this.Splice = false;
                this.hit = false;
                this.skin = color(232, 212, 130);
                this.attackDist = 450;
                this.rx = random(data.x - 350, data.x + 350);
                this.ry = random(data.y - 350, data.y + 350);
                this.nv = 0;
                this.chubd = false;
                this.recoil = 0;
                this.rangee = 0;
                this.gunlvl = 0; //constant currently
                this.id = data.id;
                this.killedBy = '';
                this.kills = 0;
                this.dead = false;
                this.killProcessed = false;
                this.realName = names[data.id];
            };
            AI.prototype.display = function() {
                pushMatrix();
                pushStyle();
                translate(this.x, this.y);
                rotate(this.angle);
                //this.dead=true;
                if (this.dead === false) {

                    stroke(0, 0, 0);
                    strokeWeight(3);
                    fill(this.skin);
                    ellipse(7, -25, 17, 17);
                    ellipse(-6, -35, 17, 17);
                    if (this.type === "rifle") {
                        arrifle({
                            x: 4,
                            y: this.recoil,
                        });
                    } else if (this.type === "smg") {
                        smg({
                            x: 2,
                            y: 5 + this.recoil,
                        });
                    } else if (this.type === "pistol") {
                        pistol({
                            x: 0,
                            y: this.recoil
                        });
                    } else if (this.type === "sniper") {
                        musket({
                            x: 4,
                            y: this.recoil
                        });
                    }

                    fill(this.skin);
                    ellipse(0, 0, this.rad, this.rad);

                    // barret
                    noStroke();
                    fill(24, 66, 4);
                    ellipse(0, 10, 30, 35);

                    fill(41, 105, 6);
                    ellipse(0, 5, 10, 35);
                } else {
                    this.angle = 0;
                    fill(this.skin, 50);
                    ellipse(0, 0, this.rad, this.rad);
                    skull(-36, -35, 2, 2, 0);

                }
                popStyle();
                popMatrix();
                pushStyle();
                if (this.dead === false) {
                    stroke(0);
                    strokeWeight(0.1);
                    fill(0);
                    rect(this.x - 50 / 2, this.y - this.rad / 1.3, 100 / 2, 5);
                    fill(166, 56, 36);
                    rect(this.x - 50 / 2, this.y - this.rad / 1.3, this.hp / 2, 5);
                }

                textSize(30);
                fill(255, 255, 255);
                textAlign(CENTER, CENTER);
                textSize(20);
                _text(this.realName, this.x, this.y - 50, 1.2, 1, true, color(33, 33, 33), color(255, 255, 255), 1);
                popStyle();
                noStroke();
            };
            AI.prototype.findNearestAI = function(ais) {
                var nearestAI = null;
                var nearestDistance = 500;

                for (var i = 0; i < ais.length; i++) {
                    if (ais[i] !== this) {
                        var distance = dist(this.x, this.y, ais[i].x, ais[i].y);

                        if (distance < nearestDistance) {
                            nearestAI = ais[i];
                            nearestDistance = distance;
                        }
                    }
                }

                return nearestAI;
            };

            AI.prototype.move = function(ais) {
                // can remove this, testing...
                // Yeah this might work if I remove earlier version
                //if(gamemodes[gamemode].totalBots===undefined){
                if (gamemodes[gamemode].totalBots !== undefined) {
                    // real code
                    if (this.id === undefined) {
                        this.id = 'default';
                    }
                    if (this.killedBy === '') {
                        this.killedBy = 'NONE';
                    }
                    if (this.hp <= 0 && this.dead === false) {

                        this.hp = 0;
                        this.dead = true;

                    }
                    if (this.hp <= 0) {
                        this.hp = 0;
                    }
                    if (this.dead === false) {
                        if (this.x < 0) {
                            this.x = 0;
                        }
                        if (this.y < 0) {
                            this.y = 0;
                        }
                        if (this.x > gd.gW) {
                            this.x = gd.gW;
                        }
                        if (this.y > gd.gH) {
                            this.y = gd.gH;
                        }
                        if (this.type === 'pistol') {
                            this.typee = 0;
                            this.rangee = guns.range[0][0];
                        }
                        if (this.type === 'sniper') {
                            this.typee = 1;
                            this.rangee = guns.range[0][1];
                        }
                        if (this.type === 'rifle') {
                            this.typee = 2;
                            this.rangee = guns.range[0][2];
                        }
                        if (this.type === 'smg') {
                            this.typee = 3;
                            this.rangee = guns.range[0][3];
                        }
                        var target = null;
                        if (this.id !== 'default') {
                            target = this.findNearestAI(ais);
                            if (dist(this.x, this.y, p.x, p.y) <= this.attackDist / 3 && !target) {
                                if (this.reload === true && this.id !== 'default') {
                                    bullets.push(new Blt({
                                        x: this.x,
                                        y: this.y,
                                        angle: this.angle - 90,
                                        speed: 35,
                                        who: "hostile",
                                        enemyGunLevel: this.gunlvl,
                                        enemyType: this.typee,
                                        range: this.rangee,
                                        src: this.id,
                                    }));
                                    //println(this.rangee);
                                    this.reload = false;
                                }
                                this.angle = atan2(p.y - this.y, p.x - this.x) + 90;
                            } else {
                                if (target && target.dead === false) {
                                    if (this.reload === true && this.id !== 'default') {
                                        bullets.push(new Blt({
                                            x: this.x,
                                            y: this.y,
                                            angle: this.angle - 90,
                                            speed: 35,
                                            who: "hostile",
                                            enemyGunLevel: this.gunlvl,
                                            enemyType: this.typee,
                                            range: this.rangee,
                                            src: this.id,
                                        }));
                                        //println(this.rangee);
                                        this.reload = false;
                                    }
                                    this.angle = atan2(target.y - this.y, target.x - this.x) + 90;

                                    /*if ((dist(this.x, this.y, target.x, target.y) <= this.attackDist) ) {
            if (target.x > this.x) {
                this.x += this.speed;
            }
            if (target.x < this.x) {
                this.x -= this.speed;
            }
            if (target.y > this.y) {
                this.y += this.speed;
            }
            if (target.y < this.y) {
                this.y -= this.speed;
            }
        }*/

                                }
                            }
                            this.dir = atan2(this.ry - this.y, this.rx - this.x) + 90;
                            this.angle = lerp(this.angle, this.dir, 0.05);

                            if (this.rx > this.x) {
                                this.x += this.speed;
                            }
                            if (this.rx < this.x) {
                                this.x -= this.speed;
                            }
                            if (this.ry > this.y) {
                                this.y += this.speed;
                            }
                            if (this.ry < this.y) {
                                this.y -= this.speed;
                            }
                            var in1 = false;
                            if (Math.abs(this.rx - this.x) < 5) {
                                in1 = true;
                                this.chubd = false;
                            }
                            if (Math.abs(this.ry - this.y) < 5) {
                                in1 = true;
                                this.chubd = false;
                            }
                            if (this.chubd === true) {
                                in1 = true;
                            }
                            if (testing === true) {
                                fill(255, 0, 0);
                                ellipse(this.rx, this.ry, 20, 20);
                                stroke(0, 0, 0);
                                strokeWeight(5);
                                line(this.x, this.y, this.rx, this.ry);
                                noStroke();
                                textSize(30);
                                text(this.chubd + ' | ' + in1, this.x, this.y);
                            }
                            if (in1 === true) {
                                in1 = false;
                                // this.rx = random(this.x - 350, this.x + 350);
                                //this.ry = random(this.x - 350, this.x + 350);
                                var magicalNumberExquisite = random(40, 50);
                                var magicalNumberExquisite2 = random(400, 500);
                                if (this.chubd) {
                                    this.rx = Math.max(0, Math.min(gd.gW, random(this.x - magicalNumberExquisite, this.x + magicalNumberExquisite)));
                                    this.ry = Math.max(0, Math.min(gd.gH, random(this.y - magicalNumberExquisite, this.y + magicalNumberExquisite)));
                                } else {
                                    this.rx = Math.max(0, Math.min(gd.gW, random(this.x - magicalNumberExquisite2, this.x + magicalNumberExquisite2)));
                                    this.ry = Math.max(0, Math.min(gd.gH, random(this.y - magicalNumberExquisite2, this.y + magicalNumberExquisite2)));

                                }
                                // make it smooth man
                                //this.angle = lerp(this.angle,atan2(this.ry - this.y,this.rx - this.x) + 90, 0.5);
                                /*var maxDistance = 500;
                                var minDistance = 20;
                                this.rx = Math.max(0, Math.min(gd.gW, this.x + (Math.random() > 0.5 ? 1 : -1) * Math.random() * (maxDistance - minDistance) + minDistance));
                                    this.ry = Math.max(0, Math.min(gd.gH, this.y + (Math.random() > 0.5 ? 1 : -1) * Math.random() * (maxDistance - minDistance) + minDistance));*/
                            }
                        } else {

                        }

                        if (((dist(this.x, this.y, p.x, p.y) <= this.attackDist) || this.hp !== 100)) {
                            if (this.reload === true) {
                                bullets.push(new Blt({
                                    x: this.x,
                                    y: this.y,
                                    angle: this.angle - 90,
                                    speed: 35,
                                    who: "hostile",
                                    enemyGunLevel: this.gunlvl,
                                    enemyType: this.typee,
                                    range: this.rangee,
                                }));
                                //println(this.rangee);
                                this.reload = false;
                            }
                            this.angle = atan2(p.y - this.y, p.x - this.x) + 90;
                            if (this.hp >= 99) {
                                if (p.x > this.x) {
                                    this.x += this.speed;
                                }
                                if (p.x < this.x) {
                                    this.x -= this.speed;
                                }
                                if (p.y > this.y) {
                                    this.y += this.speed;
                                }
                                if (p.y < this.y) {
                                    this.y -= this.speed;
                                }
                            } else {
                                this.dir = atan2(this.ry - this.y, this.rx - this.x) + 90;
                                this.angle = lerp(this.angle, this.dir, 0.05);

                                if (this.rx > this.x) {
                                    this.x += this.speed;
                                }
                                if (this.rx < this.x) {
                                    this.x -= this.speed;
                                }
                                if (this.ry > this.y) {
                                    this.y += this.speed;
                                }
                                if (this.ry < this.y) {
                                    this.y -= this.speed;
                                }
                                var in1 = false;
                                if (Math.abs(this.rx - this.x) < 5) {
                                    in1 = true;
                                    this.chubd = false;
                                }
                                if (Math.abs(this.ry - this.y) < 5) {
                                    in1 = true;
                                    this.chubd = false;
                                }
                                if (this.chubd === true) {
                                    in1 = true;
                                }
                                if (testing === true) {
                                    fill(255, 0, 0);
                                    ellipse(this.rx, this.ry, 20, 20);
                                    stroke(0, 0, 0);
                                    strokeWeight(5);
                                    line(this.x, this.y, this.rx, this.ry);
                                    noStroke();
                                    textSize(30);
                                    text(this.chubd + ' | ' + in1, this.x, this.y);

                                }
                                if (in1 === true) {
                                    in1 = false;
                                    // this.rx = random(this.x - 350, this.x + 350);
                                    //this.ry = random(this.x - 350, this.x + 350);
                                    var magicalNumberExquisite = random(40, 50);
                                    var magicalNumberExquisite2 = random(400, 500);
                                    if (this.chubd) {
                                        this.rx = Math.max(0, Math.min(gd.gW, random(this.x - magicalNumberExquisite, this.x + magicalNumberExquisite)));
                                        this.ry = Math.max(0, Math.min(gd.gH, random(this.y - magicalNumberExquisite, this.y + magicalNumberExquisite)));
                                    } else {
                                        this.rx = Math.max(0, Math.min(gd.gW, random(this.x - magicalNumberExquisite2, this.x + magicalNumberExquisite2)));
                                        this.ry = Math.max(0, Math.min(gd.gH, random(this.y - magicalNumberExquisite2, this.y + magicalNumberExquisite2)));

                                    }
                                    // make it smooth man
                                    //this.angle = lerp(this.angle,atan2(this.ry - this.y,this.rx - this.x) + 90, 0.5);
                                    /*var maxDistance = 500;
                                    var minDistance = 20;
                                    this.rx = Math.max(0, Math.min(gd.gW, this.x + (Math.random() > 0.5 ? 1 : -1) * Math.random() * (maxDistance - minDistance) + minDistance));
                                        this.ry = Math.max(0, Math.min(gd.gH, this.y + (Math.random() > 0.5 ? 1 : -1) * Math.random() * (maxDistance - minDistance) + minDistance));*/
                                }
                            }
                        } else {
                            if (frameCount % 150 === 0) {
                                this.dir += random(-360, 360);
                            }

                            this.angle = lerp(this.angle, this.dir, 0.05);
                            this.x += sin(this.angle) * this.speed;
                            this.y -= cos(this.angle) * this.speed;
                            this.x = constrain(this.x, 0, gd.gW);
                        }


                    } else {

                    }
                } else {
                    // from earlier version
                    if ((dist(this.x, this.y, p.x, p.y) <= this.attackDist) || this.hp !== 100) {
                        this.angle = atan2(p.y - this.y, p.x - this.x) + 90;

                        if (this.reload === true) {
                            bullets.push(new Blt({
                                x: this.x,
                                y: this.y,
                                angle: this.angle - 90,
                                speed: 35,
                                who: "hostile",
                                src: this.id,
                                enemyType: 0,
                                enemyGunLevel: 0,
                            }));
                            this.reload = false;
                        }

                        if (p.x > this.x) {
                            this.x += this.speed;
                        }
                        if (p.x < this.x) {
                            this.x -= this.speed;
                        }
                        if (p.y > this.y) {
                            this.y += this.speed;
                        }
                        if (p.y < this.y) {
                            this.y -= this.speed;
                        }
                    } else {
                        if (frameCount % 150 === 0) {
                            this.dir += random(-360, 360);
                        }

                        if (this.x < 0) {
                            this.x = 0;
                        }
                        if (this.y < 0) {
                            this.y = 0;
                        }
                        if (this.x > gd.gW) {
                            this.x = gd.gW;
                        }
                        if (this.y > gd.gH) {
                            this.y = gd.gH;
                        }

                        this.angle = lerp(this.angle, this.dir, 0.05);
                        this.x += sin(this.angle) * this.speed;
                        this.y -= cos(this.angle) * this.speed;
                        this.x = constrain(this.x, 0, gd.gW);
                    }
                }
            };
            AI.prototype.collide = function(obj) {
                if (this.dead === false) {
                    for (var i = 0; i < obj.length; i++) {

                        var radAngle = atan2(obj[i].y - this.y, obj[i].x - this.x);
                        var fromTan = dist(this.x, this.y, obj[i].x, obj[i].y) - this.rad / 2 - obj[i].rad / 2;
                        if (dist(this.x, this.y, obj[i].x, obj[i].y) <= (this.rad / 2 + obj[i].rad / 2)) {
                            obj[i].x -= cos(radAngle) * fromTan;
                            obj[i].y -= sin(radAngle) * fromTan;
                        }
                    }
                }
            };
            AI.prototype.fightM = function() {
                if (this.type === 'pistol') {
                    this.typee = 0;
                }
                if (this.type === 'sniper') {
                    this.typee = 1;
                }
                if (this.type === 'rifle') {
                    this.typee = 2;

                }
                if (this.type === 'smg') {
                    this.typee = 3;
                }
                if (this.hp <= 0) {
                    this.Splice = true;
                }
                this.rnum++;
                if (this.rnum >= guns.reload[this.gunlvl][this.typee]) {
                    this.reload = true;
                    this.rnum = 0;
                }
            };
            AI.prototype.run = function(ais) {
                this.display();
                if (ais) {
                    this.move(ais);
                } else {
                    this.move();
                }
                this.fightM();

            };
            var batch1Spawned = false; // for mysterymode and where I only need certain amount of enemies spawned

            var Water = function(x, y, w, h) {
                this.x = x;
                this.y = y;
                this.w = w;
                this.h = h;
            };
            Water.prototype.display = function() {
                pushMatrix();
                pushStyle();
                //fill(0, 17, 255, 150);
                fill(1, 106, 176);
                rect(this.x, this.y, this.w, this.h);

                // this causes severe lag
                /*for (var i = 0; i < this.w; i += 40) {
			      for (var j = 0; j < this.h; j += 40) {
			          //stroke(0, 0, 0, 40);
			          //stroke(98, 132, 61);
			          stroke(1, 113, 188);
			          strokeWeight(2.6);
			          //fill(70, 122, 7);
			          fill(1, 106, 176);
			          //fill(87, 87, 87);
			          rect(this.x + i, this.y + j, 40, 40);
			
			          //tree
			          //rgb(12, 85, 63)
			      }
			  }*/
                popStyle();
                popMatrix();
            };
            Water.prototype.collide = function(obj) {
                if (rectRect(this.x, this.y, this.w, this.h, p.x, p.y, p.rad, p.rad)) {
                    p.speed = 0.3;
                    if (p.water < 100) {
                        p.water += 0.1;
                    }
                    //p.y += 1;
                } else {
                    if (p.trait === 'scout') {
                        p.speed = 0.6 + (0.06 * p.traitlevel);
                    } else {
                        p.speed = p.normalSpeed;
                    }
                }
            };
            Water.prototype.run = function() {
                this.display();
                this.collide();
            };
            var pond = new Water(600, 0, 520, gd.gH);

            var Item = function(data) {

            };

            var Airdrop = function(data) {
                this.x = data.x;
                this.y = data.y;
                //this.x = 200;
                //this.y = 200;
                this.rad = 125;
                this.openTimer = 0;
                this.open = false;
                this.spliced = false;
                this.timer = 0;
            };
            Airdrop.prototype.display = function() {
                pushMatrix();
                pushStyle();
                translate(this.x, this.y);
                rectMode(CENTER);

                if (this.open === false) {
                    stroke(33, 33, 33);
                    strokeWeight(5);
                    fill(107, 86, 148);
                    rect(0, 0, this.rad - 35, this.rad + 18, 3);
                    fill(255);
                    rect(0, 0, this.rad, this.rad, 15);

                    rect(0, 0, this.rad - 41, 55);

                    //noStroke();
                    fill(35, 150, 232, 90);
                    rect(this.rad / 2.4, 0, 20, this.rad, 0, 15, 15, 0);
                    rect(-this.rad / 2.4, 0, 20, this.rad, 15, 0, 0, 15);
                    stroke(38);
                    strokeWeight(3);
                    fill(245, 205, 134);
                    rect(0, this.rad / 2.5 + 20, 40, 10, 5);
                    rect(0, -this.rad / 2.5 - 20, 40, 10, 5);
                    rect(-this.rad / 2.5 - 10, -40, 15, 20, 5);
                    rect(this.rad / 2.5 + 10, -40, 15, 20, 5);
                    rect(-this.rad / 2.5 - 10, 40, 15, 20, 5);
                    rect(this.rad / 2.5 + 10, 40, 15, 20, 5);

                    fill(153, 138, 0);
                    textFont(createFont(fontss[1]), 9.5);
                    textAlign(CENTER, CENTER);
                    _text("LeaferStudios", 0, 45, 1.2, 1, true, color(33, 33, 33, 0), color(163, 109, 16), 0.8);
                    _text("LeaferStudios", 0, -45, -1.2, -1, true, color(33, 33, 33, 0), color(163, 109, 16), 0.8);
                    textFont(createFont(fontss[1]), 40);
                    _text("III", 0, 0, 1, 1, true, color(163, 109, 16), color(255, 255, 255), 1.4);
                } else {
                    fill(5, 5, 5, 105);
                    rect(0, 0, this.rad, this.rad, 15);

                    p.food = 100;
                    p.water = 100;

                    this.timer++;
                    if (this.timer >= 50) {
                        this.spliced = true;
                    }
                }

                if (this.openTimer !== 0) {
                    pushMatrix();
                    rectMode(CORNER);
                    fill(46, 46, 46);
                    rect(-100 / 2, this.rad - 25, 100, 10);
                    fill(255, 255, 255);
                    rect(-100 / 2, this.rad - 25, this.openTimer, 10);
                    popMatrix();
                }
                popStyle();
                popMatrix();
            };
            Airdrop.prototype.update = function() {
                if (this.open === false && dist(this.x, this.y, p.x, p.y) <= this.rad + 25) {
                    pushStyle();
                    fill(255, 255, 255);
                    textFont(createFont(fontss[0]), 20);
                    textAlign(CENTER, CENTER);
                    text("Hold 'E' to open", this.x, this.y - 100);
                    popStyle();



                    if (this.openTimer >= 100) {
                        this.openTimer = 100;
                        this.open = true;
                    } else {
                        if (keys[69] && this.openTimer < 100) {
                            this.openTimer += 0.2;
                        } else {
                            this.openTimer = 0;
                        }
                    }
                }
            };
            Airdrop.prototype.collide = function(obj, t) {
                if (t === 0 && this.open === false) {
                    for (var i = 0; i < obj.length; i++) {
                        var radAngle = atan2(obj[i].y - this.y, obj[i].x - this.x);
                        var fromTan = dist(this.x, this.y, obj[i].x, obj[i].y) - this.rad / 2 - obj[i].rad / 2;
                        if (dist(this.x, this.y, obj[i].x, obj[i].y) <= (this.rad / 2 + obj[i].rad / 2)) {
                            obj[i].x -= cos(radAngle) * fromTan;
                            obj[i].y -= sin(radAngle) * fromTan;
                        }
                    }
                } else if (t === 1 && this.open === false) {

                    if (dist(this.x, this.y, obj.x, obj.y) <= (this.rad / 2 + obj.rad / 2)) {
                        obj.x -= cos(atan2(obj.y - this.y, obj.x - this.x)) * (dist(this.x, this.y, obj.x, obj.y) - this.rad / 2 - obj.rad / 2);
                        obj.y -= sin(atan2(obj.y - this.y, obj.x - this.x)) * (dist(this.x, this.y, obj.x, obj.y) - this.rad / 2 - obj.rad / 2);
                        //harvest.show = true;
                    } else {
                        //harvest.show = false;
                    }
                }
            };
            Airdrop.prototype.run = function() {
                this.display();
                this.update();
            };
            //var airdrops = [new Airdrop({x:300, y:300})];
            var airdrops = [];
            var zombieTypes = ["small", "normal", "big"];

            var enemyTypes = ["sniper", "pistol", "rifle", "smg"];

            /*for (var i = 0; i < 10; i++) {
               // if (true) {
                    rocks.push(new Rock({
                        x: random(0, gd.gW),
                        y: random(0, gd.gH),
                        rad: 100,
                    }));
               // }
            }*/


            /*for (var z = 0; z < 40; z++) {
                rocks.push(new Rock({
                    x: random(500, gd.gW),
                    y: random(500, gd.gH / 2),
                    rad: random(50, 80),
                    type: 0,
                }));
                rocks.push(new Rock({
                    x: random(0, gd.gW),
                    y: random(gd.gH, gd.gH / 2),
                    rad: random(75, 100),
                    type: 1,
                }));
            }
            for (var z in rocks) {
                for (var i = 0; i < rocks.length; i++) {
                    if (rocks[i] !== rocks[z] && dist(rocks[z].x, rocks[z].y, rocks[i].x, rocks[i].y) <= rocks[z].rad) {
                        rocks.splice(z, 1);
                        rocks.splice(i, 1);
                    }
                }
            }*/

            var homes = [{
                x: 200,
                y: 200,
            }];

            // testlab
            /*enemies.push(new AI({
                x: 500,
                y: 500,
                //type: zombieTypes[Math.floor(Math.random() * zombieTypes.length)],
                type: enemyTypes[Math.floor(Math.random() * enemyTypes.length)],
            }));*/
            var Button = function(x, y, w, h, t, n, r, a, z) {
                this.x = x;
                this.y = y;
                this.w = w;
                this.h = h;
                this.t = t;
                this.n = n;
                this.r = r;
                this.a = a;
                this.z = z;
                this.o = 100;
                this.hasClicked = false;
            };
            Button.prototype.run = function() {
                pushStyle();
                pushMatrix();
                translate(this.x, this.y);

                rectMode(CENTER);
                textAlign(CENTER, CENTER);

                if (mouseX > this.x - this.w / 2 && mouseX < this.x + this.w / 2 && mouseY > this.y - this.h / 2 && mouseY < this.y + this.h / 2) {
                    cursorOn = false;
                    cursor(HAND);
                    if (click) {
                        if (scene !== 1 && gamemode !== 6 && this.t !== 'Shop' && this.t !== 'Back') {
                            ga.msg_t = 0;
                        }
                        this.hasClicked = true;
                        scene = this.n;
                        intransition = true;
                        to = scene;
                        if (this.r === true) {
                            p.rst();
                            p.x = random(0, gd.gW);
                            p.y = random(0, gd.gH);
                            zombs = [];
                            enemies = [];
                        }
                    }

                    this.o = lerp(this.o, 255, 0.25);
                    if (this.a) {
                        switch (this.a) {
                            case "action":
                                fill(7, 73, 143, this.o);
                                fill(13, 93, 179, this.o);
                                break;
                        }

                    } else {
                        //fill(6, 87, 40, this.o);
                        fill(13, 110, 55, this.o);
                    }
                } else {
                    cursorOn = true;
                    this.o = lerp(this.o, 150, 0.25);
                    if (this.a) {
                        switch (this.a) {
                            case "action":
                                fill(13, 93, 179, this.o);
                                break;
                        }
                    } else {
                        fill(13, 110, 55, this.o);
                    }
                }
                if (this.z === 0) {
                    rect(0, 0, this.w, this.h, 10);
                } else {
                    rect(0, 0, this.w, this.h, 0);
                }
                if (this.a) {
                    switch (this.a) {
                        case "action":
                            textFont(createFont(fontss[1]), 20);
                            fill(255);
                            _text(this.t, 0, 0, 1, 1, !true, color(0, 0, 0), color(255, 255, 255), 0.5);
                            break;
                    }
                } else {
                    textFont(createFont(fontss[1]), 20);
                    fill(255);
                    _text(this.t, 0, 0, 1, 1, !true, color(0, 0, 0), color(255, 255, 255), 0.5);
                }

                if (this.t === "How?" && this.hasClicked === false) {
                    fill(17, 180, 217);
                    ellipse(30, -7, 7, 7);
                }
                popMatrix();
                popStyle();
            };
            var btns = [
                new Button(w - 65, h - 35, 120, 50, "Play", 1, false, "action"),
                new Button(151, 15, 100, 30, 'Player', 7, false),
                new Button(252, 15, 100, 30, "How?", 2, false),
                new Button(50, 15, 100, 30, "Home", 0, false),
                new Button(w / 2, h - 35, 300, 45, "Home", 0, true), // laste one means reset player
                new Button(w - 65, h - 82, 120, 40, "Modes", 6, false, "action"),
                new Button(w - 70 / 2, h - 50 / 2, 60, 40, "Shop", 5, false, 'action', 0),
                new Button(w - 100 / 2, h - 50 / 2, 100, 30, "Back", 1, false, "action"),
                new Button(353, 15, 100, 30, "Lead", 3, false),
            ];
            var uiButton = function(x, y, w, h, t, n, r, a, z, txtSize, op) {
                var o = 100;

                pushMatrix();
                pushStyle();
                translate(x, y);

                rectMode(CENTER);
                textAlign(CENTER, CENTER);


                if (mouseX > x - w / 2 && mouseX < x + w / 2 && mouseY > y - h / 2 && mouseY < y + h / 2) {
                    cursorOn = false;
                    cursor(HAND);
                    if (click) {
                        if (scene !== 1 && gamemode !== 6) {
                            ga.msg_t = 0;
                        }
                        n();
                        intransition = true;
                        to = scene;
                        // careful with this one!
                        if (r === true) {
                            p.rst();
                            p.x = random(0, gd.gW);
                            p.y = random(0, gd.gH);
                            zombs = [];
                            enemies = [];
                        }
                    }

                    o = lerp(o, 255, 0.25);
                    if (a) {
                        switch (a) {
                            case "action":
                                fill(7, 73, 143, o);
                                fill(13, 93, 179, o);
                                break;
                            case "mode":
                                fill(66, 66, 66);
                                break;
                            case "support":
                                fill(145, 19, 19);
                                break;
                        }

                    } else {
                        //fill(6, 87, 40, o);
                        fill(13, 110, 55, o);
                    }
                } else {
                    cursorOn = true;
                    o = lerp(o, 150, 0.25);
                    if (a) {
                        switch (a) {
                            case "action":
                                fill(13, 93, 179, o);
                                break;
                            case "mode":
                                fill(61, 61, 61);
                                break;
                            case "support":
                                fill(173, 0, 0);
                                break;
                        }
                    } else {
                        fill(13, 110, 55, o);
                    }
                }
                if (z === 0) {
                    rect(0, 0, w, h, 10);
                } else {
                    rect(0, 0, w, h, 0);
                }
                if (a) {
                    switch (a) {
                        case "action":
                            textFont(createFont(fontss[0]), txtSize ? txtSize : 20);
                            fill(255);
                            _text(t, 0, 0, 1, 1, !true, color(0, 0, 0), color(255, 255, 255), 0.5);
                            break;
                        case "mode":
                            textFont(createFont(fontss[1]), txtSize ? txtSize : 20);
                            fill(255);
                            _text(t, 0, -h / 2 + 15, 1, 1, !true, color(0, 0, 0, 255), color(255, 255, 255), 1.0);
                            textSize(10);
                            pushStyle();
                            textAlign(LEFT, LEFT);
                            _text(op, -w / 2 + 5, 0, 1, 1, !true, color(0, 0, 0, 255), color(255, 255, 255), 1.0, w - 5, h - 20);
                            popStyle();
                            break;
                        case "support":
                            textFont(createFont(fontss[0]), txtSize ? txtSize : 20);
                            fill(255);
                            _text(t, 0, 0, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 0.65);
                            break;
                    }
                } else {
                    textFont(createFont(fontss[0]), txtSize ? txtSize : 20);
                    fill(255);
                    _text(t, 0, 0, 1, 1, !true, color(0, 0, 0), color(255, 255, 255), 0.5);
                }
                popStyle();
                popMatrix();
                if (t === "Tutorial" && gamemodes[6].timesPlayed === 0) {
                    fill(17, 180, 217);
                    ellipse(x + w / 2 - 10, y - h / 2 + 10, 7, 7);
                }
            };
            var qwe = 0;
            var qwesize = 0;
            var qweclr = color(255, 247, 0, 250);

            var groups = {
                a: [0, 0, 0, ''],
                b: [0, 0, 1, '<'],
                c: [0, 0, 0, '='],
            };

            //p.x = 0;
            //p.y = gd.gH - 10;

            var w11 = 0; //just for the particle player... have not tested if it affects lag with or without it
            //gamemodes[gamemode]
            var gamemodeRewards = [

            ];

            function drawgamelead() {
                if (gamemode === 3 || gamemode === 4 || gamemode === 5) {
                    var gamelead = [];

                    // Add player to the gamelead
                    gamelead.push({
                        name: pl.name,
                        kills: p.kills,
                    });

                    // Add each AI to the gamelead
                    for (var i = 0; i < enemies.length; i++) {
                        gamelead.push({
                            name: names[enemies[i].id],
                            kills: enemies[i].kills,
                            killed: enemies[i].dead,
                        });
                    }

                    gamelead.sort(function(a, b) {
                        return b.kills - a.kills;
                    });
                    pushMatrix();
                    pushStyle();
                    translate(0, groups.c[0]);
                    fill(0, 0, 0, 200);
                    rect(width / 4, 50, width - 300, height - 100);
                    // Display the gamelead
                    textSize(20);
                    textAlign(LEFT, LEFT);
                    if (gamemode === 4) {
                        textSize(8);
                    } else {
                        textSize(12);
                    }
                    fill(0, 0, 0);
                    var killedCount = 0;
                    for (var j = 0; j < gamelead.length; j++) {
                        var entry = gamelead[j];

                        if (entry.killed === true) {
                            killedCount++;
                            if (entry.name === pl.name) {
                                if (gamemode === 4) {
                                    _text('#' + (j + 1) + ' - ' + entry.name + ": Kills - " + entry.kills + " - Dead", width / 4 + 10, 60 + j * 9, 1, 1, true, color(0), color(255, 255, 66), 1);
                                } else {
                                    _text('#' + (j + 1) + ' - ' + entry.name + ": Kills - " + entry.kills + " - Dead", width / 4 + 10, 90 + j * 17, 1, 1, true, color(0), color(255, 255, 66), 1);
                                }
                            } else {
                                if (gamemode === 4) {
                                    _text('#' + (j + 1) + ' - ' + entry.name + ": Kills - " + entry.kills + " - Dead", width / 4 + 10, 60 + j * 9, 1, 1, true, color(0), color(250, 160, 160), 1);
                                } else {
                                    _text('#' + (j + 1) + ' - ' + entry.name + ": Kills - " + entry.kills + " - Dead", width / 4 + 10, 90 + j * 17, 1, 1, true, color(0), color(250, 160, 160), 1);
                                }
                            }
                        } else {
                            if (entry.name === pl.name) {
                                if (gamemode === 4) {
                                    _text('#' + (j + 1) + ' - ' + entry.name + ": Kills - " + entry.kills, width / 4 + 10, 60 + j * 9, 1, 1, true, color(0), color(255, 255, 66), 1);
                                } else {
                                    _text('#' + (j + 1) + ' - ' + entry.name + ": Kills - " + entry.kills, width / 4 + 10, 90 + j * 17, 1, 1, true, color(0), color(255, 255, 66), 1);
                                }
                            } else {
                                if (gamemode === 4) {
                                    _text('#' + (j + 1) + ' - ' + entry.name + ": Kills - " + entry.kills, width / 4 + 10, 60 + j * 9, 1, 1, true, color(0), color(255), 1);
                                } else {
                                    _text('#' + (j + 1) + ' - ' + entry.name + ": Kills - " + entry.kills, width / 4 + 10, 90 + j * 17, 1, 1, true, color(0), color(255), 1);
                                }
                            }
                        }
                    }

                    if (killedCount === gamemodes[gamemode].totalBots) {
                        p.won = true;
                    }
                    popStyle();
                    popMatrix();
                }
            }

            // MUST match to variable gamemodes[gamemode]
            var game = function() {


                // set game width and height to current gamemode's data
                gd.gW = gamemodes[gamemode].mapW;
                gd.gH = gamemodes[gamemode].mapH;

                // spawning trees and rocks
                if (rocksSpawned === false) {
                    /*rocks.push(new Rock({
                        x: 200,
                        y: 200,
                        rad: random(90, 100),
                        type: 1,
                    }));
                    rocks.push(new Rock({
                        x: 300,
                        y: 109,
                        rad: random(90, 100),
                        type: 1,
                    }));
                    rocks.push(new Rock({
                        x: 100,
                        y: 300,
                        rad: random(90, 100),
                        type: 1,
                    }));
                    rocks.push(new Rock({
                        x: 400,
                        y: 200,
                        rad: random(90, 100),
                        type: 1,
                    }));
                    rocks.push(new Rock({
                        x: 200,
                        y: 400,
                        rad: random(90, 100),
                        type: 1,
                    }));
                    rocks.push(new Rock({
                        x: 400,
                        y: 400,
                        type: 1,
                        rad: random(90, 100),
                    }));
                    rocks.push(new Rock({
                        x: 500,
                        y: 300,
                        type: 1,
                        rad: random(90, 100),
                    }));
                    rocks.push(new Rock({
                        x: 400,
                        y: 100,
                        type: 1,
                        rad: 80,
                    }));
                    rocks.push(new Rock({
                        x: 200,
                        y: 100,
                        type: 1,
                        rad: 80,
                    }));
                    rocks.push(new Rock({
                        x: 500,
                        y: 200,
                        type: 1,
                        rad: 80,
                    }));
                    rocks.push(new Rock({
                        x: 100,
                        y: 200,
                        type: 1,
                        rad: 80,
                    }));
                    rocks.push(new Rock({
                        x: 400,
                        y: 500,
                        type: 1,
                        rad: 80,
                    }));
                    rocks.push(new Rock({
                        x: 200,
                        y: 500,
                        type: 1,
                        rad: 80,
                    }));
                    rocks.push(new Rock({
                        x: 500,
                        y: 400,
                        type: 1,
                        rad: 80,
                    }));
                    rocks.push(new Rock({
                        x: 100,
                        y: 400,
                        type: 1,
                        rad: 80,
                    }));*/
                    for (var z = 0; z < gamemodes[gamemode].totalRocks; z++) {
                        rocks.push(new Rock({
                            x: random(0, gd.gW),
                            y: random(0, gd.gH),
                            rad: random(50, 80),
                            type: 0,
                        }));
                        rocks.push(new Rock({
                            x: random(0, gd.gW),
                            y: random(0, gd.gH),
                            rad: random(75, 100),
                            type: 1,
                        }));
                    }


                    rocksSpawned = true;
                }
                for (var z in rocks) {
                    for (var i = 0; i < rocks.length; i++) {
                        if (rocks[i] !== rocks[z] && dist(rocks[z].x, rocks[z].y, rocks[i].x, rocks[i].y) <= rocks[z].rad) {
                            rocks.splice(z, 1);
                            rocks.splice(i, 1);
                            rocks.push(new Rock({
                                x: random(0, gd.gW),
                                y: random(0, gd.gH),
                                rad: random(50, 80),
                                type: 0,
                            }));
                            rocks.push(new Rock({
                                x: random(0, gd.gW),
                                y: random(0, gd.gH),
                                rad: random(75, 100),
                                type: 1,
                            }));
                        }
                    }
                }

                //   println(rocks.length);

                // pond heigth to current gamemode's data
                pond.h = gd.gH;

                // remove cursor
                cursor("NONE");
                textAlign(LEFT, LEFT);
                noStroke();

                // removed in production for better performance
                // try {

                background(66, 66, 66);
                harvest.show = false;
                // player gun shoots when mouse is pressed
                if (mouseIsPressed) {
                    if (p.reload === true) {
                        if (p.weapon === "pistol") {
                            bullets.push(new Blt({
                                x: p.x,
                                y: p.y,
                                angle: p.angle - 90,
                                speed: weaponSpeed.pistol + random(-3, 3),
                                who: "player",
                                range: p.weaponRange[p.weaponLevel][0]
                            }));
                            doSound(getSound("retro/laser1"));
                            p.shotsFired.push({
                                weapon: "pistol"
                            });
                        } else if (p.weapon === "musket") {
                            doSound(getSound("retro/boom2"));
                            bullets.push(new Blt({
                                x: p.x,
                                y: p.y,
                                angle: p.angle - 90,
                                speed: weaponSpeed.musket,
                                who: "player",
                                range: p.weaponRange[p.weaponLevel][1]
                            }));
                            p.shotsFired.push({
                                weapon: "musket"
                            });

                        } else if (p.weapon === "AR") {
                            doSound(getSound("retro/hit2"));
                            bullets.push(new Blt({
                                x: p.x,
                                y: p.y,
                                angle: p.angle - 90 + random(3, -3),
                                speed: weaponSpeed.ar,
                                who: "player",
                                range: p.weaponRange[p.weaponLevel][2]
                            }));

                            p.shotsFired.push({
                                weapon: "AR"
                            });
                        } else if (p.weapon === "SMG") {
                            doSound(getSound("retro/hit2"));
                            bullets.push(new Blt({
                                x: p.x,
                                y: p.y,
                                angle: p.angle - 90 + random(-3, 3),
                                speed: weaponSpeed.smg,
                                who: "player",
                                range: p.weaponRange[p.weaponLevel][3], //[9,35,23,15]
                            }));
                            p.shotsFired.push({
                                weapon: "SMG"
                            });
                        }
                        p.reload = false;
                    }

                } else if (p.reload === false) {
                    p.reload = false;
                    shooting = false;

                }

                //println(p.reload+" Bullets: " + bullets.length+" Rnum:"+p.rnum);

                //particle shooting
                if (p.reload === false) {
                    for (var z = 0; z < 5; z++) {
                        // booms.push(new boom(p.x, p.y, "bullet",20, color(255, 0+z*22, 0, z*14), 0,0,60+(z*2),60+(z*2)));
                        if (p.weapon === 'SMG') {
                            booms.push(new boom(0, 0, "bullet", 20, color(254, 200 + z * 5, 35), random(-0.5, 0.5), random(-0.5, 0.5), 50 + (z * 2), 50 + (z * 2)));
                        }
                    }
                }
                // recoil animation
                if (p.reload === false) {
                    p.recoil = -(sin(frameCount * shooting) * 1);
                } else {
                    p.recoil = lerp(p.recoil, 0, 0.15);
                }

                pushMatrix();
                translate(cam.x, cam.y);
                scale(cam.s); //ga.done=true;

                if (ga.done !== false) {
                    // sniper bigger range - LETS GOOO!!!
                    if (p.weapon === 'musket') {
                        cam.s = lerp(cam.s, 0.38, 0.5);
                        cam.x = (-p.x * cam.s + width / 2);
                        cam.y = (-p.y * cam.s + height / 2);
                    } else {
                        cam.s = lerp(cam.s, 0.5, 0.5);
                        cam.x = (-p.x * cam.s + width / 2);
                        cam.y = (-p.y * cam.s + height / 2);
                    }
                } else {

                    cam.x = (-p.x * cam.s + width / 2);
                    cam.y = (-p.y * cam.s + height / 2);
                    ga.t++;
                    if (testing === true) {
                        ga.done = true;
                    }
                    if (ga.t >= 0 && ga.t <= 400) {
                        cam.s = lerp(cam.s, 1 / (gd.gH / height * 2), 0.05);
                    } else if (ga.t >= 400 && ga.t <= 500) {

                        cam.s = lerp(cam.s, 0.5, 0.05);
                    } else if (ga.t >= 500) {
                        ga.done = true;
                        cam.s = lerp(cam.s, 0.5, 0.5);

                    }
                }

                //    fill(212, 192, 106);
                fill(8, 99, 21);
                rect(0, 0, gd.gW, gd.gH);
                //fill(212, 175, 106);
                fill(212, 192, 106);

                rect(gd.gW / 2, 0, gd.gW / 2, gd.gH);

                //for(var i = 0; i < 1800; i +=700){
                //for(var j = 0; j < 1800; j +=700){
                noStroke();
                pushStyle();
                /*for (var i = 0; i < gd.gW/w; i += 1) {
                    for (var j = 0; j < gd.gH/h; j += 1) {
                        //
                        image(imgs.grid, i *w, j * h,w, h);
                    }
                }*/
                if (delag === false) {
                    for (var i = 0; i < gd.gW; i += width) {
                        for (var j = 0; j < gd.gH; j += height) {
                            image(imgs.grid, i * 1, j * 1, width, height);
                        }
                    }
                }
                if (gamemodes[gamemode].pond === 'default') {
                    pond.run();
                }
                popStyle();
                //p.weaponLevel=2;
                //p.traitlevel=1;

                if (p.trait === 'Juggernaut' && p.traitlevel !== 0) {
                    particles.push(w11 = new Particle(
                        p.x, // x positions
                        p.y, // y position
                        //color(125, 125, 125, p.traitlevel*100), // p.c
                        color(random(0, 150), random(20, 120), 255, 50), // p.c
                        //      random(-0.1,0.1),random(-0.1,0.1), // p.yal
                        0, 0,
                        random(10, 60), // p.size
                        random(0, 0), // p.WIND
                        0, // p.PRESSURE
                        4 - ((p.traitlevel / 1.5)) // p.dissNum
                    ));
                } else if (p.trait === 'Scout' && p.traitlevel !== 0) {
                    particles.push(w11 = new Particle(
                        p.x, // x positions
                        p.y, // y position
                        //color(125, 125, 125, p.traitlevel*100), // p.c
                        color(random(0, 150), random(150, 255), random(150, 255), 50), // p.c
                        //      random(-0.1,0.1),random(-0.1,0.1), // p.yal
                        0, 0,
                        random(10, 60), // p.size
                        random(0, 0), // p.WIND
                        0, // p.PRESSURE
                        4 - ((p.traitlevel / 1.5)) // p.dissNum
                    ));
                }
                if (p.weaponLevel === 0) {
                    // nothing in level 0
                    inv.colr = color(201, 202, 189);
                } else if (p.weaponLevel === 1) {
                    inv.colr = color(127, 138, 84, 200);
                    inv.colr = color(120, 223, 106);
                } else if (p.weaponLevel === 2) {
                    inv.colr = color(77, 84, 145, 200);
                    inv.colr = color(54, 189, 241);
                } else if (p.weaponLevel === 3) {
                    inv.colr = color(161, 126, 52, 200);
                    inv.colr = color(141, 92, 193);
                } else if (p.weaponLevel === 4) {

                    inv.colr = color(161, 75, 53, 200);
                    inv.colr = color(252, 212, 59);
                    /*particles.push(w11 = new Particle(
                      p.x, // x positions
                      p.y, // y position
                      color(random(0, 255), random(0, 255), random(0, 255), 150), // p.c
                      random(-0.25, 0.25), // p.xal
                      random(-0.25, 0.25), // p.yal
                      random(10, 49), // p.size
                      random(0, 0), // p.WIND
                      0, // p.PRESSURE
                      2 // p.dissNum
                    ));*/
                }
                initiateParticles();

                // B logic #1
                for (var i = bullets.length - 1; i >= 0; i--) {
                    bullets[i].display();
                    bullets[i].update();

                    //booms.push(new boom(bullets[i].x, bullets[i].y, "bullet", 150, color(255, 255, 255, 120), 0, random(1,-1)));

                    if (bullets[i].collision(p) && bullets[i].who === "hostile") {
                        bullets[i].Splice = true;

                        p.health -= guns.damage[bullets[i].enemyGunLevel][bullets[i].enemyType];
                    }

                    for (var a in zombs) {
                        if (bullets[i].collision(zombs[a]) && bullets[i].who === "player") {
                            zombs[a].hit = true;
                            //bullets[i].Splice = true;
                        }
                    }

                    for (var d in enemies) {
                        if (gamemodes[gamemode].totalBots !== undefined) {
                            if (bullets[i].collision(enemies[d]) && bullets[i].who === "player") {
                                //bullets[i].Splice = true;
                                enemies[d].hit = true;
                                enemies[d].killedBy = 'Player';

                            }

                            // AI damaging each other
                            if (gamemodes[gamemode].totalBots !== undefined) {
                                if (bullets[i].collision(enemies[d]) && bullets[i].who === "hostile") {
                                    // bullets[i].Splice = true;
                                    enemies[d].hp -= guns.damage[bullets[i].enemyGunLevel][bullets[i].enemyType];
                                    enemies[d].hit = true;
                                    // since it changes each time there is a collision, why not this:
                                    enemies[d].killedBy = bullets[i].src;
                                    /*if (enemies[d].hp <= 0 && enemies[d].dead === false) {
                                        enemies[d].killedBy = bullets[i].src;
                                        //println(bullets[i].src+'|'+enemies[d].killedBy);
                                    }*/

                                }

                            }

                        } else {
                            if (bullets[i].collision(enemies[d]) && bullets[i].who === "player") {

                                enemies[d].hit = true;
                                //bullets[i].Splice = true;
                            }
                        }


                    }
                }
                for (var c = bullets.length - 1; c >= 0; c--) {
                    if (bullets[c].Splice) {
                        bullets.splice(c, 1);
                    }
                }



                //p.collide(airdrops);
                p.run();
                p.collide(zombs);
                p.collide(enemies);
                p.timeAlive += 1 / 60;
                if (gamemodes[gamemode].edibles === true) {
                    if (airdrops.length < 1) {
                        airdrops.push(new Airdrop({
                            x: random(100, gd.gW - 200),
                            y: random(100, gd.gH - 200)
                        }));
                    }

                    for (var i = 0; i < airdrops.length; i++) {
                        airdrops[i].run();
                        airdrops[i].collide(p, 1);
                        airdrops[i].collide(zombs, 0);
                        airdrops[i].collide(enemies, 0);

                        for (var b in bullets) {
                            if (bullets[b].collision(airdrops[i])) {
                                bullets[b].Splice = true;
                            }
                        }
                        if (airdrops[i].spliced === true) {
                            airdrops.splice(i, 1);
                        }
                    }
                }

                if (gamemode === 0) {
                    if (frameCount % 250 === 0 && zombs.length < 10 && ga.done === true) {
                        zombs.push(new Zomb({
                            x: random(0, gd.gW),
                            y: random(0, gd.gH),
                            type: zombieTypes[Math.floor(Math.random() * zombieTypes.length)],
                        }));
                    }

                    if (frameCount % 250 === 0 && enemies.length < 10 && ga.done === true) {
                        enemies.push(new AI({
                            x: random(0, gd.gW),
                            y: random(0, gd.gH),
                            //type: zombieTypes[Math.floor(Math.random() * zombieTypes.length)],
                            type: enemyTypes[Math.floor(Math.random() * enemyTypes.length)],
                        }));
                    }
                } else if (gamemode === 1) {
                    if (frameCount % 125 === 0 && enemies.length < 20 && ga.done === true) {
                        enemies.push(new AI({
                            x: random(0, gd.gW),
                            y: random(0, gd.gH),
                            //type: zombieTypes[Math.floor(Math.random() * zombieTypes.length)],
                            type: enemyTypes[Math.floor(Math.random() * enemyTypes.length)],
                        }));
                    }
                } else if (gamemode === 2) {
                    if (frameCount % 125 === 0 && zombs.length < 20 && ga.done === true) {
                        zombs.push(new Zomb({
                            x: random(0, gd.gW),
                            y: random(0, gd.gH),
                            type: zombieTypes[Math.floor(Math.random() * zombieTypes.length)],
                        }));
                    }
                } else if (gamemode === 3 || gamemode === 4 || gamemode === 5) {
                    if (batch1Spawned === false && ga.done === true) {
                        // No difference since the performance difference between a forward and a backward loop is negligible.Either loop direction will work fine.
                        //for(var i = 19; i >= 0; i--){
                        for (var i = 0; i < gamemodes[gamemode].totalBots; i++) {
                            enemies.push(new AI({
                                x: random(0, gd.gW),
                                y: random(0, gd.gH),
                                //type: zombieTypes[Math.floor(Math.random() * zombieTypes.length)],
                                type: mysteryMode.weapon,
                                // id: Math.floor(Math.random() *gamemodes[3].totalBots+1),
                                id: i + 1,
                            }));
                        }
                        batch1Spawned = true;
                    }
                }



                // println(gamemodes[gamemode].name + '-' + gamemode);

                // B logic #2
                if (gamemode === 0 || gamemodes[gamemode].bots === false) {
                    for (var zomb in zombs) {
                        zombs[zomb].run();

                        if (zombs[zomb].Splice) {
                            p.kills++;
                            zombs.splice(zomb, 1);
                            p.killData.push("kill");

                            switch (p.killData.length) {
                                case 0:
                                    break;
                                case 1:
                                    p.score += 2;
                                    break;
                                case 2:
                                    p.score += 15;
                                    break;
                                case 3:
                                    p.score += 20;
                                    break;
                                case 4:
                                    p.score += 25;
                                    break;
                                case 5:
                                    p.score += 30;
                                    break;
                                case 6:
                                    p.score += 35;
                                    break;
                                case 7:
                                    p.score += 40;
                                    break;
                                case 8:
                                    p.score += 45;
                                    break;
                                case 9:
                                    p.score += 50;
                                    break;
                            }
                        }
                    }

                }
                for (var i = enemies.length - 1; i >= 0; i--) {
                    if (gamemode === 3 || gamemode === 4 || gamemode === 5) {
                        enemies[i].run(enemies);

                    } else {
                        enemies[i].run();
                    }
                    if (gamemode === 3 || gamemode === 4 || gamemode === 5) {
                        if (enemies[i].Splice === true) {
                            if (gamemodes[gamemode].totalBots !== undefined) {
                                if (enemies[i].hp <= 0 && !enemies[i].killProcessed) {
                                    if (enemies[i].killedBy === 'Player') {

                                        p.kills++;
                                        p.killData.push("kill");
                                        switch (p.killData.length) {
                                            case 0:
                                                break;
                                            case 1:
                                                p.score += 10;
                                                break;
                                            case 2:
                                                p.score += 25;
                                                break;
                                            case 3:
                                                p.score += 35;
                                                break;
                                            case 4:
                                                p.score += 45;
                                                break;
                                            case 5:
                                                p.score += 55;
                                                break;
                                            case 6:
                                                p.score += 65;
                                                break;
                                            case 7:
                                                p.score += 80;
                                                break;
                                            case 8:
                                                p.score += 95;
                                                break;
                                            case 9:
                                                p.score += 100;
                                                break;
                                        }

                                        enemies[i].killProcessed = true;
                                    }
                                    if (enemies[i].killedBy !== 'Player') {
                                        var killer = null;
                                        for (var j = 0; j < enemies.length; j++) {
                                            if (enemies[j].id === enemies[i].killedBy) {
                                                killer = enemies[j];
                                                break;
                                            }
                                        }
                                        if (killer) {
                                            killer.kills++;
                                            enemies[i].killProcessed = true;
                                        }
                                    }
                                }

                            }
                            enemies[i].dead = true;
                        }
                    } else {
                        if (enemies[i].Splice) {
                            p.kills++;
                            enemies.splice(i, 1);
                            p.killData.push("kill");

                            switch (p.killData.length) {
                                case 0:
                                    break;
                                case 1:
                                    p.score += 10;
                                    break;
                                case 2:
                                    p.score += 25;
                                    break;
                                case 3:
                                    p.score += 35;
                                    break;
                                case 4:
                                    p.score += 45;
                                    break;
                                case 5:
                                    p.score += 55;
                                    break;
                                case 6:
                                    p.score += 65;
                                    break;
                                case 7:
                                    p.score += 80;
                                    break;
                                case 8:
                                    p.score += 95;
                                    break;
                                case 9:
                                    p.score += 100;
                                    break;
                            }
                        }
                    }
                }

                for (var i = booms.length - 1; i >= 0; i--) {
                    booms[i].display();
                    booms[i].update();
                    if (booms[i].health <= 0) {
                        booms.splice(i, 1);
                    }
                }

                for (var rock = rocks.length - 1; rock >= 0; rock--) {

                    rocks[rock].run();
                    rocks[rock].collide(zombs, 0);
                    rocks[rock].collide(p, 1);
                    rocks[rock].collide(enemies, 0);
                }

                for (var b = bullets.length - 1; b >= 0; b--) {
                    for (var j = zombs.length - 1; j >= 0; j--) {
                        if (zombs[j].hit === true) {
                            hitCursor = true;
                            bullets[b].Splice = true;
                            for (var i = 0; i < 10; i++) {
                                booms.push(new boom(zombs[j].x, zombs[j].y, "zomb", 200, color(100, 0, 17, 150), random(-10, 10), random(-10, 10)));

                            }
                            switch (p.weapon) {
                                case "pistol":
                                    zombs[j].hp -= p.weaponDamage[p.weaponLevel][0];
                                    break;
                                case "musket":
                                    zombs[j].hp -= p.weaponDamage[p.weaponLevel][1];
                                    break;
                                case "AR":
                                    zombs[j].hp -= p.weaponDamage[p.weaponLevel][2];
                                    break;
                                case "SMG":
                                    zombs[j].hp -= p.weaponDamage[p.weaponLevel][3];
                                    break;
                            }
                            zombs[j].hit = false;
                        } else {

                        }
                    }

                    for (var q = enemies.length - 1; q >= 0; q--) {
                        if (enemies[q].hit === true) {

                            hitCursor = true;
                            bullets[b].Splice = true;
                            for (var i = 0; i < 10; i++) {
                                booms.push(new boom(enemies[q].x, enemies[q].y, "zomb", 200, color(100, 0, 17, 150), random(-10, 10), random(-10, 10)));

                            }

                            switch (p.weapon) {
                                case "pistol":
                                    enemies[q].hp -= p.weaponDamage[p.weaponLevel][0];
                                    break;
                                case "musket":
                                    enemies[q].hp -= p.weaponDamage[p.weaponLevel][1];
                                    break;
                                case "AR":
                                    enemies[q].hp -= p.weaponDamage[p.weaponLevel][2];
                                    break;
                                case "SMG":
                                    enemies[q].hp -= p.weaponDamage[p.weaponLevel][3];
                                    break;
                            }
                            enemies[q].hit = false;
                        }
                    }

                    for (var r in rocks) {
                        if (bullets[b].collision(rocks[r])) {
                            bullets[b].Splice = true;
                        }

                    }
                }
                if (hitCursor === true) {

                    hitReload++;
                }
                if (hitReload >= 10) {
                    hitCursor = false;
                    hitReload = 0;
                }

                //println(hitReload);
                if (mouseIsPressed) {
                    // crude but works :P
                    if (p.reload === true && p.weapon === 'fists') {
                        if (p.rock >= 25) {
                            p.rock -= 25;
                            rocks.push(new Rock({
                                x: p.x,
                                y: p.y, //Math.atan2(mouseX - width / 2, -(mouseY - height / 2)) * (180 / PI)
                                rad: 100,
                                type: 1,
                            }));
                        }
                    }
                }

                // overlay for night mode

                if (night.on) {
                    night.op = lerp(night.op, 75, 0.005);
                } else {
                    night.op = lerp(night.op, 0, 0.005);
                }
                fill(6, 0, 15, night.op);
                rect(0, 0, gd.gW, gd.gH);
                /** 
                 * EVERYTHING AFTER HERE IS HEADS UP DISPLAY
                 **/


                // inventory
                popMatrix();

                pushMatrix();
                translate(groups.b[0], groups.b[1]);
                inv.run();
                popMatrix();
                stats.run();


                // map
                pushMatrix();
                translate(groups.a[0], groups.a[1]);
                pushMatrix();
                translate(width - 100, 10);

                fill(26, 26, 26, 80);
                rect(0, 0, gd.gW / gd.mapScale, gd.gH / gd.mapScale, 2);
                fill(255, 255, 255);
                ellipse(p.x / gd.mapScale, p.y / gd.mapScale, 5, 5);

                fill(224, 0, 26);
                textFont(createFont(fontss[0]), 15);
                if (airdrops.length === 1) {
                    text("x", airdrops[0].x / gd.mapScale, airdrops[0].y / gd.mapScale);
                }
                popMatrix();
                popMatrix();

                // stats at left
                pushMatrix();
                translate(groups.b[0], groups.b[1] + 20);
                scale(0.5);
                pushMatrix();
                translate(25, 500);
                noStroke();
                fill(0, 0, 0, 80);
                rect(-5, -25, 60 + p.score.toString().length * 10, 37, 4);
                textFont(createFont(fontss[0]), 20);
                fill(255, 255, 255);
                _text(p.score, 35, 0, 1, 1, true, color(0), color(255), 1);
                star(-0, -20, 0.09, 0.09, 0);
                popMatrix();
                // if gamemode's edibles is true, display edible data
                if (gamemodes[gamemode].edibles === true) {

                    pushMatrix();
                    translate(25, 400 - 10);
                    noStroke();
                    fill(0, 0, 0, 80);
                    rect(-5, -25, 80, 37, 4);
                    textFont(createFont(fontss[0]), 20);
                    fill(255, 255, 255);
                    text((~~p.food), 35, 0);
                    grape(-5, -25, 0.25, 0.25, 0);

                    fill(0, 0, 0);
                    rect(-5, 10, 100 - 20, 10, 0, 0, 4, 4);
                    fill(245, 203, 49);
                    rect(-5, 10, p.food / 1.25, 10, 0, 0, 4, 4);
                    popMatrix();

                    pushMatrix();
                    translate(25, 450 - 5);
                    noStroke();
                    fill(0, 0, 0, 100);
                    rect(-5, -25, 80, 37, 4);
                    fill(255, 255, 255);
                    text((~~p.water), 35, 0);
                    waterdrop(-0, -20, 0.1, 0.1, 0);
                    fill(0, 0, 0);
                    rect(-5, 10, 100 - 20, 10, 0, 0, 4, 4);
                    fill(49, 142, 247);
                    rect(-5, 10, p.water / 1.25, 10, 0, 0, 4, 4);
                    popMatrix();
                }
                // stats at left -> wood, rock
                pushMatrix();
                translate(25, 150 - 5);
                noStroke();
                fill(0, 0, 0, 80);
                rect(-5, -25, 80, 37, 4);
                fill(255, 255, 255);
                text("W " + (~~p.wood), 0, 0);
                popMatrix();

                pushMatrix();
                translate(25, 200 - 5);
                noStroke();
                fill(0, 0, 0, 80);
                rect(-5, -25, 80, 37, 4);
                fill(255, 255, 255);
                text("R " + (~~p.rock), 0, 0);
                popMatrix();

                pushMatrix();
                translate(25, 250 - 5);
                noStroke();
                fill(0, 0, 0, 80);
                rect(-5, -25, 80, 37, 4);
                fill(255, 255, 255);
                text("$ " + (~~p.money), 0, 0);
                popMatrix();


                popMatrix();

                // game leaderboard
                drawgamelead();

                if (keyIsPressed && keyCode === keys[32]) {
                    groups.b[2]++;
                }

                if (groups.b[2] % 2 === 0) {
                    groups.b[0] = lerp(groups.b[0], -350, 0.15);
                    if (characterIsSupported('\ufffe')) {
                        groups.b[3] = "▶";
                    } else {
                        groups.b[3] = ">";

                    }
                } else if (groups.b[2] % 2 !== 0) {
                    groups.b[0] = lerp(groups.b[0], 0, 0.15);
                    if (characterIsSupported('\ufffe')) {
                        groups.b[3] = "◀";
                    } else {
                        groups.b[3] = "<";
                    }

                }
                if (groups.b[2] >= 2) {
                    groups.b[2] = 0;
                }

                if (keys[88]) {
                    if (groups.b[2] === 0) {

                        groups.b[2] = 1;
                    } else if (groups.b[2] === 1) {
                        groups.b[2] = 2;
                    }
                }
                if (keys[81]) {
                    if (groups.c[2] === 0) {

                        groups.c[2] = 1;
                    } else if (groups.c[2] === 1) {
                        groups.c[2] = 2;
                    }
                }
                if (groups.c[2] % 2 === 0) {
                    groups.c[0] = lerp(groups.c[0], -350, 0.15);
                    if (characterIsSupported('\ufffe')) {
                        groups.c[3] = "☰";
                    } else {
                        groups.c[3] = "=";

                    }
                } else if (groups.c[2] % 2 !== 0) {
                    groups.c[0] = lerp(groups.c[0], 0, 0.15);
                    if (characterIsSupported('\ufffe')) {
                        groups.c[3] = "✖";
                    } else {
                        groups.c[3] = "x";
                    }

                }
                if (groups.c[2] >= 2) {
                    groups.c[2] = 0;
                }
                uiButton(20, height / 2, 30, 20, groups.b[3], function() {
                    groups.b[2]++;
                    //for testing nightmode
                    /*if(groups.b[2]%2===0){
                        night.on=true;
                    }else{night.on=false;}*/
                }, false, 'action', 0, 9);
                if (gamemodes[gamemode].totalBots !== undefined) {
                    uiButton(width - 20, height / 2, 30, 20, groups.c[3], function() {
                        groups.c[2]++;
                        //for testing nightmode
                        /*if(groups.b[2]%2===0){
                            night.on=true;
                        }else{night.on=false;}*/
                    }, false, 'action', 0, 9);
                }
                textAlign(CENTER, CENTER);
                btns[6].run();

                harvest.display();

                if (p.killData.length >= 1 && frameCount % 100 === 0) {
                    p.killData = [];
                    kscale = 0;
                }

                /*if (p.food <= 100) {
                    p.food-=0.01;
                }
                if (p.water <= 100) {
                    p.water-=0.01;
                }*/

                // every ~25 seconds
                if (gamemodes[gamemode].edibles === true) {
                    if (frameCount % 1025 === 0) {
                        p.food -= 10;
                    }

                    // every ~10 seconds
                    if (frameCount % 600 === 0) {
                        p.water -= 10;
                    }

                    if (p.food <= 0) {
                        p.food = 0;
                        p.health -= 0.25;
                    }
                    if (p.water <= 0) {
                        p.water = 0;
                        p.health -= 0.25;

                    }
                }
                switch (p.killData.length) {
                    case 1:
                        ktext(killText[0], 0, 0);
                        break;
                    case 2:
                        ktext(killText[1], 0, 0);
                        break;
                    case 3:
                        ktext(killText[2], 0, 0);
                        break;
                    case 4:
                        ktext(killText[3], 0, 0);
                        break;
                    case 5:
                        ktext(killText[4], 0, 0);
                        break;
                    case 6:
                        ktext(killText[5], 0, 0);
                        break;
                    case 7:
                        ktext(killText[6], 0, 0);
                        break;
                    case 8:
                        ktext(killText[7], 0, 0);
                        break;
                    case 9:
                        ktext(killText[8], 0, 0);
                        break;
                }

                if (testing === true) {
                    fill(0);
                    textSize(10);
                    _text(this.__frameRate.toFixed(2) + ' FPS', 25, 9, true, 1, 1, color(0, 0, 0), color(255, 255, 255), 1);
                }

                //println(airdrops.length);
                //println(p.killData);
                //println(zombs.length);
                //println(bullets.length);
                //println(rocks.length);



                pushStyle();
                textSize(10);
                textAlign(RIGHT, RIGHT);
                text(~~p.timeAlive, width - 2, height - 2);
                popStyle();

                if (gamemode === 6) {
                    if (ga.msg_t <= 300) {
                        msg = 'Welcome to NATUWARS!\nGo near trees and rocks and press E to harvest them.';
                    } else if (ga.msg_t <= 600) {
                        msg = 'Use number keys 1-' + inv.total + ' to cycle through your inventory.\nWhen a gun is selected, click to fire.';
                    } else if (ga.msg_t <= 900) {
                        if (p.trait !== '') {
                            msg = 'You currently have the ' + p.trait + ' trait.\nTraits give you special abilities.';
                        } else {
                            msg = "You don't have a trait currently.\nTraits give you special abilities.";
                        }
                    } else if (ga.msg_t <= 1200) {
                        msg = 'Click the in-game Shop button in the bottom right corner.\nYou can upgrade your guns and trait there.';
                    } else if (ga.msg_t <= 1500) {
                        msg = 'After harvesting resources, you can also trade them for money.\nAfter you die, your money will be saved to your account.';
                    } else if (ga.msg_t <= 1800) {
                        msg = 'Different game modes will have different objectives.\nGet better by playing each one!';
                    } else if (ga.msg_t <= 2100) {
                        msg = 'To build, select 1 in your inventory.\nYou can only build rocks (costs 25 harvested rock).';
                    } else if (ga.msg_t >= 2500) {
                        msg = 'You have completed the tutorial.\nReturning to menu now.';
                        p.health--;
                    }
                    ga.msg_t++;
                } else if (gamemode === 0 || gamemode === 1 || gamemode === 2) {
                    if (ga.msg_t <= 300) {
                        // msg = gamemodes[gamemode].name+' Mode\n'+gamemodes[gamemode].desc;
                        msg = gamemodes[gamemode].name + ' Mode\n"' + gamemodes[gamemode].desc.replace('.', '') + '"\nOpen Airdrops (red X on map) to replenish food and water levels.\nWater levels drop faster than food.\nTime in water replenishes water levels.';

                    } else if (ga.msg_t >= 600) {
                        msg = '';
                    }
                    ga.msg_t++;


                } else if (gamemode === 3) {
                    //mysteryMode.weapon = enemyTypes[Math.floor(Math.random() * enemyTypes.length)];
                    //println(mysteryMode.weapon);
                    if (ga.msg_t <= 300) {
                        msg = gamemodes[gamemode].name + ' Mode\n"' + gamemodes[gamemode].desc.replace('.', '') + '"\nEveryone is on their own. Be the last one standing to win!';

                    } else if (ga.msg_t >= 600) {
                        msg = '';
                    }
                    ga.msg_t++;
                } else if (gamemode === 4) {
                    if (ga.msg_t <= 300) {
                        msg = gamemodes[gamemode].name + ' Mode\n"' + gamemodes[gamemode].desc.replace('.', '') + '"\nEveryone is on their own. Be the last one standing to win!';

                    } else if (ga.msg_t >= 600) {
                        msg = '';
                    }
                    ga.msg_t++;
                } else if (gamemode === 5) {
                    if (ga.msg_t <= 300) {
                        msg = gamemodes[gamemode].name + ' Mode\n"' + gamemodes[gamemode].desc.replace('.', '') + '"\n';

                    } else if (ga.msg_t >= 600) {
                        msg = '';
                    }
                    ga.msg_t++;
                }
                // regardless of gamemode, night is nighttime
                if (ga.msg_t2 <= 100 && night.on === true) {
                    if (night.op >= 15) {
                        msg = 'Night Has Fallen, Enemies Are Stronger';
                    }
                } else if (ga.msg_t2 >= 250) {
                    msg = '';

                }
                if (night.on === true) {
                    ga.msg_t2++;
                } else {
                    ga.msg_t2 = 0;
                }
                pushStyle();
                textAlign(CENTER, CENTER);
                textFont(createFont(fontss[1]), 12);
                _text(msg, width / 2, height - 70, 1, 1, !true, color(0, 0, 0), color(255, 255, 255), 0.1);
                popStyle();

                pushStyle();
                if (cursorOn === true) {
                    if (p.altCursor === true) {
                        p.cursorType = 0;
                        if (mouseIsPressed || keys[32]) {

                            if (p.weapon === "pistol") {
                                qwe = lerp(qwe, 360, 0.25);

                            }
                            if (p.weapon === "musket") {
                                qwe = lerp(qwe, 360, 0.1);

                            }
                            if (p.weapon === "AR") {
                                qwe = lerp(qwe, 360, 0.5);

                            }
                            if (p.weapon === "SMG") {
                                qwe = lerp(qwe, 360, 1);

                            }
                        } else {
                            qwe = lerp(qwe, 0, 0.2);
                            qwesize = lerp(qwesize, 20, 0.2);
                        }
                        //25, 100, 20, 10

                        pushStyle();
                        noStroke();
                        strokeWeight(1);
                        if (p.reload === true) {
                            fill(qweclr, 45);
                            qwesize = lerp(qwesize, 45, 0.2);
                            qweclr = lerp(qweclr, color(0, 0, 0), 0.2);
                        } else {
                            fill(qweclr, 45);
                            qweclr = lerp(qweclr, color(255, 225, 0), 0.7);
                            qwesize = lerp(qwesize, 20, 0.02);
                        }

                        translate(mouseX, mouseY);
                        rotate(-90);

                        stroke(qweclr);

                        arc(0, 0, qwesize, qwesize, 0, qwe);
                        popStyle();

                        if (p.cursorType === 0) {
                            pushStyle();
                            noFill();

                            stroke(0, 0, 0);

                            arc(mouseX, mouseY, 15, 15, 0, 360);


                            popStyle();
                        } else if (p.cursorType === 1) {
                            pushStyle();
                            noFill();
                            stroke(255, 255, 255);
                            arc(mouseX, mouseY, 18, 18, 0, 360);
                            arc(mouseX, mouseY, 12, 12, 0, 360);
                            stroke(0, 0, 0);

                            arc(mouseX, mouseY, 15, 15, 0, 360);


                            popStyle();
                        } else if (p.cursorType === 2) {
                            pushStyle();
                            noFill();
                            stroke(0, 0, 0);
                            arc(mouseX, mouseY, 18, 18, 0, 360);
                            arc(mouseX, mouseY, 12, 12, 0, 360);
                            stroke(255, 255, 255);

                            arc(mouseX, mouseY, 15, 15, 0, 360);


                            popStyle();
                        }
                    }
                    // the best cursor :P
                    else {
                        pushStyle();
                        noFill();
                        stroke(0, 0, 0);
                        pushMatrix();
                        translate(mouseX, mouseY);
                        scale(0.7);
                        stroke(0, 0, 0);
                        strokeWeight(0.5);
                        fill(255);
                        rect(3, 0, 6, 2, 2);
                        rect(-7, 0, 6, 2, 2);

                        rect(0, 3, 2, 6, 2);
                        rect(-0, -7, 2, 6, 2);

                        popMatrix();
                        if (hitCursor === true) {
                            pushMatrix();
                            translate(mouseX, mouseY);
                            scale(0.7);
                            translate(1, 0);
                            rotate(45);
                            noStroke();
                            fill(255, 0, 0);
                            rect(5, 0, 6, 1, 1);
                            rect(-9, 0, 6, 1, 1);

                            rect(0, 5, 1, 6, 1);
                            rect(0, -9, 1, 6, 1);

                            popMatrix();
                        }
                        popStyle();
                    }
                }
                popStyle();
                noStroke();
                strokeWeight(0.1);
                // } catch (e) {
                //      println(e);
                //   }

                //p.health-=25;
                // To test AI behavior

                if (p.health <= 0 && testing === false) {
                    pl.losses++;
                    gamemodes[gamemode].timesPlayed++;

                    pl.highscore.push({
                        timeAlive: p.timeAlive,
                        score: p.score,
                        kills: p.kills,
                        total: p.timeAlive + p.score + p.kills,
                    });
                    pl.highscore.sort(function(a, b) {
                        return b.total - a.total;
                    });

                    pl.matches++;
                    pl.kills += p.kills;
                    pl.deaths++;
                    gamemodeRewards = [{
                            trophyReward: Math.round((p.timeAlive + p.score + p.kills) / 2),
                            gemReward: Math.round(p.kills + p.score),
                        },
                        {
                            trophyReward: Math.round((p.timeAlive + p.score + p.kills) / 2),
                            gemReward: Math.round(p.kills + p.score),
                        },
                        {
                            trophyReward: Math.round((p.timeAlive + p.score + p.kills) / 2),
                            gemReward: Math.round(p.kills + p.score),
                        },
                        {
                            trophyReward: Math.round((p.timeAlive + p.score + p.kills) / 2),
                            gemReward: Math.round(p.kills + p.score),
                        },
                        {
                            trophyReward: Math.round((p.timeAlive + p.score + p.kills) / 2),
                            gemReward: Math.round(p.kills + p.score),
                        }, {
                            trophyReward: Math.round((p.timeAlive + p.score + p.kills) / 2),
                            gemReward: Math.round(p.kills + p.score),
                        },

                        {
                            trophyReward: 15,
                            gemReward: 50,
                        },
                    ];
                    pl.trophies += gamemodeRewards[gamemode].trophyReward;
                    pl.gems += gamemodeRewards[gamemode].gemReward;

                    p.health = 0;
                    p.dead = true;
                    scene = 4;
                }
                if (p.won === true && testing === false) {
                    gamemodes[gamemode].timesPlayed++;
                    pl.highscore.push({
                        timeAlive: p.timeAlive,
                        score: p.score,
                        kills: p.kills,
                        total: p.timeAlive + p.score + p.kills,
                    });
                    pl.highscore.sort(function(a, b) {
                        return b.total - a.total;
                    });

                    pl.matches++;
                    pl.kills += p.kills;
                    gamemodeRewards = [{
                            trophyReward: Math.round((p.timeAlive + p.score + p.kills)),
                            gemReward: Math.round(p.kills + p.score),
                        },
                        {
                            trophyReward: Math.round((p.timeAlive + p.score + p.kills)),
                            gemReward: Math.round(p.kills + p.score),
                        },
                        {
                            trophyReward: Math.round((p.timeAlive + p.score + p.kills)),
                            gemReward: Math.round(p.kills + p.score),
                        },
                        {
                            trophyReward: Math.round((p.timeAlive + p.score + p.kills)),
                            gemReward: Math.round(p.kills + p.score),
                        },
                        {
                            trophyReward: Math.round((p.timeAlive + p.score + p.kills)),
                            gemReward: Math.round(p.kills + p.score),
                        }, {
                            trophyReward: Math.round((p.timeAlive + p.score + p.kills) / 2),
                            gemReward: Math.round(p.kills + p.score),
                        },

                        {
                            trophyReward: 15,
                            gemReward: 50,
                        },
                    ];
                    pl.trophies += gamemodeRewards[gamemode].trophyReward;
                    pl.gems += gamemodeRewards[gamemode].gemReward;

                    p.health = 0;
                    p.dead = true;
                    scene = 9;
                    pl.wins++;
                    p.won = false;
                }
            };

            var modes = function() {
                noStroke();
                background(106, 152, 201);

                image(imgs.backgroundGrid, 0, 0, w, h);
                fill(51, 51, 51, 150);
                rect(0, 0, w, h);

                // navbar
                fill(0, 16, 51, 150);
                rect(0, 0, width, 30);
                image(imgs.gem, width - 140, 5, 20, 20);
                image(imgs.trophy, width - 70, 8, 32, 32);
                pushStyle();
                textAlign(LEFT, CENTER);
                textFont(createFont(fontss[1]), 15);
                _text(pl.trophies, width - 50, 15, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 1);
                _text(pl.gems, width - 115, 15, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 1);
                popStyle();
                textFont(createFont(fontss[1]), 25);
                textAlign(LEFT, LEFT);
                pushMatrix();
                _text("Game Modes", 13, 70, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 1);
                textSize(15);
                _text("Selected gamemode: " + gamemodes[gamemode].name, 13, 90, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 0.8);
                popMatrix();
                textFont(createFont(fontss[1]), 8);
                fill(204, 204, 204);
                pushMatrix();
                translate(w - 20, h - 5);
                rotate(0);
                textAlign(CENTER, CENTER);
                _text(version, 0, 0, 1, 1, !true, color(13, 13, 13), color(255, 255, 255), 0.5);
                popMatrix();

                // since ka pjs doesnt allow functions inside loops
                uiButton(50, 15, 100, 30, 'Back', function() {
                    scene = 0;
                }, false, false, 1, 18);

                uiButton(90, 150, 150, 100, gamemodes[0].name, function() {
                    gamemode = 0;
                }, false, 'mode', 1, 18, gamemodes[0].desc + '\nTimes played: ' + gamemodes[0].timesPlayed);
                uiButton(90 + 160 * 1, 150, 150, 100, gamemodes[1].name, function() {
                    gamemode = 1;
                }, false, 'mode', 1, 18, gamemodes[1].desc + '\nTimes played: ' + gamemodes[1].timesPlayed);
                uiButton(90 + 160 * 2, 150, 150, 100, gamemodes[2].name, function() {
                    gamemode = 2;
                }, false, 'mode', 1, 18, gamemodes[2].desc + '\nTimes played: ' + gamemodes[2].timesPlayed);

                uiButton(90, 260, 150, 100, gamemodes[3].name, function() {
                    gamemode = 3;
                }, false, 'mode', 1, 18, gamemodes[3].desc + '\nTimes played: ' + gamemodes[3].timesPlayed);
                uiButton(90 + 160 * 1, 260, 150, 100, gamemodes[4].name, function() {
                    gamemode = 4;
                }, false, 'mode', 1, 18, gamemodes[4].desc + '\nTimes played: ' + gamemodes[4].timesPlayed);
                uiButton(90 + 160 * 2, 260, 150, 100, gamemodes[5].name, function() {
                    gamemode = 5;
                }, false, 'mode', 1, 18, gamemodes[5].desc + '\nTimes played: ' + gamemodes[5].timesPlayed);

            };

            var home = function() {
                noStroke();
                background(106, 152, 201);

                image(imgs.backgroundGrid, 0, 0, w, h);
                fill(51, 51, 51, 150);
                rect(0, 0, w, h);

                model_p.display();

                // navbar
                fill(0, 16, 51, 150);
                rect(0, 0, width, 30);
                image(imgs.gem, width - 140, 5, 20, 20);
                image(imgs.trophy, width - 70, 8, 32, 32);
                pushStyle();
                textAlign(LEFT, CENTER);
                textFont(createFont(fontss[1]), 15);
                _text(pl.trophies, width - 50, 15, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 1);
                _text(pl.gems, width - 115, 15, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 1);
                popStyle();
                textFont(createFont(fontss[1]), 45);
                textAlign(CENTER, CENTER);
                fill(23, 46, 1, 2170);
                rect(0, 31, width, 55);
                pushMatrix();
                scale(0.5);
                //_text("NATUWARS™", 163, 140, 1, 1, !true, color(0, 0, 0), color(54, 227, 158), 1);
                game_logo(-32, 40, 1, 1, 0, color(132, 232, 93), color(23, 46, 1), color(132, 232, 93), color(53, 150, 15));
                textSize(30);
                _text("by LeaferStudios", 130, 110 + 25, 1, 1, !true, color(0, 0, 0), color(158, 224, 255), 0.3);
                popMatrix();
                textFont(createFont(fontss[1]), 8);
                fill(204, 204, 204);
                pushMatrix();
                translate(w - 20, h - 5);
                rotate(0);
                _text(version, 0, 0, 1, 1, !true, color(13, 13, 13), color(255, 255, 255), 0.5);
                popMatrix();

                uiButton(width - 59, 57.5, 100, 35, 'Subscribe', function() {
                    subscribe = true;
                }, false, 'support', 0, 14);

                // We don't need input name, it will be picked from the start
                pushStyle();
                pushMatrix();
                translate(0, 0);
                fill(58, 72, 107, 200);
                rectMode(CENTER);
                rect(55, h - 110, 100, 205, 2);
                textFont(createFont(fontss[1]), 11);
                pushStyle();
                textAlign(CENTER, LEFT);
                _text(pl.name, 10, h - 200, 1.1, 1.1, true, color(0, 0, 0), color(255, 255, 255), 0.6, 80, 100);
                popStyle();
                _text("Your Quickstats:\n\nK/D Ratio: " + pl.kdr + "\nKills: " + pl.kills + "\nDeaths: " + pl.deaths + '\n\nVisit Player page\nfor more stats!', 55, h - 110, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 1);
                popMatrix();
                popStyle();
                uiButton(30, height - 18, 50, 20, 'Save', function() {
                    /*var o31 = '';
                    for (var p31 in pl) {
                        o31 += p31 + ': ' + pl[p31] + ', ';
                    }
                    
                    println('// Replace line XX with this, then spin-off this program:\nvar pl = {' + o31 + '};\n\nBe sure to create a spin-off of this program to save your progress!');*/
                    saved = true;

                }, false, false, 1, 9);
                uiButton(80, height - 18, 50, 20, 'Load', function() {
                    /*println('Auto loading and saving is not implemented yet.\nFor now, use your save code to load your save file.\n\nComing soon! Subscribe here to get notified on the next major update: https://www.khanacademy.org/computer-programming/leaferstudios/4934504502870016');*/
                    loade = true;
                }, false, 'action', 1, 9);
                pushStyle();
                textAlign(RIGHT, RIGHT);
                textSize(15);
                _text("Your Gamemode:\n " + gamemodes[gamemode].name, width - 10, 200, 1, 1, !true, color(0, 0, 0), color(255, 255, 255), 0.1);
                popStyle();

                btns[0].run();
                btns[1].run();
                btns[2].run();
                btns[5].run();
                btns[8].run();
                btns[3].run();
            };

            var how = function() {
                noStroke();
                background(202, 182, 106);

                image(imgs.backgroundGrid, 0, 0, w, h);
                fill(51, 51, 51, 150);
                rect(0, 0, w, h);
                // navbar
                fill(0, 16, 51, 150);
                rect(0, 0, width, 30);
                image(imgs.gem, width - 140, 5, 20, 20);
                image(imgs.trophy, width - 70, 8, 32, 32);
                pushStyle();
                textAlign(LEFT, CENTER);
                textFont(createFont(fontss[1]), 15);
                _text(pl.trophies, width - 50, 15, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 1);
                _text(pl.gems, width - 115, 15, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 1);
                popStyle();


                pushStyle();
                textFont(createFont(fontss[1]), 25);
                textAlign(LEFT, LEFT);
                fill(255, 255, 255);
                _text("How to Play", 10, 60, 1, 1, !true, color(0, 0, 0), color(255, 255, 255), 1);
                _text("About", 10, 250, 1, 1, !true, color(0, 0, 0), color(255, 255, 255), 1);
                textSize(15);
                _text("Arrow Keys or WASD keys to move player. Click left mouse button to shoot weapon. Number keys 1-5 to switch weapons or inventory.", 10, 70, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 0.6, 580, 300);
                _text("NATUWARS is a 2D indie offline shooter developed by LeaferStudios\n© 2024" + (year() === 2024 ? '' : '-' + year()) + " LeaferStudios", 10, 260, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 0.6, 580, 300);
                popStyle();
                uiButton(width / 2, 180, 200, 80, gamemodes[6].name, function() {
                    gamemode = 6;
                    scene = 1;
                }, false, 'mode', 0, 18, gamemodes[6].desc + '\nTimes played: ' + gamemodes[6].timesPlayed);


                btns[1].run();
                btns[2].run();
                btns[8].run();
                btns[3].run();
                textSize(8);
                fill(204, 204, 204);
                pushMatrix();
                translate(w - 20, h - 5);
                rotate(0);
                _text(version, 0, 0, 1, 1, !true, color(13, 13, 13), color(255, 255, 255), 0.5);
                popMatrix();
            };
            var lead = function() {
                noStroke();
                background(202, 182, 106);

                image(imgs.backgroundGrid, 0, 0, w, h);
                fill(51, 51, 51, 150);
                rect(0, 0, w, h);
                // navbar
                fill(0, 16, 51, 150);
                rect(0, 0, width, 30);
                image(imgs.gem, width - 140, 5, 20, 20);
                image(imgs.trophy, width - 70, 8, 32, 32);
                pushStyle();
                textAlign(LEFT, CENTER);
                textFont(createFont(fontss[1]), 15);
                _text(pl.trophies, width - 50, 15, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 1);
                _text(pl.gems, width - 115, 15, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 1);
                popStyle();
                textSize(8);
                fill(204, 204, 204);
                pushMatrix();
                pushStyle();
                translate(w - 20, h - 5);
                textAlign(CENTER, LEFT);
                rotate(0);
                _text(version, 0, 0, 1, 1, !true, color(13, 13, 13), color(255, 255, 255), 0.5);
                popStyle();
                popMatrix();
                pushStyle();
                textFont(createFont(fontss[0]), 25);
                textAlign(LEFT, LEFT);
                fill(255, 255, 255);
                _text("Dynamic Leaderboard", 10, 68, 1, 1, !true, color(0, 0, 0), color(255, 255, 255), 1);
                textSize(15);
                _text("Bots on the leaderboard are currently playing matches and earning trophies. Subscribe to get notified when an advanced leaderboard system gets released!", 10, 89, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 0.6, 580, 300);
                //model_p.display();

                leaderboard = [
                    pl.name + ' - ' + (pl.trophies),
                    names[8] + ' - ' + (pl.trophies > 50 ? ((pl.trophies - 30) * 1) : pl.trophies + 15),
                    names[0] + ' - ' + (pl.trophies > 100 ? ((pl.trophies - 15) * 1) : pl.trophies + 7),
                    names[1] + ' - ' + (pl.trophies > 200 ? ((pl.trophies - 21) * 1) : pl.trophies + 15),
                    names[2] + ' - ' + (pl.trophies > 300 ? ((pl.trophies - 19)) : pl.trophies + 72),
                    names[3] + ' - ' + (pl.trophies > 400 ? ((pl.trophies - 31)) : pl.trophies + 100),
                    names[4] + ' - ' + (pl.trophies > 500 ? ((pl.trophies - 29)) : pl.trophies + 142),
                    names[5] + ' - ' + (pl.trophies > 750 ? ((pl.trophies - 42)) : pl.trophies + 160), names[7] + ' - ' + (pl.trophies > 1200 ? ((pl.trophies - 35)) : pl.trophies + 523),
                    names[6] + ' - ' + (pl.trophies > 1000 ? ((pl.trophies - 49)) : pl.trophies + 240)
                ];
                leaderboard.sort(function(a, b) {
                    // Extract the numeric values from the strings
                    var scoreA = parseInt(a.split(' - ')[1], 10);
                    var scoreB = parseInt(b.split(' - ')[1], 10);
                    return scoreB - scoreA; // Sort in descending order
                });
                for (var i = 0; i < leaderboard.length; i++) {
                    textAlign(LEFT, LEFT);
                    textSize(12);
                    if (leaderboard[i] === pl.name + ' - ' + (pl.trophies)) {
                        _text((i + 1) + ". " + leaderboard[i] + ' trophies', 30, 145 + i * 20, 1, 1, true, color(0, 0, 0), color(230, 245, 30), 0.6);
                    } else {
                        _text((i + 1) + ". " + leaderboard[i] + ' trophies', 30, 145 + i * 20, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 0.6);
                    }
                }
                uiButton(width - 59, 57.5, 100, 35, 'Subscribe', function() {
                    subscribe = true;
                }, false, 'support', 0, 14);
                popStyle();

                btns[1].run();
                btns[2].run();
                btns[8].run();
                btns[3].run();
            };

            var dead = function() {
                background(0);
                p.totalWood += p.wood;
                p.totalRock += p.rock;
                p.wood = 0;
                p.rock = 0;
                batch1Spawned = false;
                image(imgs.backgroundGrid, 0, 0, 600, 600);

                fill(0, 0, 0, 90);
                rect(0, 0, width, height);

                textFont(createFont(fontss[0]), 25);
                textAlign(LEFT, LEFT);
                fill(255);

                _text("You Died!", 17, 36, 1, 1, true, color(0), color(255), 1);

                textSize(15);
                //pl.highscore.sort(function(a,b) {return b.total-a.total;});
                _text("Time Alive: " + ~~p.timeAlive + "s" + "\n" + pl.name + "'s Score: " + p.score + "\n" + pl.name + "'s Kills: " + p.kills + "\nTotal: " + (~~p.timeAlive + p.score + p.kills) + "\n" + "\nHighscore Time Alive: " + (~~pl.highscore[0].timeAlive) + "s\nHighscore: " + (~~pl.highscore[0].score) + "\nHighscore Kills: " + (~~pl.highscore[0].kills) + "\nHighscore Total: " + (~~pl.highscore[0].total), 17, 62, 1, 1, true, color(0), color(255), 1);

                _text("Trophies Earned: " + (gamemodeRewards[gamemode].trophyReward) + '\nGems Earned: ' + gamemodeRewards[gamemode].gemReward, 207, 62, 1, 1, true, color(0), color(255), 1);

                //println(pl.highscore.length);

                btns[4].run();

            };
            var win = function() {
                background(0);
                p.totalWood += p.wood;
                p.totalRock += p.rock;
                p.wood = 0;
                p.rock = 0;
                batch1Spawned = false;
                image(imgs.backgroundGrid, 0, 0, 600, 600);

                fill(0, 0, 0, 90);
                rect(0, 0, width, height);

                textFont(createFont(fontss[0]), 25);
                textAlign(LEFT, LEFT);
                fill(255);

                _text("You Won!", 17, 36, 1, 1, true, color(0), color(255), 1);

                textSize(15);
                //pl.highscore.sort(function(a,b) {return b.total-a.total;});
                _text("Time Alive: " + ~~p.timeAlive + "s" + "\n" + pl.name + "'s Score: " + p.score + "\n" + pl.name + "'s Kills: " + p.kills + "\nTotal: " + (~~p.timeAlive + p.score + p.kills) + "\n" + "\nHighscore Time Alive: " + (~~pl.highscore[0].timeAlive) + "s\nHighscore: " + (~~pl.highscore[0].score) + "\nHighscore Kills: " + (~~pl.highscore[0].kills) + "\nHighscore Total: " + (~~pl.highscore[0].total), 17, 62, 1, 1, true, color(0), color(255), 1);

                _text("Trophies Earned: " + (gamemodeRewards[gamemode].trophyReward) + '\nGems Earned: ' + gamemodeRewards[gamemode].gemReward, 207, 62, 1, 1, true, color(0), color(255), 1);

                //println(pl.highscore.length);

                btns[4].run();

            };
            var woodCost = {
                upgradeTierCost: ((p.weaponLevel + 1) * 100),
                //tradeIn: 25, // set price or dynamic? I choose dynamic!
                tradeIn: ((p.weaponLevel + 1) * 100) * 2.5 / 10,
                upgradeTraitCost: ((p.weaponLevel + 1) * 250),
            };
            var rockCost = {
                upgradeTierCost: ((p.weaponLevel + 1) * 100),
                tradeIn: ((p.weaponLevel + 1) * 100) * 2.5 / 10,
                upgradeTraitCost: ((p.weaponLevel + 1) * 250),
            };
            if (testing === true) {
                pl.gems = 1000;
                pl.trophies = 1000;
                p.wood = 1000;
                p.rock = 1000;
                rockCost.upgradeTraitCost = 0;
                woodCost.upgradeTraitCost = 0;
                rockCost.upgradeTierCost = 0;
                woodCost.upgradeTierCost = 0;
                woodCost.tradeIn = 100;
                rockCost.tradeIn = 100;
            }
            var shop = function() {

                noStroke();
                //background(255,255,255);

                image(imgs.backgroundGrid, 0, 0, 600, 600);
                pushStyle();
                fill(0, 0, 0, 200);
                rect(0, 0, width, height);
                textFont(createFont(fontss[1]), 30);
                textAlign(CENTER, CENTER);
                fill(255, 255, 255);
                text("In-Game Shop", width / 2, 27);

                textAlign(LEFT, LEFT);
                pushMatrix();
                translate(25, 40 - 5);
                noStroke();
                fill(0, 0, 0, 100);
                rect(-5, -25, 80, 37, 4);
                textSize(20);
                fill(255, 255, 255);
                text("W " + (p.wood), 0, 0);
                popMatrix();

                pushMatrix();
                translate(115, 40 - 5);
                noStroke();
                fill(0, 0, 0, 100);
                rect(-5, -25, 80, 37, 4);
                fill(255, 255, 255);
                text("R " + (p.rock), 0, 0);
                popMatrix();

                pushMatrix();
                translate(width - 90, 40 - 5);
                noStroke();
                fill(0, 0, 0, 100);
                rect(-5, -25, 80, 37, 4);
                fill(255, 255, 255);
                text("$ " + (~~p.money), 0, 0);
                popMatrix();

                uiButton(110, 100, 200, 80, 'Weapon Upgrade', function() {
                    if (p.weaponLevel < p.weaponDamage.length - 1) {
                        if (p.wood >= woodCost.upgradeTierCost && p.rock >= rockCost.upgradeTierCost) {
                            p.weaponLevel++;
                            p.wood -= woodCost.upgradeTierCost;
                            p.rock -= rockCost.upgradeTierCost;
                            notif('Tier upgraded!', 'center, bottom', 150, 'green');
                        } else {
                            notif('Not enough resources!', 'center, bottom', 150, 'red');
                        }
                    } else {
                        notif('Tier maxed out.', 'center, bottom', 150, 'blue');
                    }
                }, false, 'mode', 0, 18, 'Upgrade tier of all weapons. \nCurrent tier: ' + (p.weaponLevel + 1) + '\nUpgrade Cost: W ' + woodCost.upgradeTierCost + ' + R ' + rockCost.upgradeTierCost);

                uiButton(320, 100, 200, 80, 'Trait Level Up', function() {
                    if (p.trait !== '') {
                        if (p.traitlevel < 6 - 1) {
                            if (p.wood >= woodCost.upgradeTraitCost && p.rock >= rockCost.upgradeTraitCost) {
                                p.traitlevel++;
                                p.wood -= woodCost.upgradeTraitCost;
                                p.rock -= rockCost.upgradeTraitCost;
                                notif('Trait level upgraded!', 'center, bottom', 150, 'green');
                            } else {
                                notif('Not enough resources!', 'center, bottom', 150, 'red');
                            }
                        } else {
                            notif('Trait level maxed out.', 'center, bottom', 150, 'blue');
                        }
                    } else {
                        notif('No trait equipped!', 'center, bottom', 150, 'red');
                    }
                }, false, 'mode', 0, 18, 'Equiped trait: ' + (p.trait !== '' ? p.trait : 'None') + '\nCurrent level: ' + (p.traitlevel) + '\nUpgrade Cost: W ' + woodCost.upgradeTraitCost + ' + R ' + rockCost.upgradeTraitCost);

                uiButton(110, 200, 200, 80, 'Wood Trade-In', function() {
                    if (p.wood >= woodCost.tradeIn) {
                        p.wood -= woodCost.tradeIn;
                        p.money += woodCost.tradeIn;
                        notif('Trade in successful!', 'center, bottom', 150, 'green');
                    } else {
                        notif('Not enough wood!', 'center, bottom', 150, 'red');
                    }
                }, false, 'mode', 0, 18, 'Trade wood for money ($)\nEarn $' + woodCost.tradeIn + ' per W ' + woodCost.tradeIn);
                uiButton(320, 200, 200, 80, 'Rock Trade-In', function() {
                    if (p.rock >= rockCost.tradeIn) {
                        p.rock -= rockCost.tradeIn;
                        p.money += rockCost.tradeIn;
                        notif('Trade in successful!', 'center, bottom', 150, 'green');
                    } else {
                        notif('Not enough rocks!', 'center, bottom', 150, 'red');
                    }
                }, false, 'mode', 0, 18, 'Trade rocks for money ($)\nEarn $' + rockCost.tradeIn + ' per R ' + rockCost.tradeIn);

                pushMatrix();

                inv.run();
                popMatrix();
                popStyle();
                btns[7].run();
            };
            var player = function() {
                noStroke();
                background(106, 152, 201);

                image(imgs.backgroundGrid, 0, 0, w, h);
                fill(51, 51, 51, 150);
                rect(0, 0, w, h);

                // navbar
                fill(0, 16, 51, 150);
                rect(0, 0, width, 30);
                image(imgs.gem, width - 140, 5, 20, 20);
                image(imgs.trophy, width - 70, 8, 32, 32);
                pushStyle();
                textAlign(LEFT, CENTER);
                textFont(createFont(fontss[1]), 15);
                _text(pl.trophies, width - 50, 15, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 1);
                _text(pl.gems, width - 115, 15, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 1);
                popStyle();
                textSize(8);
                fill(204, 204, 204);
                pushMatrix();
                pushStyle();
                textAlign(CENTER, CENTER);
                translate(w - 20, h - 5);
                rotate(0);
                _text(version, 0, 0, 1, 1, !true, color(13, 13, 13), color(255, 255, 255), 0.5);
                popStyle();
                popMatrix();

                // We don't need input name, it will be picked from the start

                pushMatrix();
                pushStyle();
                translate(-10, -157);
                scale(1.5);
                fill(58, 72, 107, 200);
                rectMode(CENTER);
                rect(55, h - 110, 103, 205, 2);
                textFont(createFont(fontss[1]), 11);
                textAlign(CENTER, LEFT);
                _text(pl.name, 10, h - 200, 1.1, 1.1, !true, color(0, 0, 0), color(255, 255, 255), 0.1, 80, 100);

                _text("\n\nMatches: " + pl.matches + "\nWin Rate: " + pl.winrate + "%\nK/D Ratio: " + pl.kdr + "\nKills: " + pl.kills + "\nDeaths: " + pl.deaths + "\nWins: " + pl.wins + "\nLosses: " + pl.losses + "\nTime: " + formatTimePlayed(pl.timePlayed), 55, h - 180, 1, 1, !true, color(0, 0, 0), color(255, 255, 255), 0.1);
                popStyle();
                popMatrix();

                uiButton(75, 89, 150, 30, 'Edit Name', function() {
                    changeName = true;
                }, false, 'support', 1, 14);

                uiButton(30, height - 18, 80, 40, 'Save', function() {
                    /*var o31 = '';
                    for (var p31 in pl) {
                        o31 += p31 + ': ' + pl[p31] + ', ';
                    }
                    println('// Replace line XX with this, then spin-off this program:\nvar pl = {' + o31 + '};');*/
                    saved = true;
                }, false, false, 1, 14);
                uiButton(110, height - 18, 80, 40, 'Load', function() {
                    loade = true;
                    //println('Subscribe here to get notified on the next major update: https://www.khanacademy.org/computer-programming/leaferstudios/4934504502870016\n\nUse your save code to load your save file.\n\nFor Khan Academy only: Auto loading your save file is coming soon.');
                }, false, 'action', 1, 14);

                textFont(createFont(fontss[1]), 15);
                textAlign(LEFT, LEFT);
                _text('Market:', width - 140, 45, 1.1, 1.1, !true, color(0, 0, 0), color(255, 255, 255), 0.1, 100, 100);

                uiButton(width - 75, 100, 130, 70, 'Traits', function() {
                    scene = 8;
                    playerShopIndex = 'traits';
                }, false, 'mode', 0, 19, 'Buy and equip a trait to enhance player ability');

                uiButton(width - 75, 180, 130, 70, 'Customize', function() {
                    scene = 8;
                    playerShopIndex = 'skins';
                }, false, 'mode', 0, 19, 'Buy and equip outfits and more for your player');

                uiButton(width - 75, 260, 130, 70, 'Vault Goods', function() {
                    scene = 8;
                    playerShopIndex = 'chests';
                }, false, 'mode', 0, 19, 'Shop chests and special deals that change daily');

                btns[1].run();
                btns[2].run();
                btns[8].run();
                btns[3].run();

                model_p.display();
                textAlign(CENTER, CENTER);


            };
            var traitTracker = {
                juggernaut: {
                    cost: 150,
                    isEquipped: false,
                    bought: false,
                },
                scout: {
                    cost: 450,
                    isEquipped: false,
                    bought: false,
                },
            };
            var playerShop = function() {
                noStroke();
                background(106, 152, 201);

                image(imgs.backgroundGrid, 0, 0, w, h);
                fill(51, 51, 51, 150);
                rect(0, 0, w, h);


                image(imgs.gem, width - 140, 5, 20, 20);
                image(imgs.trophy, width - 70, 8, 32, 32);
                pushStyle();
                textAlign(LEFT, CENTER);
                textFont(createFont(fontss[1]), 15);
                _text(pl.trophies, width - 50, 15, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 1);
                _text(pl.gems, width - 115, 15, 1, 1, true, color(0, 0, 0), color(255, 255, 255), 1);
                popStyle();
                textAlign(LEFT, LEFT);
                textFont(createFont(fontss[0]), 20);
                // triats, skins, chests
                if (playerShopIndex === 'traits') {
                    _text("Trait Collection", 125, 26, 1, 1, !true, color(0, 0, 0), color(255, 255, 255), 0.1);
                    textSize(15);
                    _text("A trait enhances your players ability in all gamemodes. Upgrade your trait level during the game by harvesting resources and going to the in-game shop page. A trait level of 0 is useless and trait level resets after the game ends.", 20, 66, 1, 1, !true, color(0, 0, 0), color(255, 255, 255), 0.1, 560, 200);

                    uiButton(80, 240, 130, 170, 'Juggernaut', function() {
                        if (pl.gems >= traitTracker.juggernaut.cost) {
                            if (traitTracker.juggernaut.bought === false) {
                                pl.gems -= traitTracker.juggernaut.cost;
                                traitTracker.juggernaut.bought = true;
                            }
                            if (traitTracker.juggernaut.isEquipped === false) {
                                p.trait = 'Juggernaut';
                                traitTracker.juggernaut.isEquipped = true;
                                notif(p.trait + ' trait equipped!', 'center, bottom', 150, 'green');
                            } else {
                                traitTracker.juggernaut.isEquipped = false;
                                notif(p.trait + ' trait unequipped!', 'center, bottom', 150, 'red');
                            }
                        } else {
                            notif('Not enough gems!', 'center, bottom', 150, 'red');
                        }
                    }, false, 'mode', 0, 19, '+10 Total Health per trait level.\nEquipped: ' + (traitTracker.juggernaut.isEquipped ? 'Yes' : 'No') + '\nCost: ' + (traitTracker.juggernaut.cost) + ' gems\nBought: ' + (traitTracker.juggernaut.bought ? 'Yes' : 'No') + ((traitTracker.juggernaut.bought ? (traitTracker.juggernaut.isEquipped ? '\nClick to unequip' : '\nClick to equip') : '\nClick to buy & equip')));


                    uiButton(220, 240, 130, 170, 'Scout', function() {
                        if (pl.gems >= traitTracker.scout.cost) {
                            if (traitTracker.scout.bought === false) {
                                pl.gems -= traitTracker.scout.cost;
                                traitTracker.scout.bought = true;
                            }
                            if (traitTracker.scout.isEquipped === false) {
                                p.trait = 'Scout';
                                traitTracker.scout.isEquipped = true;
                                notif(p.trait + ' trait equipped!', 'center, bottom', 150, 'green');
                            } else {
                                traitTracker.scout.isEquipped = false;
                                notif(p.trait + ' trait unequipped!', 'center, bottom', 150, 'red');
                            }
                        } else {
                            notif('Not enough gems!', 'center, bottom', 150, 'red');
                        }
                    }, false, 'mode', 0, 19, '+10% Move Speed per trait level.\nEquipped: ' + (traitTracker.scout.isEquipped ? 'Yes' : 'No') + '\nCost: ' + (traitTracker.scout.cost) + ' gems\nBought: ' + (traitTracker.scout.bought ? 'Yes' : 'No') + ((traitTracker.scout.bought ? (traitTracker.scout.isEquipped ? '\nClick to unequip' : '\nClick to equip') : '\nClick to buy & equip')));
                } else if (playerShopIndex === 'skins') {
                    _text("Customize Player", 125, 26, 1, 1, !true, color(0, 0, 0), color(255, 255, 255), 0.1);
                    textSize(15);
                    _text("Customize your player's appearence using items you have bought through vault goods or earned through a Season Pass.\n\n\nNo customizations are available at version 0.4 of NATUWARS.\nSubscribe to LeaferStudios to get notified when NATUWARS v0.5 is released!", 20, 66, 1, 1, !true, color(0, 0, 0), color(255, 255, 255), 0.1, 560, 200);
                    uiButton(width / 2, 240, 200, 40, 'Subscribe to LeaferStudios', function() {
                        subscribe = true;
                    }, false, 'support', 0, 14);
                } else if (playerShopIndex === 'chests') {
                    _text("Vault Goods", 125, 26, 1, 1, !true, color(0, 0, 0), color(255, 255, 255), 0.1);
                    textSize(15);
                    _text("Special deals that update daily. Equip the items you have bought through the Customize Player page.\n\n\nNo vault goods are available at version 0.4 of NATUWARS.\nSubscribe to LeaferStudios to get notified when NATUWARS v0.5 is released!", 20, 66, 1, 1, !true, color(0, 0, 0), color(255, 255, 255), 0.1, 560, 200);
                    uiButton(width / 2, 240, 200, 40, 'Subscribe to LeaferStudios', function() {
                        subscribe = true;
                    }, false, 'support', 0, 14);
                } else {
                    _text("Trait Shop", 125, 26, 1, 1, !true, color(0, 0, 0), color(255, 255, 255), 0.1);
                    textSize(15);
                    _text("Upgade whatever you want here!", 20, 66, 1, 1, !true, color(0, 0, 0), color(255, 255, 255), 0.1, 560, 200);
                }

                uiButton(50, 20, 100, 40, 'Back', function() {
                    scene = 7;
                }, false, false, 1, 14);
            };

            draw = function() {
                //remove in production for better performance
                //try {
                cursor("DEFAULT");
                background(0, 0, 0);
                //if (isNaN(((pl.wins / pl.matches) * 100).toFixed(2))) {
                if (isNaN(((pl.wins / pl.matches) * 100).toFixed(2))) {
                    pl.winrate = 0;
                } else {
                    pl.winrate = ((pl.wins / pl.matches) * 100).toFixed(2);
                }

                if (isNaN(((pl.kills / pl.deaths) * 100).toFixed(2))) {
                    pl.kdr = 0;
                } else if (pl.deaths === 0 && pl.kills >= 1) {
                    pl.kdr = pl.kills;
                } else {
                    pl.kdr = ((pl.kills / pl.deaths)).toFixed(2);
                }
                switch (scene) {
                    case "load":
                        loadImages();
                        image(imgs.backgroundGrid, 0, 0, 600, 600);
                        break;
                    case 0:
                        home();
                        break;
                    case 1:
                        game();
                        break;
                    case 2:
                        how();
                        break;
                    case 3:
                        lead();
                        break;
                    case 4:
                        dead();
                        break;
                    case 5:
                        shop();
                        break;
                    case 6:
                        modes();
                        break;
                    case 7:
                        player();
                        break;
                    case 8:
                        playerShop();
                        break;
                    case 9:
                        win();
                        break;
                }
                click = false;
                if (intransition) {
                    // goto.create();
                }

                if (inNotif) {
                    runNotifs();
                }

                pl.timePlayed += 1 / this.__frameRate;
                //} catch (e) {
                //    println(e);
                //}
                if (subscribe === true) {
                    openSubscribeScreen();
                } else {
                    document.getElementById('subscribe-screen').style.display = 'none';
                }

                if (saved === true) {
                    openSavedScreen();
                } else {
                    document.getElementById('saved-screen').style.display = 'none';
                }

                if (loade === true) {

                    openLoadeScreen();
                } else {
                    document.getElementById('loade-screen').style.display = 'none';
                }

                if (changeName === true) {
                    openChangeNameScreen();
                } else {
                    document.getElementById('change-name-screen').style.display = 'none';
                }
            };
            keyPressed = function() {
                keys[keyCode] = true;
            };
            keyReleased = function() {
                keys[keyCode] = false;
            };
            keyTyped = function() {

            };

            // pause/unpause
            mouseOut = function() {
                noLoop();
                pushStyle();
                background(0, 90, 0, 150);
                textFont(createFont(fontss[1]), 50);
                textAlign(CENTER, CENTER);
                fill(255);
                text("GAME PAUSED", width / 2, height / 2 - 39);
                textSize(24);
                text("Move mouse over program to unpause.", width / 2, height / 2 + 39);
                popStyle();
            };

            mouseOver = function() {
                loop();
            };

            /**
            (c) 2024-Present by LeaferStudios 

            KA Profile: https://www.khanacademy.org/profile/kaid_553656479258879622339276/
            KA Homepage: https://www.khanacademy.org/computer-programming/leaferstudios/4934504502870016

            Plagiarism is strictly forbidden. 
            You will get flagged if it is on KA or reported to the DMCA if it is off KA.
            **/

        }
        runPJS(program);

        if (window.innerWidth <= 800) {
            document.getElementById('big-screen').style.display = 'block';
        } else {
            document.getElementById('big-screen').style.display = 'none';
        }

        function fullscreen() {
            document.getElementById('big-screen').remove();
        }
        fullscreen();
        function closeSubscribeScreen() {
            document.getElementById('subscribe-screen').style.display = 'none';
            subscribe = false;
        }

        function openSubscribeScreen() {
            document.getElementById('subscribe-screen').style.display = 'block';
        }

        function openLoadeScreen() {
            document.getElementById('loade-screen').style.display = 'block';
            document.getElementById('error_text').style.opacity = 0;
        }

        function openSavedScreen() {
            var w = encryptObject(pl);
            document.getElementById('saved-screen').style.display = 'block';
            document.getElementById('savecod').innerHTML = w;
            document.getElementById('copybutton').innerText = 'Copy Savecode';
        }

        function closeLoadeScreen() {
            document.getElementById('loade-screen').style.display = 'none';
            loade = false;
        }

        function openChangeNameScreen() {
            document.getElementById('change-name-screen').style.display = 'block';
            document.getElementById('error_text_1').style.opacity = 0;
        }

        function closeChangeNameScreen() {
            document.getElementById('change-name-screen').style.display = 'none';
            changeName = false;
        }

        function closeSavedScreen() {
            document.getElementById('saved-screen').style.display = 'none';
            saved = false;
        }

        function updateUsername() {

            var userbox = document.getElementById('userbox').value;
            var isValid = /^[A-Za-z]+$/.test(userbox);
            if (isValid) {
                if (userbox.length >= 11) {
                    document.getElementById('error_text_1').style.opacity = 1;
                    document.getElementById('error_text_1').style.opacity = 1;
                    document.getElementById('error_text_1').innerHTML = 'Username too long.';
                } else {
                    pl.name = userbox;
                    document.getElementById('error_text_1').style.opacity = 0;
                    document.getElementById('change-name-screen').style.display = 'none';
                    changeName = false;
                }

            } else {

                document.getElementById('error_text_1').style.opacity = 1;
                if (userbox === '') {
                    document.getElementById('error_text_1').innerHTML = 'Please enter a new username';
                } else {
                    document.getElementById('error_text_1').innerHTML = 'Must be letters only (A-Z), no spaces, and under 10 characters.';
                }
            }
        }

        function copySaveCode() {
            var copyText = document.getElementById('savecod').innerHTML;
            var textArea = document.createElement('textarea');
            textArea.value = copyText;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            document.getElementById('copybutton').innerText = 'Copied to clipboard!';

        }

        function loadSaveCode() {
            var loadcod = document.getElementById('loadcod').value.replace(/\s/g, "");
            try {
                if (decryptObject(loadcod)) {
                    // It works! Haha let's GOOOO!
                    pl = decryptObject(loadcod);
                    document.getElementById('loadbtn').innerText = 'Savecode Loaded!';
                }
            } catch (e) {
                document.getElementById('error_text').style.opacity = 1;
                document.getElementById('error_text').innerText = 'Unable to load savecode. Please enter the full encrypted savecode.';
            }
        }

        function closeFullscreen() {
            document.getElementById('big-screen').style.display = 'none';
        }

        closeSubscribeScreen();
    </script>

    <!-- SLIDESHOW SCRIPT -->
    <script>
        var slideIndexes = 0;
        var slides = document.getElementsByClassName("slide");

        function showSlides() {

            for (var i = 0; i < slides.length; i++) {
                slides[i].style.display = "none";
            }
            slideIndexes++;
            if (slideIndexes > slides.length) {
                slideIndexes = 1
            }
            if (slideIndexes < 1) {
                slideIndexes = slides.length;
            }
            slides[slideIndexes - 1].style.display = "block";
        }

        function plusSlides(n) {
            slideIndexes += n - 1;
            showSlides();
        }

        showSlides();
    </script>

    <!-- Thumbnail, for Khan Academy only -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script type>
        // credit to Bluebird@birdwatcher03 for this thumbnail script (only needed on Khan Academy, makes the thumbnail resolution better)
        var r = 600;
        var s = document.documentElement.clientWidth;
        window.parent.html2canvas = e => {
            try {
                html2canvas(document.body, {
                    width: s,
                    height: s,
                    useCORS: true,
                }).then(e => {
                    var c = document.createElement("canvas");
                    c.width = r;
                    c.height = r;
                    c.getContext('2d').drawImage(e, 0, 0, e.width, e.height, 0, 0, r, r);
                    window.top.postMessage(c.toDataURL(), "*");
                }).catch(e => {
                    alert("Thumbnail Script Error: " + e);
                });
            } catch {
                window.top.postMessage(document.createElement("canvas").toDataURL(), "*");
            }
        };
    </script>

    <!--
NOTE TO SELF: Keep this, this is required for my personal website's API.

MIT License: You cannot plagiarize this program! You must always keep the license below or else I will submit a DMCA takedown notice. If it is on Khan Academy, it will get taken down.
-->
    <!--
MIT License

Copyright (c) 2024 LeaferStudios

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
-->
</body>

</html>

<!--
That's a lot of code. See you in the next version.
-LeaferStudios, 8:00 AM July 26, 2024
-->

